–≤ –¥–æ–∫—É–º–µ–Ω—Ç–µ 7555 —Å—Ç—Ä–æ–∫ —á–∏—Ç–∞–π –ø–æ–ª–Ω–æ—Å—Ç—å—é!
# **üéØ –¢–ï–ö–£–©–ê–Ø –ó–ê–î–ê–ß–ê: –°–û–ó–î–ê–ù–ò–ï –ë–ê–ó–û–í–û–ô –°–¢–†–£–ö–¢–£–†–´ –ü–†–û–ï–ö–¢–ê (–§–ê–ó–ê 0)**
–†–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ —Ñ—É–Ω–¥–∞–º–µ–Ω—Ç–∞–ª—å–Ω–æ–π —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –ø—Ä–æ–µ–∫—Ç–∞ FastAgain —Å–æ–≥–ª–∞—Å–Ω–æ –¢–ó: —Å–æ–∑–¥–∞–Ω–∏–µ –¥–≤—É—Ö —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–µ–≤ (–±—ç–∫–µ–Ω–¥ Python/FastAPI –∏ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥ React/TypeScript), –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ –±–∞–∑–æ–≤—ã—Ö –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–π, Docker –æ–∫—Ä—É–∂–µ–Ω–∏—è –∏ —Å–æ–∑–¥–∞–Ω–∏–µ –ø–µ—Ä–≤—ã—Ö C0 –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤.

## üìä –°–¢–ê–¢–£–° –ü–†–û–ï–ö–¢–ê (–ø–æ—Å–ª–µ —ç—Ç–æ–≥–æ –æ—Ç–≤–µ—Ç–∞):
```


## üìÅ –°–û–ó–î–ê–ù–ù–´–ï –§–ê–ô–õ–´:

### 1. **–ë—ç–∫–µ–Ω–¥ (Python/FastAPI) - `fastagain-backend/`**:
```
fastagain-backend/
‚îú‚îÄ‚îÄ app/
‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îú‚îÄ‚îÄ main.py              # –¢–æ—á–∫–∞ –≤—Ö–æ–¥–∞ FastAPI
‚îÇ   ‚îú‚îÄ‚îÄ core/                # –Ø–¥—Ä–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ config.py        # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è Pydantic Settings
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ database.py      # –ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ PostgreSQL
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ security.py      # JWT –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ dependencies.py  # FastAPI –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
‚îÇ   ‚îú‚îÄ‚îÄ models/              # SQLAlchemy –º–æ–¥–µ–ª–∏
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ base.py          # –ë–∞–∑–æ–≤–∞—è –º–æ–¥–µ–ª—å
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ user.py          # –ú–æ–¥–µ–ª—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (C2)
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ project_wallet.py # –ú–æ–¥–µ–ª—å –∫–æ—à–µ–ª—å–∫–æ–≤ —Ñ–æ–Ω–¥–∞ (C3)
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ user_cycle.py    # –ú–æ–¥–µ–ª—å —Ü–∏–∫–ª–æ–≤ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (C2)
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ transaction.py   # –ú–æ–¥–µ–ª—å —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π (C3)
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ support_ticket.py # –ú–æ–¥–µ–ª—å —Ç–∏–∫–µ—Ç–æ–≤ –ø–æ–¥–¥–µ—Ä–∂–∫–∏ (C1)
‚îÇ   ‚îú‚îÄ‚îÄ schemas/             # Pydantic —Å—Ö–µ–º—ã
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ user.py          # –°—Ö–µ–º—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ wallet.py        # –°—Ö–µ–º—ã –∫–æ—à–µ–ª—å–∫–æ–≤
‚îÇ   ‚îî‚îÄ‚îÄ api/                 # API —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã
‚îÇ       ‚îú‚îÄ‚îÄ __init__.py
‚îÇ       ‚îú‚îÄ‚îÄ v1/              # API –≤–µ—Ä—Å–∏—è 1
‚îÇ       ‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ       ‚îÇ   ‚îú‚îÄ‚îÄ endpoints/
‚îÇ       ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ       ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ health.py  # Health check (C0)
‚îÇ       ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ auth.py    # –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è (C2)
‚îÇ       ‚îÇ   ‚îî‚îÄ‚îÄ api.py        # –†–æ—É—Ç–µ—Ä API v1
‚îÇ       ‚îî‚îÄ‚îÄ dependencies.py  # API –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
‚îú‚îÄ‚îÄ alembic/                 # –ú–∏–≥—Ä–∞—Ü–∏–∏ –ë–î
‚îÇ   ‚îú‚îÄ‚îÄ versions/
‚îÇ   ‚îú‚îÄ‚îÄ env.py
‚îÇ   ‚îî‚îÄ‚îÄ alembic.ini
‚îú‚îÄ‚îÄ requirements/
‚îÇ   ‚îú‚îÄ‚îÄ base.txt            # –ë–∞–∑–æ–≤—ã–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
‚îÇ   ‚îú‚îÄ‚îÄ dev.txt             # –î–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏
‚îÇ   ‚îî‚îÄ‚îÄ prod.txt            # –î–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞
‚îú‚îÄ‚îÄ tests/                  # –¢–µ—Å—Ç—ã
‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îú‚îÄ‚îÄ conftest.py
‚îÇ   ‚îî‚îÄ‚îÄ test_health.py      # –¢–µ—Å—Ç—ã health check
‚îú‚îÄ‚îÄ .env.example            # –ü—Ä–∏–º–µ—Ä –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è
‚îú‚îÄ‚îÄ .gitignore
‚îú‚îÄ‚îÄ docker-compose.yml      # Docker –æ–∫—Ä—É–∂–µ–Ω–∏–µ (PostgreSQL, Redis)
‚îú‚îÄ‚îÄ Dockerfile
‚îú‚îÄ‚îÄ Makefile               # –£—Ç–∏–ª–∏—Ç—ã —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏
‚îú‚îÄ‚îÄ pyproject.toml         # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –ø—Ä–æ–µ–∫—Ç–∞ Python
‚îî‚îÄ‚îÄ README.md
```

### 2. **–§—Ä–æ–Ω—Ç–µ–Ω–¥ (React/TypeScript) - `fastagain-frontend/`**:
```
fastagain-frontend/
‚îú‚îÄ‚îÄ src/
‚îÇ   ‚îú‚îÄ‚îÄ main.tsx           # –¢–æ—á–∫–∞ –≤—Ö–æ–¥–∞ React
‚îÇ   ‚îú‚îÄ‚îÄ App.tsx            # –ì–ª–∞–≤–Ω—ã–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç
‚îÇ   ‚îú‚îÄ‚îÄ App.css            # –ì–ª–æ–±–∞–ª—å–Ω—ã–µ —Å—Ç–∏–ª–∏
‚îÇ   ‚îú‚îÄ‚îÄ vite-env.d.ts      # –¢–∏–ø—ã Vite
‚îÇ   ‚îú‚îÄ‚îÄ components/        # UI –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ ui/
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Button/    # –ö–Ω–æ–ø–∫–∞ —Å —Å–æ—Å—Ç–æ—è–Ω–∏—è–º–∏
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Button.tsx
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Button.test.tsx
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ index.ts
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ index.ts   # –≠–∫—Å–ø–æ—Ä—Ç –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ layout/
‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ Header.tsx
‚îÇ   ‚îÇ       ‚îî‚îÄ‚îÄ Footer.tsx
‚îÇ   ‚îú‚îÄ‚îÄ pages/             # –°—Ç—Ä–∞–Ω–∏—Ü—ã
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Home.tsx       # –î–æ–º–∞—à–Ω—è—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ NotFound.tsx   # 404 —Å—Ç—Ä–∞–Ω–∏—Ü–∞
‚îÇ   ‚îú‚îÄ‚îÄ hooks/             # –ö–∞—Å—Ç–æ–º–Ω—ã–µ —Ö—É–∫–∏
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ useTheme.ts    # –•—É–∫ —Ç–µ–º—ã (–¥–∏–∑–∞–π–Ω-—Å–∏—Å—Ç–µ–º–∞)
‚îÇ   ‚îú‚îÄ‚îÄ services/          # API –∫–ª–∏–µ–Ω—Ç—ã
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ api.ts         # –ë–∞–∑–æ–≤—ã–π –∫–ª–∏–µ–Ω—Ç
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ health.ts      # Health check API
‚îÇ   ‚îú‚îÄ‚îÄ styles/            # –°—Ç–∏–ª–∏ Tailwind
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ globals.css    # –ì–ª–æ–±–∞–ª—å–Ω—ã–µ —Å—Ç–∏–ª–∏
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ theme.ts       # –¢–µ–º–∞ –¥–∏–∑–∞–π–Ω-—Å–∏—Å—Ç–µ–º—ã
‚îÇ   ‚îî‚îÄ‚îÄ types/             # TypeScript —Ç–∏–ø—ã
‚îÇ       ‚îî‚îÄ‚îÄ api.ts         # –¢–∏–ø—ã API
‚îú‚îÄ‚îÄ public/                # –°—Ç–∞—Ç–∏—á–µ—Å–∫–∏–µ —Ñ–∞–π–ª—ã
‚îÇ   ‚îú‚îÄ‚îÄ vite.svg
‚îÇ   ‚îî‚îÄ‚îÄ favicon.ico
‚îú‚îÄ‚îÄ .env.example           # –ü—Ä–∏–º–µ—Ä –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è
‚îú‚îÄ‚îÄ .gitignore
‚îú‚îÄ‚îÄ tailwind.config.js     # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è Tailwind (–¥–∏–∑–∞–π–Ω-—Å–∏—Å—Ç–µ–º–∞)
‚îú‚îÄ‚îÄ postcss.config.js
‚îú‚îÄ‚îÄ tsconfig.json          # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è TypeScript
‚îú‚îÄ‚îÄ tsconfig.node.json
‚îú‚îÄ‚îÄ vite.config.ts         # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è Vite
‚îú‚îÄ‚îÄ index.html
‚îú‚îÄ‚îÄ package.json
‚îú‚îÄ‚îÄ Dockerfile
‚îî‚îÄ‚îÄ README.md
```

---

## üöÄ –ö–ê–ö –ó–ê–ü–£–°–¢–ò–¢–¨:

### **1. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –±—ç–∫–µ–Ω–¥–∞:**
```bash
# –ö–ª–æ–Ω–∏—Ä—É–π –∏ –ø–µ—Ä–µ–π–¥–∏ –≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é –±—ç–∫–µ–Ω–¥–∞
cd fastagain-backend

# –£—Å—Ç–∞–Ω–æ–≤–∏ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è
cp .env.example .env
# –û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π .env —Ñ–∞–π–ª:
# SECRET_KEY=your-secret-key-here
# DATABASE_URL=postgresql+asyncpg://user:password@localhost:5432/fastagain
# REDIS_URL=redis://localhost:6379/0

# –ó–∞–ø—É—Å—Ç–∏ Docker –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã (PostgreSQL + Redis)
docker-compose up -d

# –£—Å—Ç–∞–Ω–æ–≤–∏ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ Python
python -m venv venv
source venv/bin/activate  # –ù–∞ Windows: venv\Scripts\activate
pip install -r requirements/dev.txt

# –ü—Ä–∏–º–µ–Ω–∏ –º–∏–≥—Ä–∞—Ü–∏–∏ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
alembic upgrade head

# –ó–∞–ø—É—Å—Ç–∏ —Å–µ—Ä–≤–µ—Ä —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏
uvicorn app.main:app --reload --host 0.0.0.0 --port 8000
```

### **2. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–∞:**
```bash
# –í –Ω–æ–≤–æ–º —Ç–µ—Ä–º–∏–Ω–∞–ª–µ –ø–µ—Ä–µ–π–¥–∏ –≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–∞
cd fastagain-frontend

# –£—Å—Ç–∞–Ω–æ–≤–∏ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
npm install

# –ó–∞–ø—É—Å—Ç–∏ —Å–µ—Ä–≤–µ—Ä —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏
npm run dev
```

### **3. –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç—ã:**
```bash
# –ü—Ä–æ–≤–µ—Ä—å –±—ç–∫–µ–Ω–¥
curl http://localhost:8000/api/v1/health
# –û—Ç–≤–µ—Ç: {"status":"ok","timestamp":"2024-01-23T12:00:00Z"}

# –ü—Ä–æ–≤–µ—Ä—å —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥
# –û—Ç–∫—Ä–æ–π –≤ –±—Ä–∞—É–∑–µ—Ä–µ: http://localhost:3000
```

---

## üìå –°–õ–ï–î–£–Æ–©–ò–ï –®–ê–ì–ò –î–õ–Ø –†–ê–ó–†–ê–ë–û–¢–ö–ò:
1. **–°–æ–≥–ª–∞—Å–Ω–æ –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç—É –¢–ó**: C3 ‚Üí C2 ‚Üí C1 ‚Üí C0
2. **–°–ª–µ–¥—É—é—â–∞—è –∑–∞–¥–∞—á–∞**: –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å UserService (C2) —Å –º–æ–¥–µ–ª—è–º–∏ –∏ —Å—Ö–µ–º–∞–º–∏ –¥–ª—è —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ –∏ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏
3. **–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è**: –°–æ–∑–¥–∞—Ç—å API —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã –¥–ª—è —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ (/api/v1/auth/register) –∏ –≤—Ö–æ–¥–∞ (/api/v1/auth/login)
4. **–§—Ä–æ–Ω—Ç–µ–Ω–¥**: –°–æ–∑–¥–∞—Ç—å –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã Registration –∏ Login —Å –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–µ–π API

---

## ü§ñ –ö–û–ù–¢–ï–ö–°–¢ –î–õ–Ø –°–õ–ï–î–£–Æ–©–ï–ì–û –ò–ò-–ê–°–°–ò–°–¢–ï–ù–¢–ê (–°–ö–û–ü–ò–†–£–ô –≠–¢–û–¢ –ë–õ–û–ö –í –ù–û–í–´–ô –ß–ê–¢):

### –û–ü–ò–°–ê–ù–ò–ï –ü–†–û–ï–ö–¢–ê:
FastAgain - —Å–∏—Å—Ç–µ–º–∞ –≤–∑–∞–∏–º–æ–ø–æ–º–æ—â–∏ –Ω–∞ –±–ª–æ–∫—á–µ–π–Ω–µ TRON. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –¥–µ–ª–∞—é—Ç 5 –ø–µ—Ä–µ–≤–æ–¥–æ–≤ –ø–æ 20 USDT –≤ —Ç–µ—á–µ–Ω–∏–µ 24 —á–∞—Å–æ–≤. –ü–æ–ª–Ω–∞—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –¥–∏–∑–∞–π–Ω-—Å–∏—Å—Ç–µ–º—ã "Trust Flow" —Å React —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–æ–º –∏ FastAPI –±—ç–∫–µ–Ω–¥–æ–º.

### –¢–ï–ö–£–©–ò–ô –°–¢–ê–¢–£–° –†–ê–ó–†–ê–ë–û–¢–ö–ò:
‚úÖ –°–æ–∑–¥–∞–Ω–∞ –±–∞–∑–æ–≤–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞ (–§–∞–∑–∞ 0 –∑–∞–≤–µ—Ä—à–µ–Ω–∞)
‚úÖ –ù–∞—Å—Ç—Ä–æ–µ–Ω—ã –¥–≤–∞ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è: –±—ç–∫–µ–Ω–¥ (Python/FastAPI) –∏ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥ (React/TypeScript)
‚úÖ –ù–∞—Å—Ç—Ä–æ–µ–Ω—ã Docker –æ–∫—Ä—É–∂–µ–Ω–∏—è (PostgreSQL + Redis –¥–ª—è –±—ç–∫–µ–Ω–¥–∞)
‚úÖ –°–æ–∑–¥–∞–Ω—ã –±–∞–∑–æ–≤—ã–µ –º–æ–¥–µ–ª–∏ –¥–∞–Ω–Ω—ã—Ö (User, ProjectWallet, UserCycle, Transaction, SupportTicket)
‚úÖ –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω health check —ç–Ω–¥–ø–æ–∏–Ω—Ç –¥–ª—è –±—ç–∫–µ–Ω–¥–∞
‚úÖ –ù–∞—Å—Ç—Ä–æ–µ–Ω–∞ –¥–∏–∑–∞–π–Ω-—Å–∏—Å—Ç–µ–º–∞ "Trust Flow" –Ω–∞ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–µ (Tailwind CSS, —Ü–≤–µ—Ç–∞, —à—Ä–∏—Ñ—Ç—ã)
‚úÖ –°–æ–∑–¥–∞–Ω UI –∫–æ–º–ø–æ–Ω–µ–Ω—Ç Button —Å 4 —Å–æ—Å—Ç–æ—è–Ω–∏—è–º–∏
‚úÖ –ù–∞—Å—Ç—Ä–æ–µ–Ω—ã –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏

### –°–û–ó–î–ê–ù–ù–´–ï –ö–û–ú–ü–û–ù–ï–ù–¢–´ (–ø–æ –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç—É –¢–ó):

**C3 - MISSION-CRITICAL:**
1. ‚ùå –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π –±–ª–æ–∫—á–µ–π–Ω–∞ - TransactionService
2. ‚ùå –ü—Ä–∏–≤—è–∑–∫–∞ –∫–æ—à–µ–ª—å–∫–æ–≤ - WalletService
3. ‚ùå –®–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ –∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å - AuthService
4. ‚ùå –†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Å—Ä–µ–¥—Å—Ç–≤ - ReferralService

**C2 - BUSINESS-CRITICAL:**
1. ‚ùå –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π - UserService (—Å–ª–µ–¥—É—é—â–∞—è –∑–∞–¥–∞—á–∞)
2. ‚ùå –†–µ—Ñ–µ—Ä–∞–ª—å–Ω–∞—è –ª–æ–≥–∏–∫–∞ - ReferralService
3. ‚ùå –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ü–∏–∫–ª–∞–º–∏ - CycleService
4. ‚ùå –û—á–µ—Ä–µ–¥–∏ –∏ —Å–ª–æ—Ç—ã - QueueService

**C1 - IMPORTANT:**
1. ‚ùå API —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã (–Ω–µ–∫—Ä–∏—Ç–∏—á–Ω—ã–µ)
2. ‚¨ú UI-–ª–æ–≥–∏–∫–∞ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–∞ (–Ω–∞—á–∞—Ç–∞: Button –∫–æ–º–ø–æ–Ω–µ–Ω—Ç)
3. ‚ùå –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è - NotificationService
4. ‚ùå –ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å - AdminService (—Ä—É—Å—Å–∫–∏–π —è–∑—ã–∫)
5. ‚ùå –¢–µ—Ö–ø–æ–¥–¥–µ—Ä–∂–∫–∞ - SupportService

**C0 - UTILITY:**
1. ‚úÖ –ë–∞–∑–æ–≤–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞ (–±—ç–∫–µ–Ω–¥ + —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥)
2. ‚úÖ –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã (.env, docker-compose.yml)
3. ‚úÖ –°—Ç–∞—Ç–∏—á–µ—Å–∫–∏–µ —Ñ–∞–π–ª—ã
4. ‚úÖ –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è (README, –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –∑–∞–ø—É—Å–∫–∞)

### –°–õ–ï–î–£–Æ–©–ê–Ø –ó–ê–î–ê–ß–ê (–ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç C2 ‚Üí C3):
**–†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å UserService (C2) –∏ AuthService (C2) —Å –ø–æ–ª–Ω–æ–π –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–µ–π JWT:**
1. –ó–∞–≤–µ—Ä—à–∏—Ç—å –º–æ–¥–µ–ª–∏ User –∏ —Å–≤—è–∑–∞–Ω–Ω—ã–µ –º–æ–¥–µ–ª–∏
2. –°–æ–∑–¥–∞—Ç—å Pydantic —Å—Ö–µ–º—ã –¥–ª—è —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏, –≤—Ö–æ–¥–∞, –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
3. –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å UserService —Å –º–µ—Ç–æ–¥–∞–º–∏: create_user, get_user_by_email, update_user_status
4. –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å AuthService —Å –º–µ—Ç–æ–¥–∞–º–∏: authenticate_user, create_access_token, verify_token
5. –°–æ–∑–¥–∞—Ç—å API —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã: POST /api/v1/auth/register, POST /api/v1/auth/login
6. –î–æ–±–∞–≤–∏—Ç—å –∑–∞—â–∏—Ç—É —ç–Ω–¥–ø–æ–∏–Ω—Ç–æ–≤ —á–µ—Ä–µ–∑ JWT –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
7. –°–æ–∑–¥–∞—Ç—å —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã Registration –∏ Login —Å –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–µ–π API

### –í–ê–ñ–ù–´–ï –¢–ï–•–ù–ò–ß–ï–°–ö–ò–ï –î–ï–¢–ê–õ–ò:
- **–ë—ç–∫–µ–Ω–¥ —Å—Ç–µ–∫:** Python 3.10+, FastAPI, PostgreSQL, Redis, SQLAlchemy 2.0, Pydantic 2.0, aiotrond
- **–§—Ä–æ–Ω—Ç–µ–Ω–¥ —Å—Ç–µ–∫:** React 18 + TypeScript, Tailwind CSS + Headless UI, Framer Motion, Lucide React, React Query, Zustand
- **–î–∏–∑–∞–π–Ω-—Å–∏—Å—Ç–µ–º–∞:** "Trust Flow" (–±–µ–ª–æ-–≥–æ–ª—É–±–∞—è –≥–∞–º–º–∞ –¥–æ–≤–µ—Ä–∏—è, Inter —à—Ä–∏—Ñ—Ç)
- **–¢–µ—Ä–º–∏–Ω–æ–ª–æ–≥–∏—è:** "transfer", "donate", "contribution" (–ù–ï "payment")
- **–Ø–∑—ã–∫ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞:** –∞–Ω–≥–ª–∏–π—Å–∫–∏–π –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π, —Ä—É—Å—Å–∫–∏–π –¥–ª—è –∞–¥–º–∏–Ω–æ–≤
- **–ó–∞–ø—Ä–µ—â–µ–Ω—ã –±–∏—Ä–∂–µ–≤—ã–µ –∫–æ—à–µ–ª—å–∫–∏:** –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–∞ –≤–∞–ª–∏–¥–∞—Ü–∏—è –≤ WalletService
- **–¢–∞–π–º–µ—Ä —Ü–∏–∫–ª–æ–≤:** 24 —á–∞—Å–∞, —Ö—Ä–∞–Ω–∏—Ç—å –≤ Redis (–∫—ç—à), –∏—Å—Ç–æ—á–Ω–∏–∫ –∏—Å—Ç–∏–Ω—ã –≤ PostgreSQL
- **–ü—Ä–æ–≤–µ—Ä–∫–∞ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π:** 3-—É—Ä–æ–≤–Ω–µ–≤–∞—è (webhook ‚Üí polling ‚Üí manual review)

### –°–¢–†–£–ö–¢–£–†–ê –ü–†–û–ï–ö–¢–ê (–∞–∫—Ç—É–∞–ª—å–Ω–∞—è):
```
fastagain-backend/                    # –ë—ç–∫–µ–Ω–¥ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π
‚îú‚îÄ‚îÄ app/
‚îÇ   ‚îú‚îÄ‚îÄ core/           # config.py, database.py, security.py
‚îÇ   ‚îú‚îÄ‚îÄ models/         # user.py, transaction.py, cycle.py, project_wallet.py, support_ticket.py
‚îÇ   ‚îú‚îÄ‚îÄ schemas/        # Pydantic —Å—Ö–µ–º—ã (–Ω–∞—á–∞—Ç—ã)
‚îÇ   ‚îú‚îÄ‚îÄ api/v1/endpoints/ # –≠–Ω–¥–ø–æ–∏–Ω—Ç—ã (health, auth - –≤ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ)
‚îÇ   ‚îî‚îÄ‚îÄ main.py         # –¢–æ—á–∫–∞ –≤—Ö–æ–¥–∞ FastAPI
‚îú‚îÄ‚îÄ requirements/       # –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ Python
‚îú‚îÄ‚îÄ docker-compose.yml  # PostgreSQL 15, Redis 7, –±—ç–∫–µ–Ω–¥
‚îî‚îÄ‚îÄ .env.example        # SECRET_KEY, DATABASE_URL, REDIS_URL, TRON_API_KEY

fastagain-frontend/                    # –§—Ä–æ–Ω—Ç–µ–Ω–¥ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π
‚îú‚îÄ‚îÄ src/
‚îÇ   ‚îú‚îÄ‚îÄ components/     # UI-KIT: Button (–≥–æ—Ç–æ–≤), –¥—Ä—É–≥–∏–µ –≤ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ
‚îÇ   ‚îú‚îÄ‚îÄ pages/         # –≠–∫—Ä–∞–Ω—ã: Home, NotFound (–Ω–∞—á–∞—Ç—ã)
‚îÇ   ‚îú‚îÄ‚îÄ hooks/         # useTheme (–≥–æ—Ç–æ–≤)
‚îÇ   ‚îú‚îÄ‚îÄ services/      # API –∫–ª–∏–µ–Ω—Ç—ã (–Ω–∞—á–∞—Ç—ã)
‚îÇ   ‚îú‚îÄ‚îÄ styles/        # Tailwind config, –≥–ª–æ–±–∞–ª—å–Ω—ã–µ —Å—Ç–∏–ª–∏
‚îÇ   ‚îî‚îÄ‚îÄ App.tsx        # –¢–æ—á–∫–∞ –≤—Ö–æ–¥–∞ React
‚îú‚îÄ‚îÄ tailwind.config.js # –î–∏–∑–∞–π–Ω-—Å–∏—Å—Ç–µ–º–∞ "Trust Flow"
‚îú‚îÄ‚îÄ package.json       # –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ React
‚îî‚îÄ‚îÄ tsconfig.json     # TypeScript –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
```

### –ö–û–ú–ê–ù–î–´ –î–õ–Ø –ó–ê–ü–£–°–ö–ê:
**–ü–æ–ª–Ω—ã–π –∑–∞–ø—É—Å–∫ (–±—ç–∫–µ–Ω–¥ + —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥):**
```bash
# 1. –ó–∞–ø—É—Å—Ç–∏ –±—ç–∫–µ–Ω–¥
cd fastagain-backend
cp .env.example .env
# –¥–æ–±–∞–≤—å SECRET_KEY, DATABASE_URL, REDIS_URL, TRON_API_KEY –≤ .env
docker-compose up -d
pip install -r requirements/dev.txt
alembic upgrade head
uvicorn app.main:app --reload --host 0.0.0.0 --port 8000

# 2. –ó–∞–ø—É—Å—Ç–∏ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥ (–Ω–æ–≤—ã–π —Ç–µ—Ä–º–∏–Ω–∞–ª)
cd ../fastagain-frontend
npm install
npm run dev

# 3. –ü—Ä–æ–≤–µ—Ä—å —Ä–∞–±–æ—Ç—É
curl http://localhost:8000/api/v1/health  # –ë—ç–∫–µ–Ω–¥
# –û—Ç–∫—Ä–æ–π –≤ –±—Ä–∞—É–∑–µ—Ä–µ: http://localhost:3000  # –§—Ä–æ–Ω—Ç–µ–Ω–¥
```

### –°–°–´–õ–ö–ò –ù–ê –î–û–ö–£–ú–ï–ù–¢–ê–¶–ò–Æ:
- üìÑ –¢–µ—Ö–Ω–∏—á–µ—Å–∫–æ–µ –∑–∞–¥–∞–Ω–∏–µ: **TZ Disign Fast Again Python.txt** (—ç—Ç–∞–ª–æ–Ω–Ω–∞—è –≤–µ—Ä—Å–∏—è 3.0 —Å –¥–∏–∑–∞–π–Ω–æ–º)
- üó∫Ô∏è –≠—Ç–∞ —É–º–Ω–∞—è –∫–∞—Ä—Ç–∞: **–°–¢–ê–¢–ò–ß–ù–ê–Ø –£–ú–ù–ê–Ø –ö–ê–†–¢–ê FastAgain.txt**
- üìù –ü—Ä–µ–¥—ã–¥—É—â–∏–π –æ—Ç–≤–µ—Ç: [—ç—Ç–æ—Ç –æ—Ç–≤–µ—Ç - –ø–µ—Ä–≤—ã–π –≤ —Ü–µ–ø–æ—á–∫–µ]
- üé® Figma —Ñ–∞–π–ª: design.fastagain.io (–≤—Å–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –∏ —ç–∫—Ä–∞–Ω—ã)
- üìö API –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è: http://localhost:8000/docs (–±—É–¥–µ—Ç –¥–æ—Å—Ç—É–ø–Ω–∞ –ø–æ—Å–ª–µ –∑–∞–ø—É—Å–∫–∞ –±—ç–∫–µ–Ω–¥–∞)



 2 –æ—Ç–≤–µ—Ç  *************************************************************

# **üéØ –¢–ï–ö–£–©–ê–Ø –ó–ê–î–ê–ß–ê: –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ô –ê–ù–ê–õ–ò–ó –ò –ò–°–ü–†–ê–í–õ–ï–ù–ò–ï –í–°–ï–• –û–®–ò–ë–û–ö –í –ö–û–î–ï**

–ü–æ—Å–ª–µ –≥–ª—É–±–æ–∫–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞ –∫–æ–¥–∞ –≤—ã—è–≤–ª–µ–Ω—ã –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –æ—à–∏–±–∫–∏. –†–µ–∞–ª–∏–∑—É–µ—Ç—Å—è –ø–æ–ª–Ω–æ–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –¥–ª—è 100% —Ä–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏ —Å–∏—Å—Ç–µ–º—ã.

## üìä –°–¢–ê–¢–£–° –ü–†–û–ï–ö–¢–ê (–ø–æ—Å–ª–µ —ç—Ç–æ–≥–æ –æ—Ç–≤–µ—Ç–∞):


---

## üìÅ –°–û–ó–î–ê–ù–ù–´–ï –ò –ò–°–ü–†–ê–í–õ–ï–ù–ù–´–ï –§–ê–ô–õ–´:

### **–ö–†–ò–¢–ò–ß–ï–°–ö–ò–ï –û–®–ò–ë–ö–ò, –ö–û–¢–û–†–´–ï –ë–´–õ–ò –ò–°–ü–†–ê–í–õ–ï–ù–´:**

### **1. –ë–≠–ö–ï–ù–î: –§–£–ù–î–ê–ú–ï–ù–¢–ê–õ–¨–ù–´–ï –ü–†–û–ë–õ–ï–ú–´:**
```
‚ùå –ü–†–û–ë–õ–ï–ú–ê 1: –ù–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω–∞—è —Ä–∞–±–æ—Ç–∞ —Å –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–º–∏ —Å–µ—Å—Å–∏—è–º–∏ SQLAlchemy
‚ùå –ü–†–û–ë–õ–ï–ú–ê 2: –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–≥–æ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π FastAPI
‚ùå –ü–†–û–ë–õ–ï–ú–ê 3: –û—à–∏–±–∫–∏ –≤ –º–∏–≥—Ä–∞—Ü–∏—è—Ö Alembic (–æ—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –≤–µ—Ä—Å–∏–π)
‚ùå –ü–†–û–ë–õ–ï–ú–ê 4: –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ JWT —Ç–æ–∫–µ–Ω–æ–≤
‚ùå –ü–†–û–ë–õ–ï–ú–ê 5: –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –≤–∞–ª–∏–¥–∞—Ü–∏–∏ referral –∫–æ–¥–æ–≤
‚ùå –ü–†–û–ë–õ–ï–ú–ê 6: –û—à–∏–±–∫–∏ –≤ —Ü–∏–∫–ª–∏—á–µ—Å–∫–∏—Ö –∏–º–ø–æ—Ä—Ç–∞—Ö
```

### **2. –§–†–û–ù–¢–ï–ù–î: –§–£–ù–î–ê–ú–ï–ù–¢–ê–õ–¨–ù–´–ï –ü–†–û–ë–õ–ï–ú–´:**
```
‚ùå –ü–†–û–ë–õ–ï–ú–ê 1: React Router v6 - –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ Routes
‚ùå –ü–†–û–ë–õ–ï–ú–ê 2: TypeScript —Ç–∏–ø—ã - –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–µ —Å—Ç—Ä–æ–≥–æ–π —Ç–∏–ø–∏–∑–∞—Ü–∏–∏
‚ùå –ü–†–û–ë–õ–ï–ú–ê 3: Zustand store - –Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω–∞—è –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
‚ùå –ü–†–û–ë–õ–ï–ú–ê 4: API –∫–ª–∏–µ–Ω—Ç - –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –æ—à–∏–±–æ–∫
‚ùå –ü–†–û–ë–õ–ï–ú–ê 5: Tailwind CSS - –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
‚ùå –ü–†–û–ë–õ–ï–ú–ê 6: React Query - –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–π –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
```

---

## üöÄ –ö–ê–ö –ó–ê–ü–£–°–¢–ò–¢–¨ (–ò–°–ü–†–ê–í–õ–ï–ù–ù–ê–Ø –í–ï–†–°–ò–Ø):

### **1. –ù–ê–°–¢–†–û–ô–ö–ê –ë–≠–ö–ï–ù–î–ê:**
```bash
cd fastagain-backend

# 1. –°–æ–∑–¥–∞–π –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ
python -m venv venv
source venv/bin/activate  # Linux/Mac
# venv\Scripts\activate   # Windows

# 2. –£—Å—Ç–∞–Ω–æ–≤–∏ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
pip install -r requirements/base.txt

# 3. –ù–∞—Å—Ç—Ä–æ–π –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è
cp .env.example .env
# –û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π .env:
# SECRET_KEY=your-super-secret-jwt-key-min-32-chars
# DATABASE_URL=postgresql+asyncpg://postgres:postgres@localhost:5432/fastagain
# REDIS_URL=redis://localhost:6379/0

# 4. –ó–∞–ø—É—Å—Ç–∏ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö
docker-compose up -d postgres redis

# 5. –°–æ–∑–¥–∞–π –∏ –ø—Ä–∏–º–µ–Ω–∏ –º–∏–≥—Ä–∞—Ü–∏–∏
alembic upgrade head

# 6. –ó–∞–ø—É—Å—Ç–∏ —Å–µ—Ä–≤–µ—Ä
uvicorn app.main:app --reload --host 0.0.0.0 --port 8000
```

### **2. –ù–ê–°–¢–†–û–ô–ö–ê –§–†–û–ù–¢–ï–ù–î–ê:**
```bash
cd fastagain-frontend

# 1. –£—Å—Ç–∞–Ω–æ–≤–∏ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
npm install

# 2. –ó–∞–ø—É—Å—Ç–∏ —Å–µ—Ä–≤–µ—Ä —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏
npm run dev

# 3. –û—Ç–∫—Ä–æ–π –≤ –±—Ä–∞—É–∑–µ—Ä–µ
# http://localhost:3000
```

### **3. –¢–ï–°–¢–ò–†–û–í–ê–ù–ò–ï –ê–ü–ò:**
```bash
# –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
curl -X POST http://localhost:8000/api/v1/auth/register \
  -H "Content-Type: application/json" \
  -d '{
    "email": "test@example.com",
    "password": "SecurePass123!",
    "referral_code": "FA-TEST1"
  }'

# –í—Ö–æ–¥ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
curl -X POST http://localhost:8000/api/v1/auth/login \
  -H "Content-Type: application/json" \
  -d '{
    "email": "test@example.com",
    "password": "SecurePass123!"
  }'
```

---

## üì¶ **–ü–û–õ–ù–´–ô –ò–°–ü–†–ê–í–õ–ï–ù–ù–´–ô –ö–û–î:**

### **1. –ë–≠–ö–ï–ù–î: app/core/database.py**
```python
"""
Database configuration with async SQLAlchemy
"""
from sqlalchemy.ext.asyncio import AsyncSession, create_async_engine, async_sessionmaker
from sqlalchemy.orm import declarative_base
from sqlalchemy.pool import NullPool
from app.core.config import settings
import logging

logger = logging.getLogger(__name__)

# Create async engine
engine = create_async_engine(
    str(settings.DATABASE_URL),
    echo=False,  # Set to True for SQL debugging
    poolclass=NullPool,  # Disable connection pooling for development
    future=True,
)

# Create async session factory
AsyncSessionLocal = async_sessionmaker(
    engine,
    class_=AsyncSession,
    expire_on_commit=False,
    autocommit=False,
    autoflush=False,
)

# Base class for models
Base = declarative_base()


async def get_db() -> AsyncSession:
    """
    Dependency function that yields db sessions
    Usage: in FastAPI endpoints with Depends(get_db)
    """
    async with AsyncSessionLocal() as session:
        try:
            yield session
            await session.commit()
        except Exception:
            await session.rollback()
            raise
        finally:
            await session.close()


async def init_db():
    """Initialize database tables"""
    async with engine.begin() as conn:
        # Create all tables
        await conn.run_sync(Base.metadata.create_all)
    logger.info("Database initialized successfully")


async def close_db():
    """Close database connections"""
    await engine.dispose()
    logger.info("Database connections closed")
```

### **2. –ë–≠–ö–ï–ù–î: app/core/dependencies.py**
```python
"""
FastAPI dependencies for authentication and authorization
"""
from typing import Optional
from fastapi import Depends, HTTPException, status
from fastapi.security import HTTPBearer, HTTPAuthorizationCredentials
from sqlalchemy.ext.asyncio import AsyncSession
from app.core.database import get_db
from app.services.auth_service import AuthService
from app.models.user import User

security = HTTPBearer()


async def get_current_user(
    credentials: HTTPAuthorizationCredentials = Depends(security),
    db: AsyncSession = Depends(get_db),
) -> User:
    """
    Get current authenticated user from JWT token
    """
    if not credentials:
        raise HTTPException(
            status_code=status.HTTP_401_UNAUTHORIZED,
            detail="Not authenticated",
            headers={"WWW-Authenticate": "Bearer"},
        )
    
    token = credentials.credentials
    auth_service = AuthService(db)
    
    user = await auth_service.get_current_user(token)
    if not user:
        raise HTTPException(
            status_code=status.HTTP_401_UNAUTHORIZED,
            detail="Invalid authentication credentials",
            headers={"WWW-Authenticate": "Bearer"},
        )
    
    return user


async def get_current_active_user(
    current_user: User = Depends(get_current_user),
) -> User:
    """
    Get current active user (must be active)
    """
    if not current_user.is_active:
        raise HTTPException(
            status_code=status.HTTP_400_BAD_REQUEST,
            detail="Inactive user"
        )
    return current_user


async def get_current_admin_user(
    current_user: User = Depends(get_current_user),
) -> User:
    """
    Get current admin user (must have admin role)
    """
    # In future, check for admin role
    # For now, just return active user
    if not current_user.is_active:
        raise HTTPException(
            status_code=status.HTTP_403_FORBIDDEN,
            detail="Not enough permissions"
        )
    return current_user
```

### **3. –ë–≠–ö–ï–ù–î: app/api/v1/api.py**
```python
"""
API v1 router configuration
"""
from fastapi import APIRouter
from app.api.v1.endpoints import auth, users, health

api_router = APIRouter()

# Include all endpoint routers
api_router.include_router(auth.router, prefix="/auth", tags=["authentication"])
api_router.include_router(users.router, prefix="/users", tags=["users"])
api_router.include_router(health.router, prefix="/health", tags=["health"])
```

### **4. –ë–≠–ö–ï–ù–î: alembic/env.py**
```python
"""
Alembic environment configuration for database migrations
"""
import asyncio
from logging.config import fileConfig
from sqlalchemy import pool
from sqlalchemy.engine import Connection
from sqlalchemy.ext.asyncio import async_engine_from_config
from alembic import context
import sys
import os

# Add the app directory to Python path
sys.path.append(os.path.dirname(os.path.dirname(__file__)))

from app.core.config import settings
from app.core.database import Base
from app.models.user import User  # Import all models
from app.models.base import BaseModel

# Alembic Config object
config = context.config

# Set SQLAlchemy URL from settings
config.set_main_option("sqlalchemy.url", str(settings.DATABASE_URL))

# Configure logging
if config.config_file_name is not None:
    fileConfig(config.config_file_name)

# Target metadata for migrations
target_metadata = Base.metadata


def run_migrations_offline() -> None:
    """Run migrations in 'offline' mode."""
    url = config.get_main_option("sqlalchemy.url")
    context.configure(
        url=url,
        target_metadata=target_metadata,
        literal_binds=True,
        dialect_opts={"paramstyle": "named"},
    )

    with context.begin_transaction():
        context.run_migrations()


def do_run_migrations(connection: Connection) -> None:
    """Run migrations in the given connection."""
    context.configure(connection=connection, target_metadata=target_metadata)

    with context.begin_transaction():
        context.run_migrations()


async def run_async_migrations() -> None:
    """Run migrations in async mode."""
    connectable = async_engine_from_config(
        config.get_section(config.config_ini_section, {}),
        prefix="sqlalchemy.",
        poolclass=pool.NullPool,
    )

    async with connectable.connect() as connection:
        await connection.run_sync(do_run_migrations)

    await connectable.dispose()


def run_migrations_online() -> None:
    """Run migrations in 'online' mode."""
    asyncio.run(run_async_migrations())


if context.is_offline_mode():
    run_migrations_offline()
else:
    run_migrations_online()
```

### **5. –ë–≠–ö–ï–ù–î: alembic/script.py.mako**
```mako
"""${message}

Revision ID: ${up_revision}
Revises: ${down_revision | comma,n}
Create Date: ${create_date}

"""
from alembic import op
import sqlalchemy as sa
${imports if imports else ""}

# revision identifiers, used by Alembic.
revision = ${repr(up_revision)}
down_revision = ${repr(down_revision)}
branch_labels = ${repr(branch_labels)}
depends_on = ${repr(depends_on)}


def upgrade() -> None:
    ${upgrades if upgrades else "pass"}


def downgrade() -> None:
    ${downgrades if downgrades else "pass"}
```

### **6. –ë–≠–ö–ï–ù–î: alembic/versions/001_initial_migration.py**
```python
"""Initial migration

Revision ID: 001_initial_migration
Revises: 
Create Date: 2024-01-23 12:00:00.000000

"""
from alembic import op
import sqlalchemy as sa
from sqlalchemy.dialects import postgresql

# revision identifiers, used by Alembic.
revision = '001_initial_migration'
down_revision = None
branch_labels = None
depends_on = None


def upgrade() -> None:
    # Create users table
    op.create_table('user',
        sa.Column('id', sa.Integer(), nullable=False),
        sa.Column('created_at', sa.DateTime(timezone=True), server_default=sa.text('now()'), nullable=False),
        sa.Column('updated_at', sa.DateTime(timezone=True), nullable=True),
        sa.Column('email', sa.String(length=255), nullable=False),
        sa.Column('hashed_password', sa.String(length=255), nullable=False),
        sa.Column('referral_code', sa.String(length=20), nullable=False),
        sa.Column('referred_by_id', sa.Integer(), nullable=True),
        sa.Column('main_status', sa.String(length=50), nullable=False),
        sa.Column('sub_status', sa.String(length=50), nullable=True),
        sa.Column('cycle_number', sa.Integer(), nullable=False),
        sa.Column('wallet_address', sa.String(length=255), nullable=True),
        sa.Column('wallet_status', sa.String(length=50), nullable=True),
        sa.Column('participation_purpose', sa.Text(), nullable=True),
        sa.Column('is_active', sa.Boolean(), nullable=False),
        sa.Column('email_verified', sa.Boolean(), nullable=False),
        sa.Column('email_verified_at', sa.DateTime(timezone=True), nullable=True),
        sa.PrimaryKeyConstraint('id'),
        sa.ForeignKeyConstraint(['referred_by_id'], ['user.id'], ),
    )
    
    # Create indexes
    op.create_index(op.f('ix_user_email'), 'user', ['email'], unique=True)
    op.create_index(op.f('ix_user_referral_code'), 'user', ['referral_code'], unique=True)
    op.create_index(op.f('ix_user_id'), 'user', ['id'], unique=False)
    op.create_index(op.f('ix_user_referred_by_id'), 'user', ['referred_by_id'], unique=False)
    op.create_index(op.f('ix_user_main_status'), 'user', ['main_status'], unique=False)
    op.create_index(op.f('ix_user_wallet_address'), 'user', ['wallet_address'], unique=True)


def downgrade() -> None:
    # Drop indexes
    op.drop_index(op.f('ix_user_wallet_address'), table_name='user')
    op.drop_index(op.f('ix_user_main_status'), table_name='user')
    op.drop_index(op.f('ix_user_referred_by_id'), table_name='user')
    op.drop_index(op.f('ix_user_id'), table_name='user')
    op.drop_index(op.f('ix_user_referral_code'), table_name='user')
    op.drop_index(op.f('ix_user_email'), table_name='user')
    
    # Drop table
    op.drop_table('user')
```

### **7. –ë–≠–ö–ï–ù–î: requirements/base.txt**
```txt
# Core dependencies
fastapi==0.104.1
uvicorn[standard]==0.24.0

# Database
sqlalchemy==2.0.23
asyncpg==0.29.0
alembic==1.12.1
psycopg2-binary==2.9.9

# Authentication and security
python-jose[cryptography]==3.3.0
passlib[bcrypt]==1.7.4
python-multipart==0.0.6

# Configuration
pydantic==2.5.0
pydantic-settings==2.1.0
python-dotenv==1.0.0

# Async
anyio==3.7.1

# Development
python-dateutil==2.8.2
pytz==2023.3.post1

# Logging
structlog==23.2.0
```

### **8. –ë–≠–ö–ï–ù–î: docker-compose.yml**
```yaml
version: '3.8'

services:
  postgres:
    image: postgres:15-alpine
    container_name: fastagain-postgres
    environment:
      POSTGRES_DB: fastagain
      POSTGRES_USER: postgres
      POSTGRES_PASSWORD: postgres
    ports:
      - "5432:5432"
    volumes:
      - postgres_data:/var/lib/postgresql/data
      - ./init.sql:/docker-entrypoint-initdb.d/init.sql
    healthcheck:
      test: ["CMD-SHELL", "pg_isready -U postgres"]
      interval: 10s
      timeout: 5s
      retries: 5

  redis:
    image: redis:7-alpine
    container_name: fastagain-redis
    ports:
      - "6379:6379"
    volumes:
      - redis_data:/data
    command: redis-server --appendonly yes
    healthcheck:
      test: ["CMD", "redis-cli", "ping"]
      interval: 10s
      timeout: 5s
      retries: 5

  backend:
    build: .
    container_name: fastagain-backend
    depends_on:
      postgres:
        condition: service_healthy
      redis:
        condition: service_healthy
    environment:
      DATABASE_URL: postgresql+asyncpg://postgres:postgres@postgres:5432/fastagain
      REDIS_URL: redis://redis:6379/0
      SECRET_KEY: ${SECRET_KEY:-development-secret-key}
    ports:
      - "8000:8000"
    volumes:
      - ./app:/app/app
    command: uvicorn app.main:app --host 0.0.0.0 --port 8000 --reload

volumes:
  postgres_data:
  redis_data:
```

### **9. –§–†–û–ù–¢–ï–ù–î: src/main.tsx**
```tsx
/**
 * Main entry point for React application
 */
import React from 'react';
import ReactDOM from 'react-dom/client';
import App from './App';
import './styles/globals.css';

// Enable React 18 concurrent mode
const rootElement = document.getElementById('root');
if (!rootElement) throw new Error('Failed to find the root element');

const root = ReactDOM.createRoot(rootElement);

root.render(
  <React.StrictMode>
    <App />
  </React.StrictMode>
);
```

### **10. –§–†–û–ù–¢–ï–ù–î: src/components/ui/Button/Button.tsx**
```tsx
/**
 * Button component with Trust Flow design system
 * C1 - Important component (Proof-Level P1)
 */
import React from 'react';
import { Loader2 } from 'lucide-react';
import { cva, type VariantProps } from 'class-variance-authority';
import { cn } from '../../../utils/helpers';

// Button variants using class-variance-authority
const buttonVariants = cva(
  'inline-flex items-center justify-center rounded-lg font-medium transition-all duration-200 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-primary-500 focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50',
  {
    variants: {
      variant: {
        primary: 'bg-primary-500 text-white hover:bg-primary-600 active:bg-primary-700 shadow-lg hover:shadow-xl',
        secondary: 'bg-gray-100 text-gray-900 hover:bg-gray-200 active:bg-gray-300',
        outline: 'border border-primary-500 text-primary-700 hover:bg-primary-50 active:bg-primary-100',
        ghost: 'text-gray-700 hover:bg-gray-100 active:bg-gray-200',
        danger: 'bg-red-500 text-white hover:bg-red-600 active:bg-red-700',
      },
      size: {
        sm: 'h-9 px-4 text-sm',
        md: 'h-11 px-6 text-base',
        lg: 'h-14 px-8 text-lg',
        xl: 'h-16 px-10 text-xl',
      },
      fullWidth: {
        true: 'w-full',
      },
    },
    defaultVariants: {
      variant: 'primary',
      size: 'md',
    },
  }
);

export interface ButtonProps
  extends React.ButtonHTMLAttributes<HTMLButtonElement>,
    VariantProps<typeof buttonVariants> {
  isLoading?: boolean;
  leftIcon?: React.ReactNode;
  rightIcon?: React.ReactNode;
}

const Button = React.forwardRef<HTMLButtonElement, ButtonProps>(
  ({ className, variant, size, fullWidth, isLoading, leftIcon, rightIcon, children, disabled, ...props }, ref) => {
    return (
      <button
        className={cn(buttonVariants({ variant, size, fullWidth, className }))}
        ref={ref}
        disabled={disabled || isLoading}
        {...props}
      >
        {isLoading && (
          <Loader2 className="mr-2 h-4 w-4 animate-spin" />
        )}
        {!isLoading && leftIcon && (
          <span className="mr-2">{leftIcon}</span>
        )}
        {children}
        {!isLoading && rightIcon && (
          <span className="ml-2">{rightIcon}</span>
        )}
      </button>
    );
  }
);

Button.displayName = 'Button';

export { Button, buttonVariants };
```

### **11. –§–†–û–ù–¢–ï–ù–î: src/components/ui/Input/Input.tsx**
```tsx
/**
 * Input component with validation states
 * C1 - Important component (Proof-Level P1)
 */
import React from 'react';
import { cn } from '../../../utils/helpers';

export interface InputProps extends React.InputHTMLAttributes<HTMLInputElement> {
  label?: string;
  helperText?: string;
  error?: boolean;
  success?: boolean;
  leftIcon?: React.ReactNode;
  rightIcon?: React.ReactNode;
  fullWidth?: boolean;
}

const Input = React.forwardRef<HTMLInputElement, InputProps>(
  ({ className, label, helperText, error, success, leftIcon, rightIcon, fullWidth, ...props }, ref) => {
    const inputId = props.id || `input-${Math.random().toString(36).substr(2, 9)}`;

    return (
      <div className={cn('space-y-2', fullWidth && 'w-full')}>
        {label && (
          <label
            htmlFor={inputId}
            className="block text-sm font-medium text-gray-700"
          >
            {label}
          </label>
        )}

        <div className="relative">
          {leftIcon && (
            <div className="absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400">
              {leftIcon}
            </div>
          )}

          <input
            ref={ref}
            id={inputId}
            className={cn(
              'h-11 rounded-lg border px-4 py-2 text-base transition-colors duration-200',
              'focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-transparent',
              'disabled:cursor-not-allowed disabled:opacity-50',
              leftIcon && 'pl-10',
              rightIcon && 'pr-10',
              error
                ? 'border-red-300 bg-red-50 text-red-900 placeholder-red-300 focus:ring-red-500'
                : success
                ? 'border-green-300 bg-green-50 text-green-900 placeholder-green-300 focus:ring-green-500'
                : 'border-gray-300 bg-white text-gray-900 placeholder-gray-400 hover:border-gray-400',
              fullWidth && 'w-full',
              className
            )}
            {...props}
          />

          {rightIcon && (
            <div className="absolute right-3 top-1/2 transform -translate-y-1/2">
              {rightIcon}
            </div>
          )}
        </div>

        {helperText && (
          <p
            className={cn(
              'text-sm',
              error
                ? 'text-red-600'
                : success
                ? 'text-green-600'
                : 'text-gray-500'
            )}
          >
            {helperText}
          </p>
        )}
      </div>
    );
  }
);

Input.displayName = 'Input';

export { Input };
```

### **12. –§–†–û–ù–¢–ï–ù–î: src/utils/helpers.ts**
```tsx
/**
 * Utility helper functions
 */
import { type ClassValue, clsx } from 'clsx';
import { twMerge } from 'tailwind-merge';

/**
 * Merge Tailwind CSS classes properly
 */
export function cn(...inputs: ClassValue[]) {
  return twMerge(clsx(inputs));
}

/**
 * Format currency
 */
export function formatCurrency(amount: number, currency: string = 'USD'): string {
  return new Intl.NumberFormat('en-US', {
    style: 'currency',
    currency,
    minimumFractionDigits: 2,
    maximumFractionDigits: 2,
  }).format(amount);
}

/**
 * Format date
 */
export function formatDate(date: Date | string, format: 'short' | 'long' = 'short'): string {
  const dateObj = typeof date === 'string' ? new Date(date) : date;
  
  return new Intl.DateTimeFormat('en-US', {
    dateStyle: format === 'short' ? 'short' : 'long',
    timeStyle: format === 'short' ? 'short' : 'long',
  }).format(dateObj);
}

/**
 * Truncate text with ellipsis
 */
export function truncateText(text: string, maxLength: number): string {
  if (text.length <= maxLength) return text;
  return text.substring(0, maxLength) + '...';
}

/**
 * Generate a unique ID
 */
export function generateId(): string {
  return Math.random().toString(36).substr(2, 9);
}

/**
 * Debounce function
 */
export function debounce<T extends (...args: any[]) => any>(
  func: T,
  wait: number
): (...args: Parameters<T>) => void {
  let timeout: NodeJS.Timeout;
  
  return (...args: Parameters<T>) => {
    clearTimeout(timeout);
    timeout = setTimeout(() => func(...args), wait);
  };
}
```

### **13. –§–†–û–ù–¢–ï–ù–î: src/types/api.ts**
```ts
/**
 * TypeScript types for API responses
 */

// User types
export interface User {
  id: number;
  email: string;
  referral_code: string;
  referred_by_id: number | null;
  main_status: string;
  sub_status: string | null;
  cycle_number: number;
  wallet_address: string | null;
  wallet_status: string | null;
  participation_purpose: string | null;
  is_active: boolean;
  email_verified: boolean;
  email_verified_at: string | null;
  created_at: string;
  updated_at: string | null;
}

// Authentication types
export interface AuthTokens {
  access_token: string;
  refresh_token: string;
  token_type: string;
}

export interface LoginCredentials {
  email: string;
  password: string;
}

export interface RegistrationData {
  email: string;
  password: string;
  referral_code?: string;
}

export interface RefreshTokenRequest {
  refresh_token: string;
}

export interface RefreshTokenResponse {
  access_token: string;
  token_type: string;
}

// API Response types
export interface ApiResponse<T = any> {
  data: T;
  message?: string;
  success: boolean;
  timestamp: string;
}

export interface PaginatedResponse<T = any> {
  items: T[];
  total: number;
  page: number;
  per_page: number;
  total_pages: number;
}

// Error types
export interface ApiError {
  detail: string;
  status_code: number;
  error_code?: string;
  timestamp: string;
}

// Wallet types
export interface WalletBindRequest {
  wallet_address: string;
}

export interface WalletValidationResponse {
  valid: boolean;
  is_exchange: boolean;
  message?: string;
}

// Transaction types
export interface Transaction {
  id: number;
  user_id: number;
  cycle_id: number;
  transaction_hash: string;
  sender_address: string;
  recipient_address: string;
  amount: number;
  status: 'pending' | 'confirmed' | 'failed' | 'manual_review';
  confirmations: number;
  checked_at: string | null;
  created_at: string;
}

// Cycle types
export interface Cycle {
  id: number;
  user_id: number;
  cycle_number: number;
  started_at: string;
  expires_at: string;
  completed_transactions: number;
  is_active: boolean;
}

// Referral types
export interface ReferralStats {
  total_referrals: number;
  active_referrals: number;
  completed_cycles: number;
  total_received: number;
}

// Support types
export interface SupportTicket {
  id: number;
  user_id: number;
  subject: string;
  message: string;
  status: 'open' | 'in_progress' | 'resolved' | 'closed';
  priority: 'low' | 'medium' | 'high' | 'urgent';
  admin_response: string | null;
  closed_at: string | null;
  created_at: string;
}
```

### **14. –§–†–û–ù–¢–ï–ù–î: src/utils/validation.ts**
```ts
/**
 * Validation utilities
 */

// Email validation
export const isValidEmail = (email: string): boolean => {
  const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
  return emailRegex.test(email);
};

// Password validation
export const validatePassword = (password: string): {
  isValid: boolean;
  errors: string[];
} => {
  const errors: string[] = [];
  
  if (password.length < 12) {
    errors.push('Password must be at least 12 characters');
  }
  if (!/[A-Z]/.test(password)) {
    errors.push('Password must contain at least one uppercase letter');
  }
  if (!/[a-z]/.test(password)) {
    errors.push('Password must contain at least one lowercase letter');
  }
  if (!/[0-9]/.test(password)) {
    errors.push('Password must contain at least one number');
  }
  if (!/[^A-Za-z0-9]/.test(password)) {
    errors.push('Password must contain at least one special character');
  }
  
  return {
    isValid: errors.length === 0,
    errors,
  };
};

// TRON wallet address validation
export const isValidTronAddress = (address: string): boolean => {
  // TRON addresses start with T and are 34 characters long
  const tronRegex = /^T[A-Za-z0-9]{33}$/;
  return tronRegex.test(address);
};

// Referral code validation
export const isValidReferralCode = (code: string): boolean => {
  const referralRegex = /^FA-[A-Z0-9]{5}$/;
  return referralRegex.test(code);
};

// Amount validation
export const isValidAmount = (amount: number): boolean => {
  return !isNaN(amount) && amount > 0 && amount <= 10000;
};

// URL validation
export const isValidUrl = (url: string): boolean => {
  try {
    new URL(url);
    return true;
  } catch {
    return false;
  }
};

// Phone number validation
export const isValidPhone = (phone: string): boolean => {
  const phoneRegex = /^\+?[\d\s\-\(\)]{10,}$/;
  return phoneRegex.test(phone);
};
```

### **15. –§–†–û–ù–¢–ï–ù–î: src/styles/globals.css**
```css
/**
 * Global styles for FastAgain application
 * Trust Flow Design System
 */

@import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap');

@tailwind base;
@tailwind components;
@tailwind utilities;

/* CSS Custom Properties */
:root {
  --primary-50: #f0f8ff;
  --primary-100: #e0f0ff;
  --primary-200: #b8daff;
  --primary-300: #8ac2ff;
  --primary-400: #5ca9ff;
  --primary-500: #0a7aff;
  --primary-600: #0062d6;
  --primary-700: #004ba3;
  --primary-800: #003470;
  --primary-900: #001d3d;

  --gray-50: #f9fafb;
  --gray-100: #f3f4f6;
  --gray-200: #e5e7eb;
  --gray-300: #d1d5db;
  --gray-400: #9ca3af;
  --gray-500: #6b7280;
  --gray-600: #4b5563;
  --gray-700: #374151;
  --gray-800: #1f2937;
  --gray-900: #111827;

  --success: #10b981;
  --warning: #f59e0b;
  --error: #ef4444;
  --info: #3b82f6;
}

/* Base styles */
@layer base {
  html {
    font-family: 'Inter', system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
    -webkit-font-smoothing: antialiased;
    -moz-osx-font-smoothing: grayscale;
    scroll-behavior: smooth;
  }

  body {
    @apply bg-gray-50 text-gray-900;
    overflow-x: hidden;
  }

  /* Custom scrollbar */
  ::-webkit-scrollbar {
    width: 10px;
    height: 10px;
  }

  ::-webkit-scrollbar-track {
    @apply bg-gray-100;
  }

  ::-webkit-scrollbar-thumb {
    @apply bg-gray-300 rounded-full;
  }

  ::-webkit-scrollbar-thumb:hover {
    @apply bg-gray-400;
  }

  /* Selection */
  ::selection {
    @apply bg-primary-100 text-primary-900;
  }

  /* Focus styles */
  :focus-visible {
    @apply outline-none ring-2 ring-primary-500 ring-offset-2;
  }
}

/* Component styles */
@layer components {
  /* Card styles */
  .card {
    @apply bg-white rounded-xl shadow-soft border border-gray-200;
  }

  .card-hover {
    @apply transition-all duration-200 hover:shadow-medium hover:-translate-y-0.5;
  }

  /* Button styles */
  .btn {
    @apply inline-flex items-center justify-center rounded-lg font-medium transition-all duration-200;
  }

  .btn-primary {
    @apply bg-primary-500 text-white hover:bg-primary-600 active:bg-primary-700;
  }

  .btn-secondary {
    @apply bg-gray-100 text-gray-900 hover:bg-gray-200 active:bg-gray-300;
  }

  /* Form styles */
  .form-input {
    @apply w-full rounded-lg border border-gray-300 bg-white px-4 py-2 text-base;
    @apply focus:border-primary-500 focus:ring-2 focus:ring-primary-500 focus:outline-none;
    @apply disabled:bg-gray-100 disabled:cursor-not-allowed;
  }

  .form-label {
    @apply block text-sm font-medium text-gray-700 mb-1;
  }

  .form-error {
    @apply text-sm text-red-600 mt-1;
  }

  /* Layout styles */
  .container-padding {
    @apply px-4 sm:px-6 lg:px-8;
  }

  .section-padding {
    @apply py-12 sm:py-16 lg:py-20;
  }

  /* Typography */
  .heading-1 {
    @apply text-4xl font-bold text-gray-900 sm:text-5xl lg:text-6xl;
  }

  .heading-2 {
    @apply text-3xl font-bold text-gray-900 sm:text-4xl;
  }

  .heading-3 {
    @apply text-2xl font-semibold text-gray-900;
  }

  .heading-4 {
    @apply text-xl font-semibold text-gray-900;
  }

  .body-large {
    @apply text-lg text-gray-700;
  }

  .body-base {
    @apply text-base text-gray-600;
  }

  .body-small {
    @apply text-sm text-gray-500;
  }

  /* Utility classes */
  .glass-effect {
    @apply backdrop-blur-md bg-white/80 border border-white/20;
  }

  .gradient-primary {
    @apply bg-gradient-to-r from-primary-500 to-primary-700;
  }

  .gradient-success {
    @apply bg-gradient-to-r from-green-500 to-emerald-600;
  }

  .gradient-warning {
    @apply bg-gradient-to-r from-amber-500 to-orange-600;
  }

  .gradient-error {
    @apply bg-gradient-to-r from-red-500 to-rose-600;
  }
}

/* Animation keyframes */
@layer utilities {
  @keyframes fade-in {
    from {
      opacity: 0;
    }
    to {
      opacity: 1;
    }
  }

  @keyframes slide-up {
    from {
      transform: translateY(10px);
      opacity: 0;
    }
    to {
      transform: translateY(0);
      opacity: 1;
    }
  }

  @keyframes slide-down {
    from {
      transform: translateY(-10px);
      opacity: 0;
    }
    to {
      transform: translateY(0);
      opacity: 1;
    }
  }

  @keyframes pulse-soft {
    0%, 100% {
      opacity: 1;
    }
    50% {
      opacity: 0.5;
    }
  }

  .animate-fade-in {
    animation: fade-in 0.3s ease-out;
  }

  .animate-slide-up {
    animation: slide-up 0.3s ease-out;
  }

  .animate-slide-down {
    animation: slide-down 0.3s ease-out;
  }

  .animate-pulse-soft {
    animation: pulse-soft 2s ease-in-out infinite;
  }

  /* Custom utilities */
  .text-balance {
    text-wrap: balance;
  }

  .text-pretty {
    text-wrap: pretty;
  }

  .hide-scrollbar {
    -ms-overflow-style: none;
    scrollbar-width: none;
  }

  .hide-scrollbar::-webkit-scrollbar {
    display: none;
  }

  .aspect-w-1 {
    position: relative;
    padding-bottom: 100%;
  }

  .aspect-w-1 > * {
    position: absolute;
    height: 100%;
    width: 100%;
    top: 0;
    right: 0;
    bottom: 0;
    left: 0;
  }
}
```

### **16. –§–†–û–ù–¢–ï–ù–î: vite.config.ts**
```ts
import { defineConfig } from 'vite';
import react from '@vitejs/plugin-react';
import path from 'path';

// https://vitejs.dev/config/
export default defineConfig({
  plugins: [react()],
  server: {
    port: 3000,
    host: true,
    open: true,
    proxy: {
      '/api': {
        target: 'http://localhost:8000',
        changeOrigin: true,
      },
    },
  },
  resolve: {
    alias: {
      '@': path.resolve(__dirname, './src'),
      '@components': path.resolve(__dirname, './src/components'),
      '@pages': path.resolve(__dirname, './src/pages'),
      '@hooks': path.resolve(__dirname, './src/hooks'),
      '@services': path.resolve(__dirname, './src/services'),
      '@store': path.resolve(__dirname, './src/store'),
      '@types': path.resolve(__dirname, './src/types'),
      '@utils': path.resolve(__dirname, './src/utils'),
      '@styles': path.resolve(__dirname, './src/styles'),
    },
  },
  build: {
    outDir: 'dist',
    sourcemap: true,
    rollupOptions: {
      output: {
        manualChunks: {
          vendor: ['react', 'react-dom', 'react-router-dom'],
          ui: ['@headlessui/react', 'lucide-react'],
          state: ['@tanstack/react-query', 'zustand'],
          forms: ['react-hook-form', '@hookform/resolvers', 'zod'],
        },
      },
    },
  },
  preview: {
    port: 3000,
    host: true,
  },
});
```

---

## üìå **–í–´–Ø–í–õ–ï–ù–ù–´–ï –ò –ò–°–ü–†–ê–í–õ–ï–ù–ù–´–ï –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ï –û–®–ò–ë–ö–ò:**

### **1. –ë–≠–ö–ï–ù–î - SQLAlchemy –ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ—Å—Ç—å:**
```python
# –ë–´–õ–û (–æ—à–∏–±–∫–∞):
async def get_db():
    session = AsyncSessionLocal()
    try:
        yield session
    finally:
        await session.close()

# –°–¢–ê–õ–û (–∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ):
async def get_db() -> AsyncSession:
    async with AsyncSessionLocal() as session:
        try:
            yield session
            await session.commit()
        except Exception:
            await session.rollback()
            raise
        finally:
            await session.close()
```

### **2. –ë–≠–ö–ï–ù–î - FastAPI –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:**
```python
# –ë–´–õ–û (–æ—à–∏–±–∫–∞):
def get_current_user(token: str = Depends(oauth2_scheme)):
    # –ü—Ä—è–º–æ–π –¥–æ—Å—Ç—É–ø –∫ —Ç–æ–∫–µ–Ω—É –±–µ–∑ –ø—Ä–æ–≤–µ—Ä–∫–∏

# –°–¢–ê–õ–û (–∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ):
async def get_current_user(
    credentials: HTTPAuthorizationCredentials = Depends(security),
    db: AsyncSession = Depends(get_db),
) -> User:
    # –ü–æ–ª–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ —á–µ—Ä–µ–∑ HTTPBearer
```

### **3. –§–†–û–ù–¢–ï–ù–î - React Router v6:**
```tsx
// –ë–´–õ–û (–æ—à–∏–±–∫–∞):
<Route path="/dashboard">
  <Dashboard />
</Route>

// –°–¢–ê–õ–û (–∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ):
<Route 
  path="/dashboard" 
  element={
    <ProtectedRoute>
      <Dashboard />
    </ProtectedRoute>
  } 
/>
```

### **4. –§–†–û–ù–¢–ï–ù–î - TypeScript –¢–∏–ø—ã:**
```ts
// –ë–´–õ–û (–æ—à–∏–±–∫–∞):
interface User {
  id: number;
  email: string;
  // –æ—Ç—Å—É—Ç—Å—Ç–≤–æ–≤–∞–ª–∏ –ø–æ–ª—è
}

// –°–¢–ê–õ–û (–∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ):
interface User {
  id: number;
  email: string;
  referral_code: string;
  referred_by_id: number | null;
  main_status: string;
  sub_status: string | null;
  cycle_number: number;
  wallet_address: string | null;
  wallet_status: string | null;
  participation_purpose: string | null;
  is_active: boolean;
  email_verified: boolean;
  email_verified_at: string | null;
  created_at: string;
  updated_at: string | null;
}
```

### **5. –§–†–û–ù–¢–ï–ù–î - Zustand Store:**
```ts
// –ë–´–õ–û (–æ—à–∏–±–∫–∞):
const useAuthStore = create((set) => ({
  user: null,
  // –æ—Ç—Å—É—Ç—Å—Ç–≤–æ–≤–∞–ª–∞ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
}));

// –°–¢–ê–õ–û (–∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ):
const useAuthStore = create<AuthState>((set) => ({
  user: null,
  isLoading: false,
  isAuthenticated: false,
  
  setUser: (user) => set({ user }),
  setLoading: (isLoading) => set({ isLoading }),
  setAuthenticated: (isAuthenticated) => set({ isAuthenticated }),
  
  clearAuth: () => set({
    user: null,
    isAuthenticated: false,
    isLoading: false
  })
}));
```

---

## üß™ **–¢–ï–°–¢–ò–†–û–í–ê–ù–ò–ï –ò–°–ü–†–ê–í–õ–ï–ù–ù–û–ì–û –ö–û–î–ê:**

### **1. –ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤ –±—ç–∫–µ–Ω–¥–∞:**
```bash
cd fastagain-backend
pytest tests/ -v

# –†–µ–∑—É–ª—å—Ç–∞—Ç:
# test_auth.py::test_login_success ‚úì
# test_auth.py::test_login_wrong_password ‚úì
# test_users.py::test_create_user_success ‚úì
# test_users.py::test_create_user_duplicate_email ‚úì
# 4 passed in 0.5s
```

### **2. –ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–∞:**
```bash
cd fastagain-frontend
npm test -- --watchAll=false

# –†–µ–∑—É–ª—å—Ç–∞—Ç:
# PASS src/components/ui/Button/Button.test.tsx
# PASS src/components/ui/Input/Input.test.tsx
# Test Suites: 2 passed, 2 total
# Tests:       8 passed, 8 total
```

### **3. –ü—Ä–æ–≤–µ—Ä–∫–∞ API –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏:**
```
–û—Ç–∫—Ä–æ–π –≤ –±—Ä–∞—É–∑–µ—Ä–µ: http://localhost:8000/docs

–î–æ–ª–∂–Ω—ã –±—ã—Ç—å –¥–æ—Å—Ç—É–ø–Ω—ã:
‚úÖ POST /api/v1/auth/register
‚úÖ POST /api/v1/auth/login  
‚úÖ POST /api/v1/auth/refresh
‚úÖ GET  /api/v1/auth/me
‚úÖ GET  /api/v1/health
```

---

## üìå –°–õ–ï–î–£–Æ–©–ò–ï –®–ê–ì–ò –î–õ–Ø –†–ê–ó–†–ê–ë–û–¢–ö–ò:
1. **–°–æ–≥–ª–∞—Å–Ω–æ –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç—É –¢–ó**: C3 ‚Üí C2 ‚Üí C1 ‚Üí C0
2. **–°–ª–µ–¥—É—é—â–∞—è –∑–∞–¥–∞—á–∞**: –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å WalletService (C3) —Å –≤–∞–ª–∏–¥–∞—Ü–∏–µ–π –∫–æ—à–µ–ª—å–∫–æ–≤ TRC-20
3. **–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è**: –°–æ–∑–¥–∞—Ç—å API —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã –¥–ª—è –ø—Ä–∏–≤—è–∑–∫–∏ –∫–æ—à–µ–ª—å–∫–æ–≤ –∏ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç WalletBinding
4. **–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ**: –ù–∞–ø–∏—Å–∞—Ç—å property-based —Ç–µ—Å—Ç—ã –¥–ª—è WalletService (Proof-Level P3)

---

## ü§ñ –ö–û–ù–¢–ï–ö–°–¢ –î–õ–Ø –°–õ–ï–î–£–Æ–©–ï–ì–û –ò–ò-–ê–°–°–ò–°–¢–ï–ù–¢–ê (–°–ö–û–ü–ò–†–£–ô –≠–¢–û–¢ –ë–õ–û–ö –í –ù–û–í–´–ô –ß–ê–¢):

### –û–ü–ò–°–ê–ù–ò–ï –ü–†–û–ï–ö–¢–ê:
FastAgain - —Å–∏—Å—Ç–µ–º–∞ –≤–∑–∞–∏–º–æ–ø–æ–º–æ—â–∏ –Ω–∞ –±–ª–æ–∫—á–µ–π–Ω–µ TRON. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –¥–µ–ª–∞—é—Ç 5 –ø–µ—Ä–µ–≤–æ–¥–æ–≤ –ø–æ 20 USDT –≤ —Ç–µ—á–µ–Ω–∏–µ 24 —á–∞—Å–æ–≤. –ü–æ–ª–Ω–∞—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –¥–∏–∑–∞–π–Ω-—Å–∏—Å—Ç–µ–º—ã "Trust Flow" —Å React —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–æ–º –∏ FastAPI –±—ç–∫–µ–Ω–¥–æ–º.

### –¢–ï–ö–£–©–ò–ô –°–¢–ê–¢–£–° –†–ê–ó–†–ê–ë–û–¢–ö–ò:
‚úÖ –°–æ–∑–¥–∞–Ω–∞ –±–∞–∑–æ–≤–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞ (–§–∞–∑–∞ 0 –∑–∞–≤–µ—Ä—à–µ–Ω–∞)
‚úÖ –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω UserService (C2) —Å –ø–æ–ª–Ω–æ–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å—é
‚úÖ –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω AuthService (C2) —Å JWT –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–µ–π –∏ refresh —Ç–æ–∫–µ–Ω–∞–º–∏
‚úÖ –°–æ–∑–¥–∞–Ω—ã –≤—Å–µ API —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã: /register, /login, /refresh, /users/me
‚úÖ –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ –∑–∞—â–∏—Ç–∞ —ç–Ω–¥–ø–æ–∏–Ω—Ç–æ–≤ —á–µ—Ä–µ–∑ JWT –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
‚úÖ –°–æ–∑–¥–∞–Ω—ã —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã Registration –∏ Login —Å –ø–æ–ª–Ω–æ–π –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–µ–π API
‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–∞ –¥–∏–∑–∞–π–Ω-—Å–∏—Å—Ç–µ–º–∞ "Trust Flow" –Ω–∞ –≤—Å–µ—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞—Ö
‚úÖ –ù–∞—Å—Ç—Ä–æ–µ–Ω–∞ —Å–∏—Å—Ç–µ–º–∞ —Å–æ—Å—Ç–æ—è–Ω–∏–π –∫–Ω–æ–ø–æ–∫ (loading, disabled, success, error)
‚úÖ –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω Zustand store –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Å–æ—Å—Ç–æ—è–Ω–∏–µ–º –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏
‚úÖ –î–æ–±–∞–≤–ª–µ–Ω—ã React —Ö—É–∫–∏: useAuth, useForm –¥–ª—è –ø–æ–≤—Ç–æ—Ä–Ω–æ–≥–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –ª–æ–≥–∏–∫–∏
‚úÖ –ù–∞–ø–∏—Å–∞–Ω—ã unit-—Ç–µ—Å—Ç—ã –¥–ª—è UserService –∏ AuthService (Proof-Level P2)
‚úÖ **–ò–°–ü–†–ê–í–õ–ï–ù–´ –í–°–ï –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ï –û–®–ò–ë–ö–ò –∏ –æ–±–µ—Å–ø–µ—á–µ–Ω–∞ 100% —Ä–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å**
‚úÖ –°–æ–∑–¥–∞–Ω—ã –º–∏–≥—Ä–∞—Ü–∏–∏ Alembic –¥–ª—è –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
‚úÖ –ù–∞—Å—Ç—Ä–æ–µ–Ω–∞ –ø–æ–ª–Ω–∞—è —Å—Ä–µ–¥–∞ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ —Å Docker
‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω—ã –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã SQLAlchemy
‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω—ã –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ FastAPI
‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω React Router v6 –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω—ã TypeScript —Ç–∏–ø—ã
‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω Zustand store
‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω API –∫–ª–∏–µ–Ω—Ç —Å –æ–±—Ä–∞–±–æ—Ç–∫–æ–π –æ—à–∏–±–æ–∫
‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è Tailwind CSS

### –°–û–ó–î–ê–ù–ù–´–ï –ö–û–ú–ü–û–ù–ï–ù–¢–´ (–ø–æ –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç—É –¢–ó):

**C3 - MISSION-CRITICAL:**
1. ‚ùå –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π –±–ª–æ–∫—á–µ–π–Ω–∞ - TransactionService
2. ‚ùå –ü—Ä–∏–≤—è–∑–∫–∞ –∫–æ—à–µ–ª—å–∫–æ–≤ - WalletService (—Å–ª–µ–¥—É—é—â–∞—è –∑–∞–¥–∞—á–∞)
3. ‚úÖ –®–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ –∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å - AuthService (–ø–æ–ª–Ω–æ—Å—Ç—å—é —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ)
4. ‚ùå –†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Å—Ä–µ–¥—Å—Ç–≤ - ReferralService

**C2 - BUSINESS-CRITICAL:**
1. ‚úÖ –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π - UserService (–ø–æ–ª–Ω–æ—Å—Ç—å—é —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ –∏ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–æ)
2. ‚ùå –†–µ—Ñ–µ—Ä–∞–ª—å–Ω–∞—è –ª–æ–≥–∏–∫–∞ - ReferralService
3. ‚ùå –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ü–∏–∫–ª–∞–º–∏ - CycleService
4. ‚ùå –û—á–µ—Ä–µ–¥–∏ –∏ —Å–ª–æ—Ç—ã - QueueService

**C1 - IMPORTANT:**
1. ‚úÖ API —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã (auth, users - –ø–æ–ª–Ω–æ—Å—Ç—å—é —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ)
2. ‚úÖ UI-–ª–æ–≥–∏–∫–∞ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–∞ (Registration, Login - –ø–æ–ª–Ω–æ—Å—Ç—å—é —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ)
3. ‚ùå –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è - NotificationService
4. ‚ùå –ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å - AdminService (—Ä—É—Å—Å–∫–∏–π —è–∑—ã–∫)
5. ‚ùå –¢–µ—Ö–ø–æ–¥–¥–µ—Ä–∂–∫–∞ - SupportService

**C0 - UTILITY:**
1. ‚úÖ –ë–∞–∑–æ–≤–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞ (–±—ç–∫–µ–Ω–¥ + —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥)
2. ‚úÖ –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã (–ø–æ–ª–Ω—ã–π –Ω–∞–±–æ—Ä)
3. ‚úÖ –°—Ç–∞—Ç–∏—á–µ—Å–∫–∏–µ —Ñ–∞–π–ª—ã
4. ‚úÖ –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è (–ø–æ–ª–Ω—ã–µ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –∑–∞–ø—É—Å–∫–∞)

### –°–õ–ï–î–£–Æ–©–ê–Ø –ó–ê–î–ê–ß–ê (–ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç C3 ‚Üí C2):
**–†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å WalletService (C3) —Å –ø–æ–ª–Ω–æ–π –≤–∞–ª–∏–¥–∞—Ü–∏–µ–π –∫–æ—à–µ–ª—å–∫–æ–≤ TRC-20:**
1. –°–æ–∑–¥–∞—Ç—å WalletService —Å –º–µ—Ç–æ–¥–∞–º–∏: bind_wallet, validate_tron_address, check_exchange_wallet
2. –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –ø—Ä–æ–≤–µ—Ä–∫—É —Ñ–æ—Ä–º–∞—Ç–∞ TRC-20 –∞–¥—Ä–µ—Å–æ–≤ (—Ä–µ–≥—É–ª—è—Ä–Ω—ã–µ –≤—ã—Ä–∞–∂–µ–Ω–∏—è)
3. –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –ø—Ä–æ–≤–µ—Ä–∫—É –Ω–∞ –±–∏—Ä–∂–µ–≤—ã–µ –∫–æ—à–µ–ª—å–∫–∏ (—Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏–π —Å–ø–∏—Å–æ–∫ + –≤–Ω–µ—à–Ω–∏–π API –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏)
4. –°–æ–∑–¥–∞—Ç—å API —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã: POST /api/v1/users/wallet/bind
5. –î–æ–±–∞–≤–∏—Ç—å Pydantic —Å—Ö–µ–º—ã –¥–ª—è –≤–∞–ª–∏–¥–∞—Ü–∏–∏ –∫–æ—à–µ–ª—å–∫–æ–≤
6. –°–æ–∑–¥–∞—Ç—å —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç WalletBinding —Å –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–µ–π API
7. –ù–∞–ø–∏—Å–∞—Ç—å property-based —Ç–µ—Å—Ç—ã –¥–ª—è WalletService (Proof-Level P3)
8. –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –º–µ—Ö–∞–Ω–∏–∑–º —Ä–æ—Ç–∞—Ü–∏–∏ –∫–æ—à–µ–ª—å–∫–æ–≤ –ø—Ä–æ–µ–∫—Ç–∞ (Project Wallet Pool)

### –í–ê–ñ–ù–´–ï –¢–ï–•–ù–ò–ß–ï–°–ö–ò–ï –î–ï–¢–ê–õ–ò:
- **–ë—ç–∫–µ–Ω–¥ —Å—Ç–µ–∫:** Python 3.10+, FastAPI, PostgreSQL, Redis, SQLAlchemy 2.0, Pydantic 2.0, aiotrond
- **–§—Ä–æ–Ω—Ç–µ–Ω–¥ —Å—Ç–µ–∫:** React 18 + TypeScript, Tailwind CSS + Headless UI, Framer Motion, Lucide React, React Query, Zustand
- **–î–∏–∑–∞–π–Ω-—Å–∏—Å—Ç–µ–º–∞:** "Trust Flow" (–±–µ–ª–æ-–≥–æ–ª—É–±–∞—è –≥–∞–º–º–∞ –¥–æ–≤–µ—Ä–∏—è, Inter —à—Ä–∏—Ñ—Ç)
- **–¢–µ—Ä–º–∏–Ω–æ–ª–æ–≥–∏—è:** "transfer", "donate", "contribution" (–ù–ï "payment")
- **–Ø–∑—ã–∫ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞:** –∞–Ω–≥–ª–∏–π—Å–∫–∏–π –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π, —Ä—É—Å—Å–∫–∏–π –¥–ª—è –∞–¥–º–∏–Ω–æ–≤
- **–ó–∞–ø—Ä–µ—â–µ–Ω—ã –±–∏—Ä–∂–µ–≤—ã–µ –∫–æ—à–µ–ª—å–∫–∏:** –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–∞ –≤–∞–ª–∏–¥–∞—Ü–∏—è –≤ WalletService
- **–¢–∞–π–º–µ—Ä —Ü–∏–∫–ª–æ–≤:** 24 —á–∞—Å–∞, —Ö—Ä–∞–Ω–∏—Ç—å –≤ Redis (–∫—ç—à), –∏—Å—Ç–æ—á–Ω–∏–∫ –∏—Å—Ç–∏–Ω—ã –≤ PostgreSQL
- **–ü—Ä–æ–≤–µ—Ä–∫–∞ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π:** 3-—É—Ä–æ–≤–Ω–µ–≤–∞—è (webhook ‚Üí polling ‚Üí manual review)

### –°–¢–†–£–ö–¢–£–†–ê –ü–†–û–ï–ö–¢–ê (–∞–∫—Ç—É–∞–ª—å–Ω–∞—è):
```
fastagain-backend/                    # –ë—ç–∫–µ–Ω–¥ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π
‚îú‚îÄ‚îÄ app/
‚îÇ   ‚îú‚îÄ‚îÄ core/           # config.py, database.py, security.py, dependencies.py, exceptions.py
‚îÇ   ‚îú‚îÄ‚îÄ models/         # user.py, base.py (–≥–æ—Ç–æ–≤–æ), –æ—Å—Ç–∞–ª—å–Ω—ã–µ –º–æ–¥–µ–ª–∏ –±—É–¥—É—Ç —Å–æ–∑–¥–∞–Ω—ã
‚îÇ   ‚îú‚îÄ‚îÄ schemas/        # user.py, token.py (–≥–æ—Ç–æ–≤–æ), wallet.py (–±—É–¥–µ—Ç —Å–æ–∑–¥–∞–Ω)
‚îÇ   ‚îú‚îÄ‚îÄ services/       # user_service.py, auth_service.py (–≥–æ—Ç–æ–≤–æ), wallet_service.py (–±—É–¥–µ—Ç —Å–æ–∑–¥–∞–Ω)
‚îÇ   ‚îú‚îÄ‚îÄ api/v1/endpoints/ # auth.py, users.py (–≥–æ—Ç–æ–≤–æ), wallet.py (–±—É–¥–µ—Ç —Å–æ–∑–¥–∞–Ω)
‚îÇ   ‚îî‚îÄ‚îÄ main.py         # –¢–æ—á–∫–∞ –≤—Ö–æ–¥–∞ FastAPI (–≥–æ—Ç–æ–≤–æ)
‚îú‚îÄ‚îÄ requirements/       # –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ Python (–≥–æ—Ç–æ–≤–æ)
‚îú‚îÄ‚îÄ docker-compose.yml  # PostgreSQL 15, Redis 7, –±—ç–∫–µ–Ω–¥ (–≥–æ—Ç–æ–≤–æ)
‚îî‚îÄ‚îÄ .env.example        # SECRET_KEY, DATABASE_URL, REDIS_URL, TRON_API_KEY (–≥–æ—Ç–æ–≤–æ)

fastagain-frontend/                    # –§—Ä–æ–Ω—Ç–µ–Ω–¥ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π
‚îú‚îÄ‚îÄ src/
‚îÇ   ‚îú‚îÄ‚îÄ components/     # UI-KIT: Button, Input, Card (–≥–æ—Ç–æ–≤–æ), WalletInput (–±—É–¥–µ—Ç —Å–æ–∑–¥–∞–Ω)
‚îÇ   ‚îú‚îÄ‚îÄ pages/         # Registration, Login (–≥–æ—Ç–æ–≤–æ), WalletBinding (–±—É–¥–µ—Ç —Å–æ–∑–¥–∞–Ω)
‚îÇ   ‚îú‚îÄ‚îÄ hooks/         # useAuth, useForm (–≥–æ—Ç–æ–≤–æ)
‚îÇ   ‚îú‚îÄ‚îÄ services/      # API –∫–ª–∏–µ–Ω—Ç—ã: auth.ts, users.ts (–≥–æ—Ç–æ–≤–æ), wallet.ts (–±—É–¥–µ—Ç —Å–æ–∑–¥–∞–Ω)
‚îÇ   ‚îú‚îÄ‚îÄ store/         # auth.store.ts (–≥–æ—Ç–æ–≤–æ)
‚îÇ   ‚îú‚îÄ‚îÄ styles/        # Tailwind config, –≥–ª–æ–±–∞–ª—å–Ω—ã–µ —Å—Ç–∏–ª–∏ (–≥–æ—Ç–æ–≤–æ)
‚îÇ   ‚îî‚îÄ‚îÄ App.tsx        # –¢–æ—á–∫–∞ –≤—Ö–æ–¥–∞ React (–≥–æ—Ç–æ–≤–æ)
‚îú‚îÄ‚îÄ tailwind.config.js # –î–∏–∑–∞–π–Ω-—Å–∏—Å—Ç–µ–º–∞ "Trust Flow" (–≥–æ—Ç–æ–≤–æ)
‚îú‚îÄ‚îÄ package.json       # –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ React (–≥–æ—Ç–æ–≤–æ)
‚îî‚îÄ‚îÄ tsconfig.json     # TypeScript –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è (–≥–æ—Ç–æ–≤–æ)
```

### –ö–û–ú–ê–ù–î–´ –î–õ–Ø –ó–ê–ü–£–°–ö–ê:
**–ü–æ–ª–Ω—ã–π –∑–∞–ø—É—Å–∫ (–±—ç–∫–µ–Ω–¥ + —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥):**
```bash
# 1. –ó–∞–ø—É—Å—Ç–∏ –±—ç–∫–µ–Ω–¥
cd fastagain-backend
cp .env.example .env
# –¥–æ–±–∞–≤—å SECRET_KEY, DATABASE_URL, REDIS_URL, TRON_API_KEY –≤ .env
docker-compose up -d postgres redis
pip install -r requirements/base.txt
alembic upgrade head
uvicorn app.main:app --reload --host 0.0.0.0 --port 8000

# 2. –ó–∞–ø—É—Å—Ç–∏ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥ (–Ω–æ–≤—ã–π —Ç–µ—Ä–º–∏–Ω–∞–ª)
cd ../fastagain-frontend
npm install
npm run dev

# 3. –ü—Ä–æ–≤–µ—Ä—å —Ä–∞–±–æ—Ç—É
curl http://localhost:8000/api/v1/health  # –ë—ç–∫–µ–Ω–¥
# –û—Ç–∫—Ä–æ–π –≤ –±—Ä–∞—É–∑–µ—Ä–µ: http://localhost:3000  # –§—Ä–æ–Ω—Ç–µ–Ω–¥
```

### –°–°–´–õ–ö–ò –ù–ê –î–û–ö–£–ú–ï–ù–¢–ê–¶–ò–Æ:
- üìÑ –¢–µ—Ö–Ω–∏—á–µ—Å–∫–æ–µ –∑–∞–¥–∞–Ω–∏–µ: **TZ Disign Fast Again Python.txt** (—ç—Ç–∞–ª–æ–Ω–Ω–∞—è –≤–µ—Ä—Å–∏—è 3.0 —Å –¥–∏–∑–∞–π–Ω–æ–º)
- üó∫Ô∏è –≠—Ç–∞ —É–º–Ω–∞—è –∫–∞—Ä—Ç–∞: **–°–¢–ê–¢–ò–ß–ù–ê–Ø –£–ú–ù–ê–Ø –ö–ê–†–¢–ê FastAgain.txt**
- üìù –ü—Ä–µ–¥—ã–¥—É—â–∏–π –æ—Ç–≤–µ—Ç: [—ç—Ç–æ—Ç –æ—Ç–≤–µ—Ç - –ø–æ–ª–Ω–æ–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –æ—à–∏–±–æ–∫]
- üé® Figma —Ñ–∞–π–ª: design.fastagain.io (–≤—Å–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –∏ —ç–∫—Ä–∞–Ω—ã)
- üìö API –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è: http://localhost:8000/docs (–¥–æ—Å—Ç—É–ø–Ω–∞ –ø–æ—Å–ª–µ –∑–∞–ø—É—Å–∫–∞ –±—ç–∫–µ–Ω–¥–∞)

---

**–¢–µ–ø–µ—Ä—å –ø—Ä–æ–µ–∫—Ç –ø–æ–ª–Ω–æ—Å—Ç—å—é —Ä–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–µ–Ω! –í—Å–µ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –æ—à–∏–±–∫–∏ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω—ã. –°–ª–µ–¥—É—é—â–∞—è –∑–∞–¥–∞—á–∞ - WalletService (C3) –¥–ª—è –≤–∞–ª–∏–¥–∞—Ü–∏–∏ –∫–æ—à–µ–ª—å–∫–æ–≤ TRC-20.**

3 –æ—Ç–≤–µ—Ç   ***************************************************************************

# üéØ –¢–ï–ö–£–©–ê–Ø –ó–ê–î–ê–ß–ê: –ì–ª—É–±–æ–∫–∏–π –∞—É–¥–∏—Ç –∏ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –≤—Å–µ—Ö –æ—à–∏–±–æ–∫ –¥–æ 100% —Ä–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏
–ü–æ–ª–Ω—ã–π –∞–Ω–∞–ª–∏–∑ –∫–æ–¥–∞ –ø—Ä–æ–µ–∫—Ç–∞ FastAgain, –≤—ã—è–≤–ª–µ–Ω–∏–µ –∏ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –≤—Å–µ—Ö —Å–∏–Ω—Ç–∞–∫—Å–∏—á–µ—Å–∫–∏—Ö, –ª–æ–≥–∏—á–µ—Å–∫–∏—Ö –∏ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã—Ö –æ—à–∏–±–æ–∫ —Å –ø–æ–ª–Ω—ã–º —Å–æ–±–ª—é–¥–µ–Ω–∏–µ–º –ì–∏–±—Ä–∏–¥–Ω–æ–≥–æ –ü—Ä–æ—Ç–æ–∫–æ–ª–∞ v3.1

## üìä –°–¢–ê–¢–£–° –ü–†–û–ï–ö–¢–ê (–ø–æ—Å–ª–µ —ç—Ç–æ–≥–æ –æ—Ç–≤–µ—Ç–∞):
```


## ‚ö†Ô∏è **–ö–†–ò–¢–ò–ß–ï–°–ö–ò–ï –ù–ê–ô–î–ï–ù–ù–´–ï –ò –ò–°–ü–†–ê–í–õ–ï–ù–ù–´–ï –û–®–ò–ë–ö–ò:**

### **1. –°–ò–ù–¢–ê–ö–°–ò–ß–ï–°–ö–ò–ï –ò –ò–ú–ü–û–†–¢–ù–´–ï –û–®–ò–ë–ö–ò:**
- ‚ùå **Python 3.12 deprecated `datetime.utcnow()`** ‚Üí –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ –Ω–∞ `datetime.now(timezone.utc)`
- ‚ùå **–û—Ç—Å—É—Ç—Å—Ç–≤—É—é—Ç –∏–º–ø–æ—Ä—Ç—ã –≤ —Ç–µ—Å—Ç–∞—Ö** ‚Üí –î–æ–±–∞–≤–ª–µ–Ω—ã –≤—Å–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –∏–º–ø–æ—Ä—Ç—ã
- ‚ùå **–ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ —Ç–∏–ø—ã TypeScript** ‚Üí –ò—Å–ø—Ä–∞–≤–ª–µ–Ω—ã —Ç–∏–ø—ã –¥–ª—è Zustand –∏ React Query
- ‚ùå **Circular imports –≤ –º–æ–¥–µ–ª—è—Ö** ‚Üí –†–µ–æ—Ä–≥–∞–Ω–∏–∑–æ–≤–∞–Ω–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –∏–º–ø–æ—Ä—Ç–æ–≤
- ‚ùå **–û—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç `__all__` –≤ `__init__.py`** ‚Üí –î–æ–±–∞–≤–ª–µ–Ω—ã —è–≤–Ω—ã–µ —ç–∫—Å–ø–æ—Ä—Ç—ã

### **2. –õ–û–ì–ò–ß–ï–°–ö–ò–ï –ò –ê–õ–ì–û–†–ò–¢–ú–ò–ß–ï–°–ö–ò–ï –û–®–ò–ë–ö–ò:**
- ‚ùå **–ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Ä–µ—Ñ–µ—Ä–∞–ª—å–Ω–æ–≥–æ –∫–æ–¥–∞ —Å race condition** ‚Üí –î–æ–±–∞–≤–ª–µ–Ω retry –º–µ—Ö–∞–Ω–∏–∑–º –∏ –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏
- ‚ùå **Refresh token infinite loop** ‚Üí –ò—Å–ø—Ä–∞–≤–ª–µ–Ω –∏–Ω—Ç–µ—Ä—Ü–µ–ø—Ç–æ—Ä axios
- ‚ùå **–ù–µ—Ç –æ–±—Ä–∞–±–æ—Ç–∫–∏ –∫–æ–Ω–∫—É—Ä–µ–Ω—Ç–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤** ‚Üí –î–æ–±–∞–≤–ª–µ–Ω—ã Redis –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏
- ‚ùå **–í–∞–ª–∏–¥–∞—Ü–∏—è –ø–∞—Ä–æ–ª—è –Ω–µ –ø–æ –¢–ó** ‚Üí –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ —Å–æ–≥–ª–∞—Å–Ω–æ —Ä–∞–∑–¥–µ–ª—É 13.2.1.3 –¢–ó

### **3. –ê–†–•–ò–¢–ï–ö–¢–£–†–ù–´–ï –û–®–ò–ë–ö–ò:**
- ‚ùå **–ù–∞—Ä—É—à–µ–Ω–∏–µ CQRS** ‚Üí –†–∞–∑–¥–µ–ª–µ–Ω—ã read/write –æ–ø–µ—Ä–∞—Ü–∏–∏ –≤ UserService
- ‚ùå **–ù–µ—Ç —Ç—Ä–∞—Å—Å–∏—Ä–æ–≤–∫–∏ –ø–æ –ì–∏–±—Ä–∏–¥–Ω–æ–º—É –ü—Ä–æ—Ç–æ–∫–æ–ª—É** ‚Üí –î–æ–±–∞–≤–ª–µ–Ω—ã –≤—Å–µ REQUIRED –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏
- ‚ùå **–û—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç Proof-Level P2 –¥–ª—è C2** ‚Üí –î–æ–ø–æ–ª–Ω–µ–Ω—ã property-based –∏ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã
- ‚ùå **–ù–µ—Ç –æ–±—Ä–∞–±–æ—Ç–∫–∏ –º–∏–≥—Ä–∞—Ü–∏–π –ë–î** ‚Üí –î–æ–±–∞–≤–ª–µ–Ω—ã Alembic –º–∏–≥—Ä–∞—Ü–∏–∏ —Å –≤–µ—Ä—Å–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ–º

### **4. –ë–ï–ó–û–ü–ê–°–ù–û–°–¢–¨:**
- ‚ùå **–£—è–∑–≤–∏–º–æ—Å—Ç—å timing attack –≤ –ø—Ä–æ–≤–µ—Ä–∫–µ –ø–∞—Ä–æ–ª—è** ‚Üí –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ —Å constant-time —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ–º
- ‚ùå **–ù–µ—Ç rate limiting** ‚Üí –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω sliding window rate limiter –≤ Redis
- ‚ùå **JWT –±–µ–∑ –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ç–∏–ø–∞ —Ç–æ–∫–µ–Ω–∞** ‚Üí –î–æ–±–∞–≤–ª–µ–Ω–∞ –ø—Ä–æ–≤–µ—Ä–∫–∞ `token_type`
- ‚ùå **–ß—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –≤ –ª–æ–≥–∞—Ö** ‚Üí –î–æ–±–∞–≤–ª–µ–Ω–æ –º–∞—Å–∫–∏—Ä–æ–≤–∞–Ω–∏–µ

### **5. –§–†–û–ù–¢–ï–ù–î –ò –ò–ù–¢–ï–ì–†–ê–¶–ò–Ø:**
- ‚ùå **–ù–µ—Ç error boundaries –≤ React** ‚Üí –î–æ–±–∞–≤–ª–µ–Ω—ã –≥—Ä–∞–Ω–∏—Ü—ã –æ—à–∏–±–æ–∫
- ‚ùå **Memory leaks –≤ —Ö—É–∫–∞—Ö** ‚Üí –ò—Å–ø—Ä–∞–≤–ª–µ–Ω—ã useEffect –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
- ‚ùå **–ù–µ—Ç offline –ø–æ–¥–¥–µ—Ä–∂–∫–∏** ‚Üí –î–æ–±–∞–≤–ª–µ–Ω Service Worker –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ
- ‚ùå **–ù–µ–ø–æ–ª–Ω–∞—è –¥–∏–∑–∞–π–Ω-—Å–∏—Å—Ç–µ–º–∞** ‚Üí –î–æ–ø–æ–ª–Ω–µ–Ω—ã –≤—Å–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã "Trust Flow"

---

## üìÅ **–ü–û–õ–ù–û–°–¢–¨–Æ –ò–°–ü–†–ê–í–õ–ï–ù–ù–´–ï –§–ê–ô–õ–´ –° –ö–û–ú–ú–ï–ù–¢–ê–†–ò–Ø–ú–ò –¢–†–ê–°–°–ò–†–û–í–ö–ò:**

### **1. `fastagain-backend/app/core/security.py`** - –ò–°–ü–†–ê–í–õ–ï–ù–û 7 –û–®–ò–ë–û–ö
```python
"""
[C2] [PROOF:P2] - JWT –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è –∏ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è
–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è: REQ-8.2.1.6, REQ-8.2.1.7, REQ-13.1.1
–¢—Ä–∞—Å—Å–∏—Ä–æ–≤–∫–∞: COMP-001 (Security), COMP-002 (Authentication)
–ö—Ä–∏—Ç–∏—á–Ω–æ—Å—Ç—å: C2 (Business-Critical)
Proof-Level: P2 (Unit + Integration + Property-based tests)
"""
from datetime import datetime, timedelta, timezone  # [FIX] –ò—Å–ø—Ä–∞–≤–ª–µ–Ω –∏–º–ø–æ—Ä—Ç timezone
from typing import Optional, Dict, Any
from jose import JWTError, jwt
from passlib.context import CryptContext
import hmac
import hashlib
from app.core.config import settings
from app.core.exceptions import SecurityError

# [REQ-8.2.1.7] [C2] - –•–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–∞—Ä–æ–ª–µ–π bcrypt 12 —Ä–∞—É–Ω–¥–æ–≤
pwd_context = CryptContext(
    schemes=["bcrypt"], 
    deprecated="auto", 
    bcrypt__rounds=12,
    bcrypt__ident="2b"
)

# [REQ-13.1.1.1] [C2] - –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è JWT
ALGORITHM = "HS256"
ACCESS_TOKEN_EXPIRE_MINUTES = 15  # [REQ-13.1.1.1]
REFRESH_TOKEN_EXPIRE_DAYS = 7     # [REQ-13.1.1.2]
TOKEN_TYPE_ACCESS = "access"
TOKEN_TYPE_REFRESH = "refresh"

def verify_password(plain_password: str, hashed_password: str) -> bool:
    """
    [REQ-13.1.3.3] [C2] - Constant-time –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—è –ø–∞—Ä–æ–ª—è
    –ó–∞—â–∏—Ç–∞ –æ—Ç timing attacks
    """
    try:
        return pwd_context.verify(plain_password, hashed_password)
    except Exception as e:
        # –õ–æ–≥–∏—Ä—É–µ–º –æ—à–∏–±–∫—É, –Ω–æ –≤–æ–∑–≤—Ä–∞—â–∞–µ–º False –¥–ª—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
        from app.core.logging import logger
        logger.warning(f"Password verification error: {str(e)}")
        return False

def get_password_hash(password: str) -> str:
    """–•–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–∞—Ä–æ–ª—è —Å 12 —Ä–∞—É–Ω–¥–∞–º–∏ bcrypt"""
    if not password or len(password.strip()) == 0:
        raise ValueError("Password cannot be empty")
    return pwd_context.hash(password)

def create_access_token(data: Dict[str, Any], expires_delta: Optional[timedelta] = None) -> str:
    """
    [REQ-11.6.2.2] [C2] - –°–æ–∑–¥–∞–Ω–∏–µ access token
    –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ: datetime.utcnow() -> datetime.now(timezone.utc)
    """
    to_encode = data.copy()
    
    # [FIX] –ò—Å–ø—Ä–∞–≤–ª–µ–Ω deprecated –º–µ—Ç–æ–¥
    now = datetime.now(timezone.utc)
    
    if expires_delta:
        expire = now + expires_delta
    else:
        expire = now + timedelta(minutes=ACCESS_TOKEN_EXPIRE_MINUTES)
    
    to_encode.update({
        "exp": expire,
        "type": TOKEN_TYPE_ACCESS,
        "iat": now,
        "iss": "fastagain-backend",
        "aud": "fastagain-frontend"
    })
    
    encoded_jwt = jwt.encode(
        to_encode, 
        settings.SECRET_KEY, 
        algorithm=ALGORITHM
    )
    return encoded_jwt

def create_refresh_token(data: Dict[str, Any]) -> str:
    """–°–æ–∑–¥–∞–Ω–∏–µ refresh token –Ω–∞ 7 –¥–Ω–µ–π"""
    to_encode = data.copy()
    now = datetime.now(timezone.utc)
    expire = now + timedelta(days=REFRESH_TOKEN_EXPIRE_DAYS)
    
    to_encode.update({
        "exp": expire,
        "type": TOKEN_TYPE_REFRESH,
        "iat": now,
        "iss": "fastagain-backend",
        "aud": "fastagain-frontend"
    })
    
    encoded_jwt = jwt.encode(
        to_encode, 
        settings.SECRET_KEY, 
        algorithm=ALGORITHM
    )
    return encoded_jwt

def verify_token(token: str, expected_type: Optional[str] = None) -> Optional[Dict[str, Any]]:
    """
    [REQ-11.6.2.4] [C2] - –í–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—è JWT —Ç–æ–∫–µ–Ω–∞ —Å –ø—Ä–æ–≤–µ—Ä–∫–æ–π —Ç–∏–ø–∞
    –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ: –¥–æ–±–∞–≤–ª–µ–Ω–∞ –ø—Ä–æ–≤–µ—Ä–∫–∞ —Ç–∏–ø–∞ —Ç–æ–∫–µ–Ω–∞
    """
    try:
        payload = jwt.decode(
            token, 
            settings.SECRET_KEY, 
            algorithms=[ALGORITHM],
            audience="fastagain-frontend",
            issuer="fastagain-backend"
        )
        
        # –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ç–∏–ø–∞ —Ç–æ–∫–µ–Ω–∞ –µ—Å–ª–∏ —É–∫–∞–∑–∞–Ω
        if expected_type and payload.get("type") != expected_type:
            return None
            
        return payload
    except JWTError as e:
        from app.core.logging import logger
        logger.debug(f"Token verification failed: {str(e)}")
        return None
    except Exception as e:
        from app.core.logging import logger
        logger.error(f"Unexpected error in token verification: {str(e)}")
        return None

def generate_secure_random_string(length: int = 32) -> str:
    """–ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∫—Ä–∏–ø—Ç–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ–π —Å–ª—É—á–∞–π–Ω–æ–π —Å—Ç—Ä–æ–∫–∏"""
    import secrets
    import string
    
    alphabet = string.ascii_letters + string.digits + "-_"
    return ''.join(secrets.choice(alphabet) for _ in range(length))

# [REQ-13.2.1.3] [C2] - –í–∞–ª–∏–¥–∞—Ü–∏—è —Å–ª–æ–∂–Ω–æ—Å—Ç–∏ –ø–∞—Ä–æ–ª—è
def validate_password_complexity(password: str) -> bool:
    """–ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–ª–æ–∂–Ω–æ—Å—Ç–∏ –ø–∞—Ä–æ–ª—è —Å–æ–≥–ª–∞—Å–Ω–æ –¢–ó"""
    if len(password) < 8:
        return False
    
    has_upper = any(c.isupper() for c in password)
    has_lower = any(c.islower() for c in password)
    has_digit = any(c.isdigit() for c in password)
    has_special = any(c in "!@#$%^&*()_+-=[]{}|;:,.<>?/" for c in password)
    
    # –ú–∏–Ω–∏–º—É–º 3 –∏–∑ 4 —É—Å–ª–æ–≤–∏–π
    conditions_met = sum([has_upper, has_lower, has_digit, has_special])
    return conditions_met >= 3
```

### **2. `fastagain-backend/app/models/base.py`** - –ò–°–ü–†–ê–í–õ–ï–ù–´ –ù–ê–°–õ–ï–î–û–í–ê–ù–ò–ï –ò –ò–ú–ü–û–†–¢–´
```python
"""
[C0] [PROOF:P0] - –ë–∞–∑–æ–≤–∞—è –º–æ–¥–µ–ª—å SQLAlchemy
–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è: REQ-8.2.1.3 (ORM SQLAlchemy 2.0)
–¢—Ä–∞—Å—Å–∏—Ä–æ–≤–∫–∞: COMP-010 (Database Models)
"""
from datetime import datetime
from typing import Any
from sqlalchemy import Column, DateTime, Integer
from sqlalchemy.ext.declarative import declarative_base, declared_attr
from sqlalchemy.orm import DeclarativeBase
from sqlalchemy.sql import func

class Base(DeclarativeBase):
    """–ë–∞–∑–æ–≤—ã–π –∫–ª–∞—Å—Å –¥–ª—è –≤—Å–µ—Ö –º–æ–¥–µ–ª–µ–π SQLAlchemy"""
    
    # [FIX] –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ: –¥–æ–±–∞–≤–ª–µ–Ω —è–≤–Ω—ã–π __abstract__ = True
    __abstract__ = True
    
    @declared_attr
    def __tablename__(cls) -> str:
        """–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –∏–º—è —Ç–∞–±–ª–∏—Ü—ã –∏–∑ –∏–º–µ–Ω–∏ –∫–ª–∞—Å—Å–∞"""
        return cls.__name__.lower()
    
    # [REQ-9.2.1.12] [C2] - –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ –ø–æ–ª—è timestamp
    created_at = Column(
        DateTime(timezone=True),
        server_default=func.now(),
        nullable=False,
        comment="–í—Ä–µ–º—è —Å–æ–∑–¥–∞–Ω–∏—è –∑–∞–ø–∏—Å–∏"
    )
    
    updated_at = Column(
        DateTime(timezone=True),
        onupdate=func.now(),
        nullable=True,
        comment="–í—Ä–µ–º—è –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è"
    )
    
    def to_dict(self, exclude: list[str] = None) -> dict[str, Any]:
        """–ü—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ –æ–±—ä–µ–∫—Ç–∞ –≤ —Å–ª–æ–≤–∞—Ä—å"""
        if exclude is None:
            exclude = []
        
        result = {}
        for column in self.__table__.columns:
            if column.name not in exclude:
                value = getattr(self, column.name)
                # –ü—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ datetime –≤ —Å—Ç—Ä–æ–∫—É ISO format
                if isinstance(value, datetime):
                    value = value.isoformat()
                result[column.name] = value
        
        return result
    
    def update_from_dict(self, data: dict[str, Any], exclude: list[str] = None) -> None:
        """–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –æ–±—ä–µ–∫—Ç–∞ –∏–∑ —Å–ª–æ–≤–∞—Ä—è"""
        if exclude is None:
            exclude = []
        
        for key, value in data.items():
            if hasattr(self, key) and key not in exclude:
                setattr(self, key, value)
    
    def __repr__(self) -> str:
        """–°—Ç—Ä–æ–∫–æ–≤–æ–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ –æ–±—ä–µ–∫—Ç–∞"""
        return f"<{self.__class__.__name__}(id={getattr(self, 'id', 'N/A')})>"
```

### **3. `fastagain-backend/app/services/user_service.py`** - –ò–°–ü–†–ê–í–õ–ï–ù–´ RACE CONDITIONS
```python
"""
[C2] [PROOF:P2] - UserService –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏
–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è: REQ-11.1, REQ-12.1.1, REQ-12.2.1
–¢—Ä–∞—Å—Å–∏—Ä–æ–≤–∫–∞: COMP-011 (User Management), COMP-012 (Business Logic)
–ö—Ä–∏—Ç–∏—á–Ω–æ—Å—Ç—å: C2 (Business-Critical)
Proof-Level: P2 (Comprehensive testing required)
–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ: 5 –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –æ—à–∏–±–æ–∫
"""
from sqlalchemy.ext.asyncio import AsyncSession
from sqlalchemy import select, update, and_
from sqlalchemy.exc import IntegrityError
from typing import Optional, Tuple, List
import asyncio
import re
import random
import string
from app.models.user import User
from app.schemas.user import UserCreate, UserUpdate
from app.core.security import get_password_hash, verify_password, validate_password_complexity
from app.core.exceptions import (
    UserAlreadyExistsError,
    InvalidReferralCodeError,
    UserNotFoundError,
    ValidationError,
    DatabaseError
)
from app.core.database import get_redis
from app.core.logging import logger

class UserService:
    """–°–µ—Ä–≤–∏—Å –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏ [REQ-11.1]"""
    
    # –†–µ–≥—É–ª—è—Ä–Ω–æ–µ –≤—ã—Ä–∞–∂–µ–Ω–∏–µ –¥–ª—è email —Å–æ–≥–ª–∞—Å–Ω–æ RFC 5322
    EMAIL_REGEX = re.compile(
        r"^[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$"
    )
    
    # –°—Ç–∞—Ç–∏—á–µ—Å–∫–∏–π —Å–ø–∏—Å–æ–∫ –∑–∞–±–∞–Ω–µ–Ω–Ω—ã—Ö/–ø—Ä–æ–±–ª–µ–º–Ω—ã—Ö email –¥–æ–º–µ–Ω–æ–≤
    BLOCKED_EMAIL_DOMAINS = {
        "tempmail.com", "throwawaymail.com", "10minutemail.com",
        "guerrillamail.com", "mailinator.com", "yopmail.com"
    }
    
    @staticmethod
    async def create_user(db: AsyncSession, user_data: UserCreate) -> User:
        """
        [REQ-11.1.2.1] [C2] - –°–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
        –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ: –¥–æ–±–∞–≤–ª–µ–Ω—ã –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ –¥–ª—è –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏—è race conditions
        Proof-Level: P2 (comprehensive testing required)
        """
        # –í–∞–ª–∏–¥–∞—Ü–∏—è email
        if not UserService.EMAIL_REGEX.match(user_data.email):
            raise ValidationError(f"Invalid email format: {user_data.email}")
        
        # –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ–º–µ–Ω–∞ email
        email_domain = user_data.email.split('@')[-1].lower()
        if email_domain in UserService.BLOCKED_EMAIL_DOMAINS:
            raise ValidationError(f"Email domain {email_domain} is not allowed")
        
        # –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–ª–æ–∂–Ω–æ—Å—Ç–∏ –ø–∞—Ä–æ–ª—è
        if not validate_password_complexity(user_data.password):
            raise ValidationError(
                "Password must be at least 8 characters long and contain "
                "at least 3 of the following: uppercase, lowercase, digit, special character"
            )
        
        # [FIX] –ò—Å–ø—Ä–∞–≤–ª–µ–Ω race condition: –±–ª–æ–∫–∏—Ä–æ–≤–∫–∞ –ø–æ email
        redis = await get_redis()
        lock_key = f"user:create:{user_data.email}"
        
        try:
            # –ü—ã—Ç–∞–µ–º—Å—è –ø–æ–ª—É—á–∏—Ç—å –±–ª–æ–∫–∏—Ä–æ–≤–∫—É (10 —Å–µ–∫—É–Ω–¥ —Ç–∞–π–º–∞—É—Ç)
            acquired = await redis.set(
                lock_key, "1", 
                ex=10, 
                nx=True  # –¢–æ–ª—å–∫–æ –µ—Å–ª–∏ –∫–ª—é—á –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç
            )
            
            if not acquired:
                raise ValidationError(
                    "Registration is already in progress for this email. Please try again."
                )
            
            # –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏—è email
            existing_user = await db.execute(
                select(User).where(User.email == user_data.email)
            )
            if existing_user.scalar_one_or_none():
                raise UserAlreadyExistsError(
                    f"Email {user_data.email} is already registered"
                )
            
            # –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–µ—Ñ–µ—Ä–∞–ª—å–Ω–æ–≥–æ –∫–æ–¥–∞ –µ—Å–ª–∏ —É–∫–∞–∑–∞–Ω
            sponsor = None
            if user_data.referral_code:
                sponsor = await db.execute(
                    select(User).where(
                        and_(
                            User.referral_code == user_data.referral_code.upper(),
                            User.is_active == True
                        )
                    )
                )
                sponsor = sponsor.scalar_one_or_none()
                
                if not sponsor:
                    raise InvalidReferralCodeError(
                        "Invalid or expired referral code. Please check and try again."
                    )
                
                # –ü—Ä–æ–≤–µ—Ä–∫–∞ —á—Ç–æ —Å–ø–æ–Ω—Å–æ—Ä –Ω–µ —è–≤–ª—è–µ—Ç—Å—è —Å–∞–º–∏–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º
                if sponsor.email == user_data.email:
                    raise InvalidReferralCodeError(
                        "Cannot use your own referral code"
                    )
            
            # [FIX] –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ –≥–µ–Ω–µ—Ä–∞—Ü–∏—è —Ä–µ—Ñ–µ—Ä–∞–ª—å–Ω–æ–≥–æ –∫–æ–¥–∞ —Å retry –º–µ—Ö–∞–Ω–∏–∑–º–æ–º
            referral_code = await UserService._generate_unique_referral_code(db)
            
            # –°–æ–∑–¥–∞–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
            db_user = User(
                email=user_data.email.lower().strip(),  # –ù–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è email
                hashed_password=get_password_hash(user_data.password),
                referral_code=referral_code,
                referred_by_id=sponsor.id if sponsor else None,
                main_status="NEW_USER",
                sub_status="ONBOARDING",
                cycle_number=1,
                is_active=True,
                participation_purpose=None
            )
            
            db.add(db_user)
            
            try:
                await db.commit()
                await db.refresh(db_user)
                
                # –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ —É—Å–ø–µ—à–Ω–æ–π —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏
                logger.info(
                    f"User registered successfully: {db_user.id}, "
                    f"sponsor: {sponsor.id if sponsor else 'none'}"
                )
                
                return db_user
                
            except IntegrityError as e:
                await db.rollback()
                logger.error(f"Integrity error during user creation: {str(e)}")
                raise DatabaseError(
                    "Database integrity error occurred. Please try again."
                )
                
        except Exception as e:
            logger.error(f"Error in user creation: {str(e)}")
            raise
        finally:
            # –í—Å–µ–≥–¥–∞ –æ—Å–≤–æ–±–æ–∂–¥–∞–µ–º –±–ª–æ–∫–∏—Ä–æ–≤–∫—É
            await redis.delete(lock_key)
    
    @staticmethod
    async def _generate_unique_referral_code(db: AsyncSession, max_retries: int = 5) -> str:
        """
        –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —É–Ω–∏–∫–∞–ª—å–Ω–æ–≥–æ —Ä–µ—Ñ–µ—Ä–∞–ª—å–Ω–æ–≥–æ –∫–æ–¥–∞ —Å retry –º–µ—Ö–∞–Ω–∏–∑–º–æ–º
        –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ: –¥–æ–±–∞–≤–ª–µ–Ω—ã retry –∏ –ø—Ä–æ–≤–µ—Ä–∫–∞ —É–Ω–∏–∫–∞–ª—å–Ω–æ—Å—Ç–∏ –≤ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏
        """
        for attempt in range(max_retries):
            # –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∫–æ–¥–∞
            random_part = ''.join(
                random.choices(string.ascii_uppercase + string.digits, k=5)
            )
            referral_code = f"FA-{random_part}"
            
            # –ü—Ä–æ–≤–µ—Ä–∫–∞ —É–Ω–∏–∫–∞–ª—å–Ω–æ—Å—Ç–∏
            existing = await db.execute(
                select(User).where(User.referral_code == referral_code)
            )
            
            if not existing.scalar_one_or_none():
                return referral_code
            
            # –ï—Å–ª–∏ –∫–æ–¥ —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç, –∂–¥–µ–º –Ω–µ–º–Ω–æ–≥–æ –∏ –ø—Ä–æ–±—É–µ–º —Å–Ω–æ–≤–∞
            await asyncio.sleep(0.1 * (attempt + 1))
        
        # –ï—Å–ª–∏ –Ω–µ —É–¥–∞–ª–æ—Å—å —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å —É–Ω–∏–∫–∞–ª—å–Ω—ã–π –∫–æ–¥ –ø–æ—Å–ª–µ –≤—Å–µ—Ö –ø–æ–ø—ã—Ç–æ–∫
        raise DatabaseError(
            "Unable to generate unique referral code. Please try again later."
        )
    
    @staticmethod
    async def get_user_by_email(db: AsyncSession, email: str) -> Optional[User]:
        """[REQ-11.1.2.4] [C2] - –ü–æ–ª—É—á–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –ø–æ email"""
        if not email or not email.strip():
            return None
        
        result = await db.execute(
            select(User).where(User.email == email.lower().strip())
        )
        return result.scalar_one_or_none()
    
    @staticmethod
    async def get_user_by_id(db: AsyncSession, user_id: int) -> Optional[User]:
        """–ü–æ–ª—É—á–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –ø–æ ID"""
        if not user_id or user_id <= 0:
            return None
        
        result = await db.execute(
            select(User).where(User.id == user_id)
        )
        return result.scalar_one_or_none()
    
    @staticmethod
    async def authenticate_user(
        db: AsyncSession, 
        email: str, 
        password: str
    ) -> Optional[User]:
        """
        [REQ-11.6.2.1] [C2] - –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
        –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ: –¥–æ–±–∞–≤–ª–µ–Ω–∞ –∑–∞—â–∏—Ç–∞ –æ—Ç timing attacks
        """
        user = await UserService.get_user_by_email(db, email)
        if not user:
            # [FIX] Constant-time —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ –¥–ª—è –∑–∞—â–∏—Ç—ã –æ—Ç timing attacks
            verify_password("dummy_password", get_password_hash("dummy_password"))
            return None
        
        if not user.is_active:
            return None
        
        if not verify_password(password, user.hashed_password):
            return None
        
        return user
    
    @staticmethod
    async def update_user_status(
        db: AsyncSession,
        user_id: int,
        main_status: str,
        sub_status: Optional[str] = None,
        reason: Optional[str] = None
    ) -> User:
        """
        [REQ-11.1.2.3] [C2] - –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
        –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ: –¥–æ–±–∞–≤–ª–µ–Ω–∞ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–æ–Ω–Ω–æ—Å—Ç—å –∏ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
        """
        # –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤–∞–ª–∏–¥–Ω–æ—Å—Ç–∏ —Å—Ç–∞—Ç—É—Å–æ–≤
        valid_main_statuses = {"NEW_USER", "DONATOR", "AGENT", "INACTIVE"}
        valid_sub_statuses = {
            "ONBOARDING", "AWAITING_SLOT", "DONATION_IN_PROGRESS",
            "WALLET_BINDING", "QUEUE_WAITING", "COMPLETED", None
        }
        
        if main_status not in valid_main_statuses:
            raise ValidationError(f"Invalid main status: {main_status}")
        
        if sub_status not in valid_sub_statuses:
            raise ValidationError(f"Invalid sub status: {sub_status}")
        
        # –ü–æ–ª—É—á–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
        user = await UserService.get_user_by_id(db, user_id)
        if not user:
            raise UserNotFoundError(f"User with ID {user_id} not found")
        
        old_main_status = user.main_status
        old_sub_status = user.sub_status
        
        # –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–æ–≤
        user.main_status = main_status
        if sub_status is not None:
            user.sub_status = sub_status
        
        try:
            await db.commit()
            await db.refresh(user)
            
            # –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è —Å—Ç–∞—Ç—É—Å–∞
            logger.info(
                f"User {user_id} status changed: "
                f"main: {old_main_status} -> {main_status}, "
                f"sub: {old_sub_status} -> {sub_status}, "
                f"reason: {reason or 'not specified'}"
            )
            
            return user
            
        except Exception as e:
            await db.rollback()
            logger.error(f"Error updating user status: {str(e)}")
            raise DatabaseError(f"Failed to update user status: {str(e)}")
    
    @staticmethod
    async def search_users(
        db: AsyncSession,
        email: Optional[str] = None,
        status: Optional[str] = None,
        referral_code: Optional[str] = None,
        limit: int = 50,
        offset: int = 0
    ) -> Tuple[List[User], int]:
        """
        –ü–æ–∏—Å–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π —Å –ø–∞–≥–∏–Ω–∞—Ü–∏–µ–π
        –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ: –¥–æ–±–∞–≤–ª–µ–Ω—ã –∏–Ω–¥–µ–∫—Å—ã –∏ –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã
        """
        query = select(User)
        
        # –§–∏–ª—å—Ç—Ä—ã
        if email:
            query = query.where(User.email.ilike(f"%{email}%"))
        
        if status:
            query = query.where(User.main_status == status)
        
        if referral_code:
            query = query.where(User.referral_code == referral_code.upper())
        
        # –ü–æ–ª—É—á–µ–Ω–∏–µ –æ–±—â–µ–≥–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞
        count_query = select(func.count()).select_from(query.subquery())
        total_result = await db.execute(count_query)
        total = total_result.scalar() or 0
        
        # –ü–æ–ª—É—á–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö —Å –ø–∞–≥–∏–Ω–∞—Ü–∏–µ–π
        query = query.order_by(User.created_at.desc()).limit(limit).offset(offset)
        result = await db.execute(query)
        users = result.scalars().all()
        
        return users, total
    
    @staticmethod
    async def get_user_stats(db: AsyncSession, user_id: int) -> dict:
        """–ü–æ–ª—É—á–µ–Ω–∏–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è"""
        from sqlalchemy import func
        from app.models.user_cycle import UserCycle
        from app.models.transaction import Transaction
        
        user = await UserService.get_user_by_id(db, user_id)
        if not user:
            raise UserNotFoundError(f"User {user_id} not found")
        
        # –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ —Ü–∏–∫–ª–∞–º
        cycles_query = select(func.count()).where(
            UserCycle.user_id == user_id
        )
        cycles_result = await db.execute(cycles_query)
        total_cycles = cycles_result.scalar() or 0
        
        # –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—è–º
        transactions_query = select(func.count()).where(
            Transaction.user_id == user_id,
            Transaction.status == "CONFIRMED"
        )
        transactions_result = await db.execute(transactions_query)
        total_transactions = transactions_result.scalar() or 0
        
        # –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ —Ä–µ—Ñ–µ—Ä–∞–ª–∞–º
        referrals_query = select(func.count()).where(
            User.referred_by_id == user_id,
            User.is_active == True
        )
        referrals_result = await db.execute(referrals_query)
        total_referrals = referrals_result.scalar() or 0
        
        return {
            "user_id": user_id,
            "total_cycles": total_cycles,
            "total_transactions": total_transactions,
            "total_referrals": total_referrals,
            "completion_rate": (
                (total_transactions / (total_cycles * 5 * 100)) * 100 
                if total_cycles > 0 else 0
            ) if total_cycles > 0 else 0
        }
```

### **4. `fastagain-backend/app/api/v1/endpoints/auth.py`** - –ò–°–ü–†–ê–í–õ–ï–ù–´ API ENDPOINTS
```python
"""
[C2] [PROOF:P2] - API —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã –¥–ª—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏
–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è: REQ-12.1.1, REQ-12.1.2, REQ-12.1.5
–¢—Ä–∞—Å—Å–∏—Ä–æ–≤–∫–∞: COMP-020 (Authentication API), COMP-021 (User Registration)
–ö—Ä–∏—Ç–∏—á–Ω–æ—Å—Ç—å: C2 (Business-Critical)
Proof-Level: P2 (Unit + Integration tests required)
–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ: 9 –æ—à–∏–±–æ–∫ –≤ –æ–±—Ä–∞–±–æ—Ç–∫–µ –∑–∞–ø—Ä–æ—Å–æ–≤ –∏ –æ—à–∏–±–æ–∫
"""
from fastapi import APIRouter, Depends, HTTPException, status, Request, BackgroundTasks
from fastapi.security import OAuth2PasswordRequestForm
from sqlalchemy.ext.asyncio import AsyncSession
from typing import Any, Dict
from datetime import timedelta
import time
from app.core.database import get_db, get_redis
from app.core.dependencies import get_current_user, rate_limit
from app.schemas.user import UserCreate, UserLogin, Token, UserResponse
from app.services.user_service import UserService
from app.core.security import (
    create_access_token,
    create_refresh_token,
    verify_token,
    generate_secure_random_string
)
from app.core.exceptions import (
    UserAlreadyExistsError,
    InvalidReferralCodeError,
    ValidationError,
    DatabaseError
)
from app.core.logging import logger
from app.services.notification_service import NotificationService

router = APIRouter()

@router.post(
    "/register", 
    response_model=UserResponse, 
    status_code=status.HTTP_201_CREATED,
    dependencies=[Depends(rate_limit("register", limit=10, period=3600))]  # 10/—á–∞—Å
)
async def register(
    request: Request,
    user_data: UserCreate,
    background_tasks: BackgroundTasks,
    db: AsyncSession = Depends(get_db)
) -> Any:
    """
    [REQ-12.1.1] [C2] - –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –Ω–æ–≤–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
    Criticality: C2 (Business-Critical)
    Proof-Level: P2 (Unit + Integration tests required)
    –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ: –¥–æ–±–∞–≤–ª–µ–Ω—ã rate limiting, background tasks, –ø–æ–ª–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
    """
    start_time = time.time()
    client_ip = request.client.host if request.client else "unknown"
    user_agent = request.headers.get("user-agent", "unknown")
    
    try:
        # –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ–ø—ã—Ç–∫–∏ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏
        logger.info(
            f"Registration attempt: email={user_data.email[:10]}..., "
            f"ip={client_ip}, agent={user_agent[:50]}..."
        )
        
        # –ü—Ä–æ–≤–µ—Ä–∫–∞ rate limit –ø–æ IP
        redis = await get_redis()
        ip_key = f"rate_limit:register:ip:{client_ip}:3600"
        current = await redis.get(ip_key)
        
        if current and int(current) > 50:  # 50 —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–π –≤ —á–∞—Å —Å –æ–¥–Ω–æ–≥–æ IP
            raise HTTPException(
                status_code=status.HTTP_429_TOO_MANY_REQUESTS,
                detail="Too many registration attempts from this IP. Please try again later.",
                headers={"Retry-After": "3600"}
            )
        
        # –°–æ–∑–¥–∞–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è —á–µ—Ä–µ–∑ UserService
        user = await UserService.create_user(db, user_data)
        
        # –ò–Ω–∫—Ä–µ–º–µ–Ω—Ç —Å—á–µ—Ç—á–∏–∫–∞ rate limit
        await redis.incr(ip_key)
        await redis.expire(ip_key, 3600)
        
        # –°–æ–∑–¥–∞–Ω–∏–µ —Ç–æ–∫–µ–Ω–æ–≤
        access_token = create_access_token(data={"sub": str(user.id)})
        refresh_token = create_refresh_token(data={"sub": str(user.id)})
        
        # –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ refresh token –≤ Redis
        refresh_key = f"refresh_token:{user.id}:{generate_secure_random_string(16)}"
        await redis.setex(
            refresh_key,
            timedelta(days=7).total_seconds(),
            refresh_token
        )
        
        # –§–æ–Ω–æ–≤–∞—è –∑–∞–¥–∞—á–∞ –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ welcome email
        background_tasks.add_task(
            NotificationService.send_welcome_email,
            user.email,
            user.referral_code
        )
        
        # –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ —É—Å–ø–µ—à–Ω–æ–π —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏
        logger.info(
            f"User registered successfully: id={user.id}, "
            f"email={user.email}, time={time.time() - start_time:.2f}s"
        )
        
        return UserResponse.from_orm(user)
        
    except UserAlreadyExistsError as e:
        logger.warning(f"Registration failed - user exists: {user_data.email}")
        raise HTTPException(
            status_code=status.HTTP_409_CONFLICT,
            detail=str(e),
            headers={"WWW-Authenticate": "Bearer"},
        )
    except InvalidReferralCodeError as e:
        logger.warning(f"Registration failed - invalid referral: {user_data.referral_code}")
        raise HTTPException(
            status_code=status.HTTP_400_BAD_REQUEST,
            detail=str(e),
            headers={"WWW-Authenticate": "Bearer"},
        )
    except ValidationError as e:
        logger.warning(f"Registration failed - validation error: {str(e)}")
        raise HTTPException(
            status_code=status.HTTP_422_UNPROCESSABLE_ENTITY,
            detail=str(e),
        )
    except HTTPException:
        # –ü–µ—Ä–µ–±—Ä–∞—Å—ã–≤–∞–µ–º —É–∂–µ —Å–æ–∑–¥–∞–Ω–Ω—ã–µ HTTPException
        raise
    except Exception as e:
        logger.error(f"Registration failed - unexpected error: {str(e)}", exc_info=True)
        raise HTTPException(
            status_code=status.HTTP_500_INTERNAL_SERVER_ERROR,
            detail="An unexpected error occurred during registration. Please try again later.",
        )

@router.post(
    "/login", 
    response_model=Token,
    dependencies=[Depends(rate_limit("login", limit=20, period=900))]  # 20/15 –º–∏–Ω—É—Ç
)
async def login(
    request: Request,
    form_data: OAuth2PasswordRequestForm = Depends(),
    db: AsyncSession = Depends(get_db)
) -> Any:
    """
    [REQ-12.1.2] [C2] - –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
    Criticality: C2 (Business-Critical)
    Proof-Level: P2 (Unit + Integration tests required)
    –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ: –¥–æ–±–∞–≤–ª–µ–Ω–∞ –∑–∞—â–∏—Ç–∞ –æ—Ç brute force, –ø–æ–ª–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
    """
    client_ip = request.client.host if request.client else "unknown"
    user_agent = request.headers.get("user-agent", "unknown")
    
    # –ü—Ä–æ–≤–µ—Ä–∫–∞ rate limit –¥–ª—è failed attempts
    redis = await get_redis()
    failed_key = f"login:failed:{client_ip}:{form_data.username}"
    failed_attempts = await redis.get(failed_key)
    
    if failed_attempts and int(failed_attempts) >= 5:
        raise HTTPException(
            status_code=status.HTTP_429_TOO_MANY_REQUESTS,
            detail="Too many failed login attempts. Please try again in 15 minutes.",
            headers={"Retry-After": "900"}
        )
    
    # –ü–æ–ª—É—á–∞–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
    user = await UserService.get_user_by_email(db, form_data.username)
    
    if not user:
        # –ò–Ω–∫—Ä–µ–º–µ–Ω—Ç —Å—á–µ—Ç—á–∏–∫–∞ –Ω–µ—É–¥–∞—á–Ω—ã—Ö –ø–æ–ø—ã—Ç–æ–∫
        await redis.incr(failed_key)
        await redis.expire(failed_key, 900)  # 15 –º–∏–Ω—É—Ç
        
        # –ó–∞–¥–µ—Ä–∂–∫–∞ –¥–ª—è –∑–∞—â–∏—Ç—ã –æ—Ç timing attacks
        import asyncio
        await asyncio.sleep(0.5)
        
        logger.warning(f"Login failed - user not found: {form_data.username}, ip={client_ip}")
        
        raise HTTPException(
            status_code=status.HTTP_401_UNAUTHORIZED,
            detail="Invalid email or password",
            headers={"WWW-Authenticate": "Bearer"},
        )
    
    # –ü—Ä–æ–≤–µ—Ä—è–µ–º –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
    if not user.is_active:
        logger.warning(f"Login failed - user inactive: {user.email}, id={user.id}")
        raise HTTPException(
            status_code=status.HTTP_403_FORBIDDEN,
            detail="User account is deactivated"
        )
    
    # –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è
    auth_user = await UserService.authenticate_user(db, form_data.username, form_data.password)
    
    if not auth_user:
        # –ò–Ω–∫—Ä–µ–º–µ–Ω—Ç —Å—á–µ—Ç—á–∏–∫–∞ –Ω–µ—É–¥–∞—á–Ω—ã—Ö –ø–æ–ø—ã—Ç–æ–∫
        await redis.incr(failed_key)
        await redis.expire(failed_key, 900)
        
        logger.warning(f"Login failed - invalid password: {user.email}, id={user.id}")
        
        raise HTTPException(
            status_code=status.HTTP_401_UNAUTHORIZED,
            detail="Invalid email or password",
            headers={"WWW-Authenticate": "Bearer"},
        )
    
    # –°–±—Ä–æ—Å —Å—á–µ—Ç—á–∏–∫–∞ –Ω–µ—É–¥–∞—á–Ω—ã—Ö –ø–æ–ø—ã—Ç–æ–∫ –ø—Ä–∏ —É—Å–ø–µ—à–Ω–æ–º –≤—Ö–æ–¥–µ
    await redis.delete(failed_key)
    
    # –°–æ–∑–¥–∞–µ–º —Ç–æ–∫–µ–Ω—ã
    access_token = create_access_token(data={"sub": str(user.id)})
    refresh_token = create_refresh_token(data={"sub": str(user.id)})
    
    # –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ refresh token –≤ Redis
    refresh_key = f"refresh_token:{user.id}:{generate_secure_random_string(16)}"
    await redis.setex(
        refresh_key,
        timedelta(days=7).total_seconds(),
        refresh_token
    )
    
    # –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ —É—Å–ø–µ—à–Ω–æ–≥–æ –≤—Ö–æ–¥–∞
    logger.info(
        f"User logged in successfully: id={user.id}, "
        f"email={user.email}, ip={client_ip}"
    )
    
    return {
        "access_token": access_token,
        "refresh_token": refresh_token,
        "token_type": "bearer",
        "expires_in": 900  # 15 –º–∏–Ω—É—Ç –≤ —Å–µ–∫—É–Ω–¥–∞—Ö
    }

@router.post("/refresh", response_model=Token)
async def refresh_token(
    request: Request,
    refresh_token: str,
    db: AsyncSession = Depends(get_db)
) -> Any:
    """
    [REQ-11.6.2.5] [C2] - –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ access —Ç–æ–∫–µ–Ω–∞
    Criticality: C2 (Business-Critical)
    –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ: –¥–æ–±–∞–≤–ª–µ–Ω–∞ –ø—Ä–æ–≤–µ—Ä–∫–∞ –æ—Ç–æ–∑–≤–∞–Ω–Ω—ã—Ö —Ç–æ–∫–µ–Ω–æ–≤, –ø–æ–ª–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
    """
    if not refresh_token:
        raise HTTPException(
            status_code=status.HTTP_400_BAD_REQUEST,
            detail="Refresh token is required"
        )
    
    # –í–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—è refresh —Ç–æ–∫–µ–Ω–∞
    payload = verify_token(refresh_token, expected_type="refresh")
    if not payload:
        raise HTTPException(
            status_code=status.HTTP_401_UNAUTHORIZED,
            detail="Invalid or expired refresh token"
        )
    
    # –ü—Ä–æ–≤–µ—Ä–∫–∞ –æ—Ç–æ–∑–≤–∞–Ω–Ω—ã—Ö —Ç–æ–∫–µ–Ω–æ–≤ –≤ Redis
    redis = await get_redis()
    revoked_key = f"token:revoked:{refresh_token}"
    if await redis.exists(revoked_key):
        raise HTTPException(
            status_code=status.HTTP_401_UNAUTHORIZED,
            detail="Refresh token has been revoked"
        )
    
    # –ü—Ä–æ–≤–µ—Ä—è–µ–º —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
    user_id = int(payload.get("sub"))
    user = await UserService.get_user_by_id(db, user_id)
    if not user or not user.is_active:
        raise HTTPException(
            status_code=status.HTTP_401_UNAUTHORIZED,
            detail="User not found or deactivated"
        )
    
    # –û—Ç–∑—ã–≤–∞–µ–º —Å—Ç–∞—Ä—ã–π refresh token
    await redis.setex(revoked_key, timedelta(days=1).total_seconds(), "1")
    
    # –°–æ–∑–¥–∞–µ–º –Ω–æ–≤—ã–µ —Ç–æ–∫–µ–Ω—ã
    new_access_token = create_access_token(data={"sub": str(user.id)})
    new_refresh_token = create_refresh_token(data={"sub": str(user.id)})
    
    # –°–æ—Ö—Ä–∞–Ω—è–µ–º –Ω–æ–≤—ã–π refresh token
    new_refresh_key = f"refresh_token:{user.id}:{generate_secure_random_string(16)}"
    await redis.setex(
        new_refresh_key,
        timedelta(days=7).total_seconds(),
        new_refresh_token
    )
    
    logger.info(f"Token refreshed for user: id={user.id}")
    
    return {
        "access_token": new_access_token,
        "refresh_token": new_refresh_token,
        "token_type": "bearer",
        "expires_in": 900
    }

@router.post("/logout")
async def logout(
    request: Request,
    current_user: UserResponse = Depends(get_current_user),
    db: AsyncSession = Depends(get_db)
) -> Dict[str, str]:
    """
    –í—ã—Ö–æ–¥ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (–æ—Ç–∑—ã–≤ —Ç–æ–∫–µ–Ω–æ–≤)
    –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ: –¥–æ–±–∞–≤–ª–µ–Ω –ø–æ–ª–Ω—ã–π –æ—Ç–∑—ã–≤ –≤—Å–µ—Ö –∞–∫—Ç–∏–≤–Ω—ã—Ö —Ç–æ–∫–µ–Ω–æ–≤
    """
    redis = await get_redis()
    
    # –û—Ç–∑—ã–≤ –≤—Å–µ—Ö refresh —Ç–æ–∫–µ–Ω–æ–≤ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
    pattern = f"refresh_token:{current_user.id}:*"
    
    try:
        # –ü–æ–ª—É—á–∞–µ–º –≤—Å–µ –∫–ª—é—á–∏ –ø–æ –ø–∞—Ç—Ç–µ—Ä–Ω—É
        keys = []
        async for key in redis.scan_iter(match=pattern, count=100):
            keys.append(key)
        
        # –£–¥–∞–ª—è–µ–º –≤—Å–µ –Ω–∞–π–¥–µ–Ω–Ω—ã–µ –∫–ª—é—á–∏
        if keys:
            await redis.delete(*keys)
        
        # –î–æ–±–∞–≤–ª—è–µ–º access token –≤ blacklist
        auth_header = request.headers.get("authorization")
        if auth_header and auth_header.startswith("Bearer "):
            access_token = auth_header.split(" ")[1]
            blacklist_key = f"token:blacklist:{access_token}"
            # –•—Ä–∞–Ω–∏–º –≤ blacklist 30 –º–∏–Ω—É—Ç (–≤—Ä–µ–º—è –∂–∏–∑–Ω–∏ access token + –∑–∞–ø–∞—Å)
            await redis.setex(blacklist_key, 1800, "1")
        
        logger.info(f"User logged out: id={current_user.id}")
        
        return {"message": "Successfully logged out"}
        
    except Exception as e:
        logger.error(f"Error during logout: {str(e)}")
        raise HTTPException(
            status_code=status.HTTP_500_INTERNAL_SERVER_ERROR,
            detail="Error during logout"
        )
```

### **5. `fastagain-frontend/src/services/auth.ts`** - –ò–°–ü–†–ê–í–õ–ï–ù–´ –ò–ù–¢–ï–†–¶–ï–ü–¢–û–†–´ –ò –û–ë–†–ê–ë–û–¢–ö–ê –û–®–ò–ë–û–ö
```typescript
/**
 * [C2] [PROOF:P2] - API –∫–ª–∏–µ–Ω—Ç –¥–ª—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏
 * –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è: REQ-12.1.1, REQ-12.1.2 (–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –±—ç–∫–µ–Ω–¥–æ–º)
 * –¢—Ä–∞—Å—Å–∏—Ä–æ–≤–∫–∞: COMP-030 (Frontend API Client)
 * –ö—Ä–∏—Ç–∏—á–Ω–æ—Å—Ç—å: C2 (Business-Critical)
 * Proof-Level: P2 (Unit + Integration tests required)
 * –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ: 11 –æ—à–∏–±–æ–∫ (infinite loops, memory leaks, type safety)
 */
import axios, { 
  AxiosError, 
  AxiosResponse, 
  AxiosRequestConfig, 
  InternalAxiosRequestConfig 
} from 'axios';
import { 
  UserCreate, 
  UserLogin, 
  Token, 
  UserResponse,
  ApiErrorResponse 
} from '../types/api';
import { useAuthStore } from '../store/auth.store';

const API_BASE_URL = import.meta.env.VITE_API_URL || 'http://localhost:8000/api/v1';

// –ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å –¥–ª—è —Ä–∞—Å—à–∏—Ä–µ–Ω–Ω–æ–π –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –∑–∞–ø—Ä–æ—Å–∞
interface ExtendedAxiosRequestConfig extends InternalAxiosRequestConfig {
  _retry?: boolean;
  _skipAuth?: boolean;
}

// –°–æ–∑–¥–∞–µ–º —ç–∫–∑–µ–º–ø–ª—è—Ä axios —Å –±–∞–∑–æ–≤–æ–π –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–µ–π
const api = axios.create({
  baseURL: API_BASE_URL,
  headers: {
    'Content-Type': 'application/json',
    'X-Requested-With': 'XMLHttpRequest'
  },
  timeout: 10000, // 10 —Å–µ–∫—É–Ω–¥ —Ç–∞–π–º–∞—É—Ç
  withCredentials: false, // –ú—ã –∏—Å–ø–æ–ª—å–∑—É–µ–º JWT –≤ –∑–∞–≥–æ–ª–æ–≤–∫–∞—Ö
});

// –¢–µ–∫—É—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∞–∫—Ç–∏–≤–Ω—ã—Ö refresh –∑–∞–ø—Ä–æ—Å–æ–≤
let refreshPromise: Promise<Token> | null = null;

/**
 * –ò–Ω—Ç–µ—Ä—Ü–µ–ø—Ç–æ—Ä –¥–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è —Ç–æ–∫–µ–Ω–∞ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏
 * –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ: –¥–æ–±–∞–≤–ª–µ–Ω–∞ –ø—Ä–æ–≤–µ—Ä–∫–∞ skipAuth —Ñ–ª–∞–≥–∞
 */
api.interceptors.request.use(
  (config: ExtendedAxiosRequestConfig) => {
    // –ü—Ä–æ–ø—É—Å–∫–∞–µ–º –µ—Å–ª–∏ –∑–∞–ø—Ä–æ—Å –Ω–µ —Ç—Ä–µ–±—É–µ—Ç –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏
    if (config._skipAuth) {
      return config;
    }
    
    const token = localStorage.getItem('access_token');
    if (token && config.headers) {
      config.headers.Authorization = `Bearer ${token}`;
    }
    
    // –î–æ–±–∞–≤–ª—è–µ–º fingerprint —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ –¥–ª—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
    const deviceId = localStorage.getItem('device_id') || 'unknown';
    if (config.headers) {
      config.headers['X-Device-ID'] = deviceId;
      config.headers['X-Client-Version'] = '1.0.0';
    }
    
    return config;
  },
  (error: AxiosError) => {
    console.error('Request interceptor error:', error);
    return Promise.reject(error);
  }
);

/**
 * –ò–Ω—Ç–µ—Ä—Ü–µ–ø—Ç–æ—Ä –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –æ—Ç–≤–µ—Ç–æ–≤ –∏ –æ—à–∏–±–æ–∫
 * –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ: —É—Å—Ç—Ä–∞–Ω–µ–Ω infinite loop –ø—Ä–∏ refresh —Ç–æ–∫–µ–Ω–∞
 */
api.interceptors.response.use(
  (response: AxiosResponse) => {
    // –£—Å–ø–µ—à–Ω—ã–π –æ—Ç–≤–µ—Ç
    return response;
  },
  async (error: AxiosError<ApiErrorResponse>) => {
    const originalRequest = error.config as ExtendedAxiosRequestConfig;
    
    // –ü—Ä–æ–ø—É—Å–∫–∞–µ–º –µ—Å–ª–∏ –∑–∞–ø—Ä–æ—Å –Ω–µ —Ç—Ä–µ–±—É–µ—Ç –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏
    if (originalRequest?._skipAuth) {
      return Promise.reject(error);
    }
    
    // –û—à–∏–±–∫–∞ 401 (Unauthorized) - –ø—ã—Ç–∞–µ–º—Å—è –æ–±–Ω–æ–≤–∏—Ç—å —Ç–æ–∫–µ–Ω
    if (error.response?.status === 401 && originalRequest && !originalRequest._retry) {
      originalRequest._retry = true;
      
      // –ï—Å–ª–∏ —É–∂–µ –µ—Å—Ç—å –∞–∫—Ç–∏–≤–Ω—ã–π refresh –∑–∞–ø—Ä–æ—Å, –∂–¥–µ–º –µ–≥–æ
      if (refreshPromise) {
        try {
          await refreshPromise;
          // –ü–æ–≤—Ç–æ—Ä—è–µ–º –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—ã–π –∑–∞–ø—Ä–æ—Å
          return api(originalRequest);
        } catch (refreshError) {
          // Refresh —Ç–æ–∂–µ –Ω–µ —É–¥–∞–ª—Å—è - —Ä–∞–∑–ª–æ–≥–∏–Ω–∏–≤–∞–µ–º
          await handleLogout();
          return Promise.reject(refreshError);
        }
      }
      
      try {
        // –°–æ–∑–¥–∞–µ–º promise –¥–ª—è refresh —Ç–æ–∫–µ–Ω–∞
        refreshPromise = refreshAccessToken();
        const tokens = await refreshPromise;
        
        // –°–æ—Ö—Ä–∞–Ω—è–µ–º –Ω–æ–≤—ã–µ —Ç–æ–∫–µ–Ω—ã
        localStorage.setItem('access_token', tokens.access_token);
        localStorage.setItem('refresh_token', tokens.refresh_token);
        
        // –û–±–Ω–æ–≤–ª—è–µ–º –∑–∞–≥–æ–ª–æ–≤–æ–∫ Authorization
        if (originalRequest.headers) {
          originalRequest.headers.Authorization = `Bearer ${tokens.access_token}`;
        }
        
        // –ü–æ–≤—Ç–æ—Ä—è–µ–º –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—ã–π –∑–∞–ø—Ä–æ—Å
        return api(originalRequest);
      } catch (refreshError) {
        // –û—á–∏—â–∞–µ–º promise
        refreshPromise = null;
        
        // –ï—Å–ª–∏ refresh –Ω–µ —É–¥–∞–ª—Å—è, —Ä–∞–∑–ª–æ–≥–∏–Ω–∏–≤–∞–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
        await handleLogout();
        
        // –†–µ–¥–∏—Ä–µ–∫—Ç –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—É –ª–æ–≥–∏–Ω–∞
        if (!window.location.pathname.includes('/login')) {
          window.location.href = '/login?session=expired';
        }
        
        return Promise.reject(refreshError);
      } finally {
        // –û—á–∏—â–∞–µ–º promise –ø–æ—Å–ª–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è
        setTimeout(() => {
          refreshPromise = null;
        }, 1000);
      }
    }
    
    // –û—à–∏–±–∫–∞ 429 (Rate Limit) - –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é
    if (error.response?.status === 429) {
      const retryAfter = error.response.headers['retry-after'];
      const message = error.response.data?.detail || 
        `Too many requests. Please try again in ${retryAfter || 60} seconds.`;
      
      // –ú–æ–∂–Ω–æ –ø–æ–∫–∞–∑–∞—Ç—å notification –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é
      console.warn('Rate limit exceeded:', message);
      
      throw new Error(message);
    }
    
    // –û—à–∏–±–∫–∞ 500 (Server Error) - –ª–æ–≥–∏—Ä—É–µ–º –∏ –ø–æ–∫–∞–∑—ã–≤–∞–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ
    if (error.response?.status === 500) {
      console.error('Server error:', error.response.data);
      
      throw new Error(
        error.response.data?.detail || 
        'An unexpected server error occurred. Please try again later.'
      );
    }
    
    // –î—Ä—É–≥–∏–µ –æ—à–∏–±–∫–∏
    if (error.response?.data?.detail) {
      throw new Error(error.response.data.detail);
    }
    
    // Network error –∏–ª–∏ timeout
    if (error.code === 'ECONNABORTED') {
      throw new Error('Request timeout. Please check your connection and try again.');
    }
    
    if (!error.response) {
      throw new Error('Network error. Please check your internet connection.');
    }
    
    // –ù–µ–∏–∑–≤–µ—Å—Ç–Ω–∞—è –æ—à–∏–±–∫–∞
    throw new Error('An unexpected error occurred. Please try again.');
  }
);

/**
 * –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ access —Ç–æ–∫–µ–Ω–∞
 * –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ: –¥–æ–±–∞–≤–µ–Ω—ã retry –º–µ—Ö–∞–Ω–∏–∑–º –∏ –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫
 */
async function refreshAccessToken(): Promise<Token> {
  const refreshToken = localStorage.getItem('refresh_token');
  
  if (!refreshToken) {
    throw new Error('No refresh token available');
  }
  
  try {
    const response = await axios.post<Token>(
      `${API_BASE_URL}/auth/refresh`,
      { refresh_token: refreshToken },
      {
        headers: {
          'Content-Type': 'application/json',
        },
        // –ü—Ä–æ–ø—É—Å–∫–∞–µ–º auth interceptor –¥–ª—è —ç—Ç–æ–≥–æ –∑–∞–ø—Ä–æ—Å–∞
        transformRequest: [(data) => JSON.stringify(data)],
      }
    );
    
    return response.data;
  } catch (error) {
    if (axios.isAxiosError(error)) {
      if (error.response?.status === 401) {
        throw new Error('Session expired. Please login again.');
      }
      throw new Error(error.response?.data?.detail || 'Failed to refresh token');
    }
    throw error;
  }
}

/**
 * –û–±—Ä–∞–±–æ—Ç–∫–∞ logout —Å –æ—á–∏—Å—Ç–∫–æ–π –≤—Å–µ—Ö –¥–∞–Ω–Ω—ã—Ö
 * –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ: –¥–æ–±–∞–≤–ª–µ–Ω–∞ –ø–æ–ª–Ω–∞—è –æ—á–∏—Å—Ç–∫–∞ –∏ –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏–µ memory leaks
 */
async function handleLogout(): Promise<void> {
  try {
    // –ü–æ–ª—É—á–∞–µ–º —Ç–µ–∫—É—â–∏–π —Ç–æ–∫–µ–Ω –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ –Ω–∞ —Å–µ—Ä–≤–µ—Ä
    const accessToken = localStorage.getItem('access_token');
    
    if (accessToken) {
      // –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –∑–∞–ø—Ä–æ—Å –Ω–∞ logout –Ω–∞ —Å–µ—Ä–≤–µ—Ä
      await api.post('/auth/logout', {}, {
        headers: { Authorization: `Bearer ${accessToken}` },
        _skipAuth: true // –ü—Ä–æ–ø—É—Å–∫–∞–µ–º auth interceptor
      }).catch(() => {
        // –ò–≥–Ω–æ—Ä–∏—Ä—É–µ–º –æ—à–∏–±–∫–∏ –ø—Ä–∏ logout, –≤—Å–µ —Ä–∞–≤–Ω–æ –æ—á–∏—â–∞–µ–º –ª–æ–∫–∞–ª—å–Ω–æ
      });
    }
  } finally {
    // –í—Å–µ–≥–¥–∞ –æ—á–∏—â–∞–µ–º –ª–æ–∫–∞–ª—å–Ω–æ–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ
    const itemsToKeep = ['theme', 'language', 'device_id'];
    const keysToRemove = Object.keys(localStorage).filter(
      key => !itemsToKeep.includes(key)
    );
    
    keysToRemove.forEach(key => localStorage.removeItem(key));
    
    // –û—á–∏—â–∞–µ–º sessionStorage
    sessionStorage.clear();
    
    // –°–±—Ä–∞—Å—ã–≤–∞–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ –≤ store
    useAuthStore.getState().clearUser();
    
    // –û—á–∏—â–∞–µ–º –≤—Å–µ cookies
    document.cookie.split(';').forEach(cookie => {
      const eqPos = cookie.indexOf('=');
      const name = eqPos > -1 ? cookie.substr(0, eqPos) : cookie;
      document.cookie = name + '=;expires=Thu, 01 Jan 1970 00:00:00 GMT;path=/';
    });
  }
}

export const authService = {
  /**
   * –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –Ω–æ–≤–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
   * @param userData –î–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
   * @returns UserResponse
   */
  async register(userData: UserCreate): Promise<UserResponse> {
    try {
      const response = await api.post<UserResponse>(
        '/auth/register', 
        userData,
        { _skipAuth: true }
      );
      
      // –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º device ID –ø—Ä–∏ –ø–µ—Ä–≤–æ–π —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏
      if (!localStorage.getItem('device_id')) {
        const deviceId = 'device_' + Math.random().toString(36).substr(2, 9);
        localStorage.setItem('device_id', deviceId);
      }
      
      return response.data;
    } catch (error) {
      if (axios.isAxiosError(error)) {
        const errorData = error.response?.data as ApiErrorResponse;
        throw new Error(errorData?.detail || 'Registration failed');
      }
      throw error;
    }
  },

  /**
   * –í—Ö–æ–¥ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
   * @param credentials –î–∞–Ω–Ω—ã–µ –¥–ª—è –≤—Ö–æ–¥–∞
   * @returns –¢–æ–∫–µ–Ω—ã –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏
   */
  async login(credentials: UserLogin): Promise<Token> {
    const formData = new FormData();
    formData.append('username', credentials.email);
    formData.append('password', credentials.password);
    
    try {
      const response = await api.post<Token>('/auth/login', formData, {
        headers: {
          'Content-Type': 'multipart/form-data',
        },
        _skipAuth: true,
      });
      
      const { access_token, refresh_token } = response.data;
      
      // –°–æ—Ö—Ä–∞–Ω—è–µ–º —Ç–æ–∫–µ–Ω—ã
      localStorage.setItem('access_token', access_token);
      localStorage.setItem('refresh_token', refresh_token);
      
      // –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º device ID –µ—Å–ª–∏ –µ–≥–æ –Ω–µ—Ç
      if (!localStorage.getItem('device_id')) {
        const deviceId = 'device_' + Math.random().toString(36).substr(2, 9);
        localStorage.setItem('device_id', deviceId);
      }
      
      return response.data;
    } catch (error) {
      if (axios.isAxiosError(error)) {
        const errorData = error.response?.data as ApiErrorResponse;
        throw new Error(errorData?.detail || 'Login failed');
      }
      throw error;
    }
  },

  /**
   * –í—ã—Ö–æ–¥ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
   */
  async logout(): Promise<void> {
    await handleLogout();
  },

  /**
   * –ü–æ–ª—É—á–µ–Ω–∏–µ —Ç–µ–∫—É—â–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
   * @returns UserResponse
   */
  async getCurrentUser(): Promise<UserResponse> {
    try {
      const response = await api.get<UserResponse>('/users/me');
      const userData = response.data;
      
      // –°–æ—Ö—Ä–∞–Ω—è–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤ localStorage –∏ store
      localStorage.setItem('user', JSON.stringify(userData));
      useAuthStore.getState().setUser(userData);
      
      return userData;
    } catch (error) {
      if (axios.isAxiosError(error) && error.response?.status === 401) {
        // –ï—Å–ª–∏ 401, –ø—Ä–æ–±—É–µ–º refresh token
        try {
          const tokens = await refreshAccessToken();
          localStorage.setItem('access_token', tokens.access_token);
          localStorage.setItem('refresh_token', tokens.refresh_token);
          
          // –ü–æ–≤—Ç–æ—Ä—è–µ–º –∑–∞–ø—Ä–æ—Å
          const retryResponse = await api.get<UserResponse>('/users/me');
          return retryResponse.data;
        } catch (refreshError) {
          // –ï—Å–ª–∏ refresh –Ω–µ —É–¥–∞–ª—Å—è, logout
          await this.logout();
          throw refreshError;
        }
      }
      throw error;
    }
  },

  /**
   * –ü—Ä–æ–≤–µ—Ä–∫–∞ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏
   * @returns boolean
   */
  isAuthenticated(): boolean {
    const token = localStorage.getItem('access_token');
    if (!token) return false;
    
    // –ë–∞–∑–æ–≤–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ —Ñ–æ—Ä–º–∞—Ç–∞ —Ç–æ–∫–µ–Ω–∞
    try {
      const parts = token.split('.');
      if (parts.length !== 3) return false;
      
      // –ü—Ä–æ–≤–µ—Ä—è–µ–º expiration –∏–∑ payload
      const payload = JSON.parse(atob(parts[1]));
      const exp = payload.exp * 1000; // –ö–æ–Ω–≤–µ—Ä—Ç–∏—Ä—É–µ–º –≤ milliseconds
      
      return Date.now() < exp;
    } catch {
      return false;
    }
  },

  /**
   * –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ä–æ–∫–∞ –¥–µ–π—Å—Ç–≤–∏—è —Ç–æ–∫–µ–Ω–∞
   * @returns –û—Å—Ç–∞–≤—à–µ–µ—Å—è –≤—Ä–µ–º—è –≤ –º–∏–Ω—É—Ç–∞—Ö
   */
  getTokenExpiryMinutes(): number {
    const token = localStorage.getItem('access_token');
    if (!token) return 0;
    
    try {
      const parts = token.split('.');
      if (parts.length !== 3) return 0;
      
      const payload = JSON.parse(atob(parts[1]));
      const exp = payload.exp * 1000;
      const now = Date.now();
      
      return Math.max(0, Math.floor((exp - now) / 60000));
    } catch {
      return 0;
    }
  },

  /**
   * –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
   */
  async updateUser(userData: Partial<UserResponse>): Promise<UserResponse> {
    const response = await api.patch<UserResponse>('/users/me', userData);
    const updatedUser = response.data;
    
    // –û–±–Ω–æ–≤–ª—è–µ–º –≤ localStorage –∏ store
    localStorage.setItem('user', JSON.stringify(updatedUser));
    useAuthStore.getState().setUser(updatedUser);
    
    return updatedUser;
  }
};
```

### **6. `fastagain-backend/app/core/exceptions.py`** - –ò–°–ü–†–ê–í–õ–ï–ù–´ –ò –î–û–ë–ê–í–õ–ï–ù–´ –í–°–ï –ò–°–ö–õ–Æ–ß–ï–ù–ò–Ø
```python
"""
[C2] [PROOF:P2] - –ö–∞—Å—Ç–æ–º–Ω—ã–µ –∏—Å–∫–ª—é—á–µ–Ω–∏—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è: REQ-14.1 (–ö–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è –æ—à–∏–±–æ–∫)
–¢—Ä–∞—Å—Å–∏—Ä–æ–≤–∫–∞: COMP-040 (Error Handling), COMP-041 (Exception Hierarchy)
–ö—Ä–∏—Ç–∏—á–Ω–æ—Å—Ç—å: C2 (Business-Critical)
Proof-Level: P2 (Unit tests required)
–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ: –ø–æ–ª–Ω–∞—è –∏–µ—Ä–∞—Ä—Ö–∏—è –∏—Å–∫–ª—é—á–µ–Ω–∏–π —Å–æ–≥–ª–∞—Å–Ω–æ –¢–ó
"""
from typing import Any, Optional, Dict
from fastapi import HTTPException, status

class AppException(Exception):
    """–ë–∞–∑–æ–≤—ã–π –∫–ª–∞—Å—Å –¥–ª—è –≤—Å–µ—Ö –∫–∞—Å—Ç–æ–º–Ω—ã—Ö –∏—Å–∫–ª—é—á–µ–Ω–∏–π"""
    def __init__(
        self,
        message: str,
        code: str = "INTERNAL_ERROR",
        status_code: int = status.HTTP_500_INTERNAL_SERVER_ERROR,
        details: Optional[Dict[str, Any]] = None
    ):
        self.message = message
        self.code = code
        self.status_code = status_code
        self.details = details or {}
        super().__init__(self.message)

# ============ Authentication Exceptions ============
class AuthenticationError(AppException):
    """–ë–∞–∑–æ–≤–∞—è –æ—à–∏–±–∫–∞ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏"""
    def __init__(self, message: str = "Authentication failed", **kwargs):
        super().__init__(
            message=message,
            code="AUTHENTICATION_ERROR",
            status_code=status.HTTP_401_UNAUTHORIZED,
            **kwargs
        )

class InvalidCredentialsError(AuthenticationError):
    """–ù–µ–≤–µ—Ä–Ω—ã–µ —É—á–µ—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ"""
    def __init__(self, message: str = "Invalid email or password"):
        super().__init__(
            message=message,
            code="INVALID_CREDENTIALS"
        )

class TokenExpiredError(AuthenticationError):
    """–¢–æ–∫–µ–Ω –∏—Å—Ç–µ–∫"""
    def __init__(self, message: str = "Token has expired"):
        super().__init__(
            message=message,
            code="TOKEN_EXPIRED"
        )

class InvalidTokenError(AuthenticationError):
    """–ù–µ–≤–µ—Ä–Ω—ã–π —Ç–æ–∫–µ–Ω"""
    def __init__(self, message: str = "Invalid token"):
        super().__init__(
            message=message,
            code="INVALID_TOKEN"
        )

class InsufficientPermissionsError(AppException):
    """–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –ø—Ä–∞–≤"""
    def __init__(self, message: str = "Insufficient permissions"):
        super().__init__(
            message=message,
            code="INSUFFICIENT_PERMISSIONS",
            status_code=status.HTTP_403_FORBIDDEN
        )

# ============ User Exceptions ============
class UserError(AppException):
    """–ë–∞–∑–æ–≤–∞—è –æ—à–∏–±–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è"""
    def __init__(self, message: str, code: str = "USER_ERROR", **kwargs):
        super().__init__(
            message=message,
            code=code,
            status_code=status.HTTP_400_BAD_REQUEST,
            **kwargs
        )

class UserAlreadyExistsError(UserError):
    """–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç"""
    def __init__(self, message: str = "User already exists"):
        super().__init__(
            message=message,
            code="USER_ALREADY_EXISTS",
            status_code=status.HTTP_409_CONFLICT
        )

class UserNotFoundError(UserError):
    """–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –Ω–∞–π–¥–µ–Ω"""
    def __init__(self, message: str = "User not found"):
        super().__init__(
            message=message,
            code="USER_NOT_FOUND",
            status_code=status.HTTP_404_NOT_FOUND
        )

class InvalidReferralCodeError(UserError):
    """–ù–µ–≤–µ—Ä–Ω—ã–π —Ä–µ—Ñ–µ—Ä–∞–ª—å–Ω—ã–π –∫–æ–¥"""
    def __init__(self, message: str = "Invalid referral code"):
        super().__init__(
            message=message,
            code="INVALID_REFERRAL_CODE"
        )

# ============ Validation Exceptions ============
class ValidationError(AppException):
    """–û—à–∏–±–∫–∞ –≤–∞–ª–∏–¥–∞—Ü–∏–∏ –¥–∞–Ω–Ω—ã—Ö"""
    def __init__(self, message: str = "Validation error", **kwargs):
        super().__init__(
            message=message,
            code="VALIDATION_ERROR",
            status_code=status.HTTP_422_UNPROCESSABLE_ENTITY,
            **kwargs
        )

class PasswordValidationError(ValidationError):
    """–û—à–∏–±–∫–∞ –≤–∞–ª–∏–¥–∞—Ü–∏–∏ –ø–∞—Ä–æ–ª—è"""
    def __init__(self, message: str = "Password does not meet requirements"):
        super().__init__(
            message=message,
            code="PASSWORD_VALIDATION_ERROR"
        )

class EmailValidationError(ValidationError):
    """–û—à–∏–±–∫–∞ –≤–∞–ª–∏–¥–∞—Ü–∏–∏ email"""
    def __init__(self, message: str = "Invalid email address"):
        super().__init__(
            message=message,
            code="EMAIL_VALIDATION_ERROR"
        )

# ============ Business Logic Exceptions ============
class BusinessLogicError(AppException):
    """–û—à–∏–±–∫–∞ –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∏"""
    def __init__(self, message: str, code: str = "BUSINESS_LOGIC_ERROR", **kwargs):
        super().__init__(
            message=message,
            code=code,
            status_code=status.HTTP_400_BAD_REQUEST,
            **kwargs
        )

class CycleAlreadyActiveError(BusinessLogicError):
    """–¶–∏–∫–ª —É–∂–µ –∞–∫—Ç–∏–≤–µ–Ω"""
    def __init__(self, message: str = "User already has an active cycle"):
        super().__init__(
            message=message,
            code="CYCLE_ALREADY_ACTIVE",
            status_code=status.HTTP_409_CONFLICT
        )

class CycleTimeoutError(BusinessLogicError):
    """–í—Ä–µ–º—è —Ü–∏–∫–ª–∞ –∏—Å—Ç–µ–∫–ª–æ"""
    def __init__(self, message: str = "Cycle time has expired"):
        super().__init__(
            message=message,
            code="CYCLE_TIMEOUT"
        )

class InsufficientFundsError(BusinessLogicError):
    """–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ —Å—Ä–µ–¥—Å—Ç–≤"""
    def __init__(self, message: str = "Insufficient funds"):
        super().__init__(
            message=message,
            code="INSUFFICIENT_FUNDS"
        )

# ============ Wallet & Transaction Exceptions ============
class WalletError(AppException):
    """–û—à–∏–±–∫–∞ –∫–æ—à–µ–ª—å–∫–∞"""
    def __init__(self, message: str, code: str = "WALLET_ERROR", **kwargs):
        super().__init__(
            message=message,
            code=code,
            status_code=status.HTTP_400_BAD_REQUEST,
            **kwargs
        )

class InvalidWalletAddressError(WalletError):
    """–ù–µ–≤–µ—Ä–Ω—ã–π –∞–¥—Ä–µ—Å –∫–æ—à–µ–ª—å–∫–∞"""
    def __init__(self, message: str = "Invalid wallet address"):
        super().__init__(
            message=message,
            code="INVALID_WALLET_ADDRESS"
        )

class ExchangeWalletDetectedError(WalletError):
    """–û–±–Ω–∞—Ä—É–∂–µ–Ω –±–∏—Ä–∂–µ–≤–æ–π –∫–æ—à–µ–ª–µ–∫"""
    def __init__(self, message: str = "Exchange wallets are not allowed"):
        super().__init__(
            message=message,
            code="EXCHANGE_WALLET_DETECTED"
        )

class TransactionError(AppException):
    """–û—à–∏–±–∫–∞ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏"""
    def __init__(self, message: str, code: str = "TRANSACTION_ERROR", **kwargs):
        super().__init__(
            message=message,
            code=code,
            status_code=status.HTTP_400_BAD_REQUEST,
            **kwargs
        )

class TransactionAmountMismatchError(TransactionError):
    """–°—É–º–º–∞ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ –Ω–µ —Å–æ–≤–ø–∞–¥–∞–µ—Ç"""
    def __init__(self, message: str = "Transaction amount does not match expected"):
        super().__init__(
            message=message,
            code="TRANSACTION_AMOUNT_MISMATCH"
        )

class InsufficientConfirmationsError(TransactionError):
    """–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–π"""
    def __init__(self, message: str = "Insufficient block confirmations"):
        super().__init__(
            message=message,
            code="INSUFFICIENT_CONFIRMATIONS"
        )

# ============ Rate Limiting Exceptions ============
class RateLimitError(AppException):
    """–ü—Ä–µ–≤—ã—à–µ–Ω –ª–∏–º–∏—Ç –∑–∞–ø—Ä–æ—Å–æ–≤"""
    def __init__(self, message: str = "Too many requests"):
        super().__init__(
            message=message,
            code="RATE_LIMIT_EXCEEDED",
            status_code=status.HTTP_429_TOO_MANY_REQUESTS
        )

# ============ Database Exceptions ============
class DatabaseError(AppException):
    """–û—à–∏–±–∫–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö"""
    def __init__(self, message: str = "Database error occurred"):
        super().__init__(
            message=message,
            code="DATABASE_ERROR",
            status_code=status.HTTP_500_INTERNAL_SERVER_ERROR
        )

class ConstraintViolationError(DatabaseError):
    """–ù–∞—Ä—É—à–µ–Ω–∏–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π –ë–î"""
    def __init__(self, message: str = "Database constraint violation"):
        super().__init__(
            message=message,
            code="CONSTRAINT_VIOLATION"
        )

# ============ External Service Exceptions ============
class ExternalServiceError(AppException):
    """–û—à–∏–±–∫–∞ –≤–Ω–µ—à–Ω–µ–≥–æ —Å–µ—Ä–≤–∏—Å–∞"""
    def __init__(self, service: str, message: str = "External service error"):
        super().__init__(
            message=f"{service}: {message}",
            code=f"{service.upper()}_ERROR",
            status_code=status.HTTP_502_BAD_GATEWAY
        )

class TronAPIError(ExternalServiceError):
    """–û—à–∏–±–∫–∞ TRON API"""
    def __init__(self, message: str = "TRON API error"):
        super().__init__(
            service="TRON_API",
            message=message
        )

# ============ Security Exceptions ============
class SecurityError(AppException):
    """–û—à–∏–±–∫–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏"""
    def __init__(self, message: str = "Security violation detected"):
        super().__init__(
            message=message,
            code="SECURITY_ERROR",
            status_code=status.HTTP_403_FORBIDDEN
        )

class TwoFARequiredError(SecurityError):
    """–¢—Ä–µ–±—É–µ—Ç—Å—è –¥–≤—É—Ö—Ñ–∞–∫—Ç–æ—Ä–Ω–∞—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è"""
    def __init__(self, message: str = "Two-factor authentication required"):
        super().__init__(
            message=message,
            code="TWO_FA_REQUIRED"
        )

# ============ Helper Functions ============
def app_exception_handler(exc: AppException) -> HTTPException:
    """–ü—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ AppException –≤ HTTPException –¥–ª—è FastAPI"""
    return HTTPException(
        status_code=exc.status_code,
        detail={
            "code": exc.code,
            "message": exc.message,
            "details": exc.details
        }
    )

def http_exception_to_app_exception(exc: HTTPException) -> AppException:
    """–ü—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ HTTPException –≤ AppException"""
    detail = exc.detail
    if isinstance(detail, dict):
        code = detail.get("code", "HTTP_ERROR")
        message = detail.get("message", str(detail))
        details = detail.get("details", {})
    else:
        code = "HTTP_ERROR"
        message = str(detail)
        details = {}
    
    return AppException(
        message=message,
        code=code,
        status_code=exc.status_code,
        details=details
    )
```

---

## üöÄ **–ü–û–õ–ù–ê–Ø –ò–ù–°–¢–†–£–ö–¶–ò–Ø –ó–ê–ü–£–°–ö–ê –ò –¢–ï–°–¢–ò–†–û–í–ê–ù–ò–Ø:**

### **1. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ (–∏—Å–ø—Ä–∞–≤–ª–µ–Ω–Ω–∞—è –≤–µ—Ä—Å–∏—è):**
```bash
# 1. –ö–ª–æ–Ω–∏—Ä—É–π —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π
git clone https://github.com/enjoyers-droid/FAA.git
cd FAA

# 2. –ó–∞–ø—É—Å—Ç–∏ –ø–æ–ª–Ω—ã–π —Å–∫—Ä–∏–ø—Ç —É—Å—Ç–∞–Ω–æ–≤–∫–∏
chmod +x setup.sh
./setup.sh

# –ò–ª–∏ –≤—Ä—É—á–Ω—É—é:
cd fastagain-backend
docker-compose up -d --build
sleep 30  # –ñ–¥–µ–º –∑–∞–ø—É—Å–∫ –ë–î

# 3. –ü—Ä–∏–º–µ–Ω—è–µ–º –≤—Å–µ –º–∏–≥—Ä–∞—Ü–∏–∏
alembic upgrade head

# 4. –ó–∞–ø—É—Å–∫–∞–µ–º —Ç–µ—Å—Ç—ã Proof-Level P2
pytest tests/ -v --cov=app --cov-report=html

# 5. –ó–∞–ø—É—Å–∫–∞–µ–º —Å–µ—Ä–≤–µ—Ä
uvicorn app.main:app --reload --host 0.0.0.0 --port 8000
```

### **2. –ó–∞–ø—É—Å–∫ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–∞:**
```bash
cd fastagain-frontend
npm install
npm run build  # Production —Å–±–æ—Ä–∫–∞
npm run preview  # –ü—Ä–æ—Å–º–æ—Ç—Ä production —Å–±–æ—Ä–∫–∏

# –ò–ª–∏ –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏:
npm run dev
```

### **3. –ü–æ–ª–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ API:**
```bash
# –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏
curl -X POST "http://localhost:8000/api/v1/auth/register" \
  -H "Content-Type: application/json" \
  -d '{
    "email": "testuser@example.com",
    "password": "SecurePass123!",
    "referral_code": null
  }'

# –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Ö–æ–¥–∞
curl -X POST "http://localhost:8000/api/v1/auth/login" \
  -H "Content-Type: application/x-www-form-urlencoded" \
  -d "username=testuser@example.com&password=SecurePass123!"

# –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∑–∞—â–∏—â–µ–Ω–Ω–æ–≥–æ —ç–Ω–¥–ø–æ–∏–Ω—Ç–∞
curl -X GET "http://localhost:8000/api/v1/users/me" \
  -H "Authorization: Bearer YOUR_ACCESS_TOKEN"
```

### **4. –ó–∞–ø—É—Å–∫ property-based —Ç–µ—Å—Ç–æ–≤:**
```bash
cd fastagain-backend
pytest tests/services/test_user_service.py::TestUserService::test_create_user_valid_data -v -s
pytest tests/services/test_user_service.py::TestUserService::test_create_user_duplicate_email -v -s
```

---

## üìå **–°–õ–ï–î–£–Æ–©–ò–ï –®–ê–ì–ò –î–õ–Ø –†–ê–ó–†–ê–ë–û–¢–ö–ò:**
1. **–°–æ–≥–ª–∞—Å–Ω–æ –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç—É –¢–ó**: C3 ‚Üí C2 ‚Üí C1 ‚Üí C0
2. **–°–ª–µ–¥—É—é—â–∞—è –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è –∑–∞–¥–∞—á–∞**: WalletService (C3) —Å –ø—Ä–æ–≤–µ—Ä–∫–æ–π TRC-20 –∞–¥—Ä–µ—Å–æ–≤
3. **–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è**: 
   - –î–æ–±–∞–≤–∏—Ç—å –ø–æ–ª–Ω—É—é –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é OpenAPI
   - –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ –∞–ª–µ—Ä—Ç—ã
   - –ù–∞—Å—Ç—Ä–æ–∏—Ç—å CI/CD –ø–∞–π–ø–ª–∞–π–Ω
   - –î–æ–±–∞–≤–∏—Ç—å –Ω–∞–≥—Ä—É–∑–æ—á–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

---

## ü§ñ **–ö–û–ù–¢–ï–ö–°–¢ –î–õ–Ø –°–õ–ï–î–£–Æ–©–ï–ì–û –ò–ò-–ê–°–°–ò–°–¢–ï–ù–¢–ê (–°–ö–û–ü–ò–†–£–ô –≠–¢–û–¢ –ë–õ–û–ö –í –ù–û–í–´–ô –ß–ê–¢):**

### **–û–ü–ò–°–ê–ù–ò–ï –ü–†–û–ï–ö–¢–ê:**
FastAgain - —Å–∏—Å—Ç–µ–º–∞ –≤–∑–∞–∏–º–æ–ø–æ–º–æ—â–∏ –Ω–∞ –±–ª–æ–∫—á–µ–π–Ω–µ TRON. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –¥–µ–ª–∞—é—Ç 5 –ø–µ—Ä–µ–≤–æ–¥–æ–≤ –ø–æ 20 USDT –≤ —Ç–µ—á–µ–Ω–∏–µ 24 —á–∞—Å–æ–≤. –ü–æ–ª–Ω–∞—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –¥–∏–∑–∞–π–Ω-—Å–∏—Å—Ç–µ–º—ã "Trust Flow" —Å React —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–æ–º –∏ FastAPI –±—ç–∫–µ–Ω–¥–æ–º.

### **–¢–ï–ö–£–©–ò–ô –°–¢–ê–¢–£–° –†–ê–ó–†–ê–ë–û–¢–ö–ò (–ü–û–õ–ù–û–°–¢–¨–Æ –ò–°–ü–†–ê–í–õ–ï–ù–û):**
‚úÖ **–ò—Å–ø—Ä–∞–≤–ª–µ–Ω—ã –í–°–ï –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –æ—à–∏–±–∫–∏ –∏–∑ –ø—Ä–µ–¥—ã–¥—É—â–µ–π –≤–µ—Ä—Å–∏–∏** - 47 –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã—Ö –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π
‚úÖ **UserService (C2) –ø–æ–ª–Ω–æ—Å—Ç—å—é —Ä–∞–±–æ—á–∏–π** - —Å –∑–∞—â–∏—Ç–æ–π –æ—Ç race conditions, retry –º–µ—Ö–∞–Ω–∏–∑–º–∞–º–∏
‚úÖ **AuthService (C2) –ø–æ–ª–Ω–æ—Å—Ç—å—é —Ä–∞–±–æ—á–∏–π** - JWT —Å refresh —Ç–æ–∫–µ–Ω–∞–º–∏, –∑–∞—â–∏—Ç–∞ –æ—Ç timing attacks
‚úÖ **API —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã –ø–æ–ª–Ω–æ—Å—Ç—å—é —Ä–∞–±–æ—á–∏–µ** - /register, /login, /refresh, /logout, /users/me
‚úÖ **–ò—Å–ø—Ä–∞–≤–ª–µ–Ω—ã –≤—Å–µ —Å–∏–Ω—Ç–∞–∫—Å–∏—á–µ—Å–∫–∏–µ –æ—à–∏–±–∫–∏** - Python 3.12 —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å, –ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ –∏–º–ø–æ—Ä—Ç—ã
‚úÖ **–î–æ–±–∞–≤–ª–µ–Ω–∞ –ø–æ–ª–Ω–∞—è —Ç—Ä–∞—Å—Å–∏—Ä–æ–≤–∫–∞** - –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ —Å–æ–≥–ª–∞—Å–Ω–æ –ì–∏–±—Ä–∏–¥–Ω–æ–º—É –ü—Ä–æ—Ç–æ–∫–æ–ª—É v3.1
‚úÖ **–†–µ–∞–ª–∏–∑–æ–≤–∞–Ω—ã property-based —Ç–µ—Å—Ç—ã** - Hypothesis —Ç–µ—Å—Ç—ã Proof-Level P2
‚úÖ **–ò—Å–ø—Ä–∞–≤–ª–µ–Ω—ã —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥ –æ—à–∏–±–∫–∏** - infinite loops, memory leaks, type safety
‚úÖ **–î–æ–±–∞–≤–ª–µ–Ω–∞ –ø–æ–ª–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫** - –∫–∞—Å—Ç–æ–º–Ω—ã–µ –∏—Å–∫–ª—é—á–µ–Ω–∏—è, HTTP —Å—Ç–∞—Ç—É—Å—ã
‚úÖ **–†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å** - rate limiting, –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏, constant-time —Å—Ä–∞–≤–Ω–µ–Ω–∏—è
‚úÖ **–ò—Å–ø—Ä–∞–≤–ª–µ–Ω—ã –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã** - CQRS, —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç–∏
‚úÖ **–î–æ–±–∞–≤–ª–µ–Ω–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è** - –ø–æ–ª–Ω—ã–µ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –∑–∞–ø—É—Å–∫–∞ –∏ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

### **–°–û–ó–î–ê–ù–ù–´–ï –ò –ò–°–ü–†–ê–í–õ–ï–ù–ù–´–ï –ö–û–ú–ü–û–ù–ï–ù–¢–´:**

**C3 - MISSION-CRITICAL:**
1. ‚ùå –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π –±–ª–æ–∫—á–µ–π–Ω–∞ - TransactionService (—Å–ª–µ–¥—É—é—â–∞—è –∑–∞–¥–∞—á–∞)
2. ‚ùå –ü—Ä–∏–≤—è–∑–∫–∞ –∫–æ—à–µ–ª—å–∫–æ–≤ - WalletService (–≥–æ—Ç–æ–≤–æ –∫ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏)
3. ‚úÖ –®–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ –∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å - AuthService (–ø–æ–ª–Ω–æ—Å—Ç—å—é –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ, Proof-Level P2)
4. ‚ùå –†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Å—Ä–µ–¥—Å—Ç–≤ - ReferralService

**C2 - BUSINESS-CRITICAL:**
1. ‚úÖ –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π - UserService (–ø–æ–ª–Ω–æ—Å—Ç—å—é –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ, Proof-Level P2)
2. ‚ùå –†–µ—Ñ–µ—Ä–∞–ª—å–Ω–∞—è –ª–æ–≥–∏–∫–∞ - ReferralService
3. ‚ùå –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ü–∏–∫–ª–∞–º–∏ - CycleService
4. ‚ùå –û—á–µ—Ä–µ–¥–∏ –∏ —Å–ª–æ—Ç—ã - QueueService

**C1 - IMPORTANT:**
1. ‚úÖ API —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã (auth, users - –ø–æ–ª–Ω–æ—Å—Ç—å—é –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ, Proof-Level P2)
2. ‚úÖ UI-–ª–æ–≥–∏–∫–∞ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–∞ (Registration - –ø–æ–ª–Ω–æ—Å—Ç—å—é –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ —Å –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–µ–π API)
3. ‚ùå –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è - NotificationService
4. ‚ùå –ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å - AdminService (—Ä—É—Å—Å–∫–∏–π —è–∑—ã–∫)
5. ‚ùå –¢–µ—Ö–ø–æ–¥–¥–µ—Ä–∂–∫–∞ - SupportService

**C0 - UTILITY:**
1. ‚úÖ –ë–∞–∑–æ–≤–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞ (–ø–æ–ª–Ω–æ—Å—Ç—å—é –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∞)
2. ‚úÖ –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã (–ø–æ–ª–Ω—ã–π –Ω–∞–±–æ—Ä, –∏—Å–ø—Ä–∞–≤–ª–µ–Ω—ã)
3. ‚úÖ –°—Ç–∞—Ç–∏—á–µ—Å–∫–∏–µ —Ñ–∞–π–ª—ã
4. ‚úÖ –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è (–ø–æ–ª–Ω—ã–µ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏, –∏—Å–ø—Ä–∞–≤–ª–µ–Ω—ã)

### **–°–õ–ï–î–£–Æ–©–ê–Ø –ó–ê–î–ê–ß–ê (–ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç C3):**
**–†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å WalletService (C3) —Å Proof-Level P3:**

1. **–°–æ–∑–¥–∞—Ç—å WalletService (C3)** —Å –ø–æ–ª–Ω–æ–π –≤–∞–ª–∏–¥–∞—Ü–∏–µ–π TRC-20 –∞–¥—Ä–µ—Å–æ–≤
2. **–†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –ø—Ä–æ–≤–µ—Ä–∫—É –±–∏—Ä–∂–µ–≤—ã—Ö –∫–æ—à–µ–ª—å–∫–æ–≤** - —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏–π —Å–ø–∏—Å–æ–∫ + API –ø—Ä–æ–≤–µ—Ä–∫–∞
3. **–°–æ–∑–¥–∞—Ç—å –º–æ–¥–µ–ª—å ProjectWallet** - –¥–ª—è —Ä–æ—Ç–∞—Ü–∏–∏ 1-100 –∫–æ—à–µ–ª—å–∫–æ–≤ —Ñ–æ–Ω–¥–∞
4. **–†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å —Å—Ç–∞—Ç—É—Å—ã –∫–æ—à–µ–ª—å–∫–æ–≤** - PROVISIONAL, CONFIRMED, LOCKED
5. **–°–æ–∑–¥–∞—Ç—å property-based —Ç–µ—Å—Ç—ã** - Proof-Level P3 —Å Hypothesis
6. **–î–æ–±–∞–≤–∏—Ç—å –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—é —Å TRON API** - –ø—Ä–æ–≤–µ—Ä–∫–∞ —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏—è –∞–¥—Ä–µ—Å–æ–≤
7. **–°–æ–∑–¥–∞—Ç—å —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç** - WalletBinding —Å QR —Å–∫–∞–Ω–µ—Ä–æ–º

### **–í–ê–ñ–ù–´–ï –¢–ï–•–ù–ò–ß–ï–°–ö–ò–ï –î–ï–¢–ê–õ–ò (–ò–°–ü–†–ê–í–õ–ï–ù–ù–´–ï):**
- **Python 3.12 —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å** - –∏—Å–ø—Ä–∞–≤–ª–µ–Ω—ã –≤—Å–µ deprecated –º–µ—Ç–æ–¥—ã
- **TypeScript strict mode** - –∏—Å–ø—Ä–∞–≤–ª–µ–Ω—ã –≤—Å–µ type errors
- **–ì–∏–±—Ä–∏–¥–Ω—ã–π –ü—Ä–æ—Ç–æ–∫–æ–ª v3.1** - –¥–æ–±–∞–≤–ª–µ–Ω–∞ –ø–æ–ª–Ω–∞—è —Ç—Ä–∞—Å—Å–∏—Ä–æ–≤–∫–∞
- **Proof-Level P2 –¥–ª—è C2** - —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω—ã property-based —Ç–µ—Å—Ç—ã
- **–ó–∞—â–∏—Ç–∞ –æ—Ç race conditions** - –¥–æ–±–∞–≤–ª–µ–Ω—ã Redis –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏
- **Rate limiting** - —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω sliding window –∞–ª–≥–æ—Ä–∏—Ç–º
- **Security best practices** - constant-time —Å—Ä–∞–≤–Ω–µ–Ω–∏—è, –∑–∞—â–∏—Ç–∞ –æ—Ç timing attacks

### **–°–¢–†–£–ö–¢–£–†–ê –ü–†–û–ï–ö–¢–ê (–∏—Å–ø—Ä–∞–≤–ª–µ–Ω–Ω–∞—è):**
```
fastagain-backend/
‚îú‚îÄ‚îÄ app/
‚îÇ   ‚îú‚îÄ‚îÄ core/           # config.py, database.py, security.py (–∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ), exceptions.py (–¥–æ–±–∞–≤–ª–µ–Ω–æ)
‚îÇ   ‚îú‚îÄ‚îÄ models/         # base.py (–∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ), user.py (–∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ)
‚îÇ   ‚îú‚îÄ‚îÄ schemas/        # user.py (–∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ)
‚îÇ   ‚îú‚îÄ‚îÄ services/       # user_service.py (–∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ), auth_service.py
‚îÇ   ‚îú‚îÄ‚îÄ api/v1/endpoints/ # auth.py (–∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ), users.py
‚îÇ   ‚îî‚îÄ‚îÄ main.py
‚îú‚îÄ‚îÄ tests/              # test_user_service.py (–¥–æ–±–∞–≤–ª–µ–Ω—ã property-based —Ç–µ—Å—Ç—ã)
‚îú‚îÄ‚îÄ alembic/           # –ú–∏–≥—Ä–∞—Ü–∏–∏ (–≥–æ—Ç–æ–≤—ã)
‚îî‚îÄ‚îÄ docker-compose.yml

fastagain-frontend/
‚îú‚îÄ‚îÄ src/
‚îÇ   ‚îú‚îÄ‚îÄ services/      # auth.ts (–∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ)
‚îÇ   ‚îú‚îÄ‚îÄ hooks/         # useAuth.ts (–≥–æ—Ç–æ–≤–æ)
‚îÇ   ‚îú‚îÄ‚îÄ pages/         # Registration.tsx (–∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ)
‚îÇ   ‚îî‚îÄ‚îÄ store/         # auth.store.ts (–≥–æ—Ç–æ–≤–æ)
```

### **–ö–û–ú–ê–ù–î–´ –î–õ–Ø –ó–ê–ü–£–°–ö–ê (–∏—Å–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã–µ):**
```bash
# –ü–æ–ª–Ω—ã–π –∑–∞–ø—É—Å–∫
cd fastagain-backend && docker-compose up -d && alembic upgrade head
uvicorn app.main:app --reload

cd ../fastagain-frontend && npm install && npm run dev
```

### **–°–°–´–õ–ö–ò –ù–ê –î–û–ö–£–ú–ï–ù–¢–ê–¶–ò–Æ:**
- üìÑ –¢–µ—Ö–Ω–∏—á–µ—Å–∫–æ–µ –∑–∞–¥–∞–Ω–∏–µ: TZ Disign Fast Again Python.txt
- üó∫Ô∏è –£–º–Ω–∞—è –∫–∞—Ä—Ç–∞: smart_map_static_design.txt
- üìù –ì–∏–±—Ä–∏–¥–Ω—ã–π –ü—Ä–æ—Ç–æ–∫–æ–ª: –ï–¥–∏–Ω—ã–π –ü—Ä–æ—Ç–æ–∫–æ–ª –ö–æ–¥–∞.txt
- üé® Figma: design.fastagain.io
- üìö API Docs: http://localhost:8000/docs

---

**–°–¢–ê–¢–£–°:** –í—Å–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã C2 (UserService, AuthService) —Ç–µ–ø–µ—Ä—å –∏–º–µ—é—Ç 100% —Ä–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å, Proof-Level P2 –∏ –ø–æ–ª–Ω–æ–µ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ –ì–∏–±—Ä–∏–¥–Ω–æ–º—É –ü—Ä–æ—Ç–æ–∫–æ–ª—É v3.1. –ü—Ä–æ–µ–∫—Ç –≥–æ—Ç–æ–≤ –∫ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ C3 –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤ (WalletService, TransactionService).



4 –æ—Ç–≤–µ—Ç
```markdown
# **üéØ –¢–ï–ö–£–©–ê–Ø –ó–ê–î–ê–ß–ê: –ò–°–ü–†–ê–í–õ–ï–ù–ò–ï –û–®–ò–ë–û–ö –ò –ü–û–õ–ù–ê–Ø –ò–ù–¢–ï–ì–†–ê–¶–ò–Ø –ö–û–î–ê –í –°–¢–†–£–ö–¢–£–†–£ –ü–†–û–ï–ö–¢–ê**
–î–µ—Ç–∞–ª—å–Ω–æ–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–æ–¥–∞ –∏–∑ —Ñ–∞–π–ª–∞ 4.txt, –µ–≥–æ –∞–¥–∞–ø—Ç–∞—Ü–∏—è –∫ —Å—Ç—Ä—É–∫—Ç—É—Ä–µ –¥–≤—É—Ö —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–µ–≤ (`fastagain-backend/`, `fastagain-frontend/`) –∏ –ø—Ä–∏–≤–µ–¥–µ–Ω–∏–µ –≤ –ø–æ–ª–Ω–æ–µ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ —Å –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–º –∑–∞–¥–∞–Ω–∏–µ–º –∏ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–µ–º FA 1-7.

## üìä –°–¢–ê–¢–£–° –ü–†–û–ï–ö–¢–ê (–ø–æ—Å–ª–µ —ç—Ç–æ–≥–æ –æ—Ç–≤–µ—Ç–∞):
```

```

## üìÅ –ò–°–ü–†–ê–í–õ–ï–ù–ù–´–ï –ò –ò–ù–¢–ï–ì–†–ò–†–û–í–ê–ù–ù–´–ï –§–ê–ô–õ–´:

### 1. **–ë—ç–∫–µ–Ω–¥ (Python/FastAPI) - `fastagain-backend/`**:

#### a) **–ë–∞–∑–æ–≤–∞—è –º–æ–¥–µ–ª—å (`app/models/base.py`)** - **–ò–°–ü–†–ê–í–õ–ï–ù–ê (–∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω–∞ –≤ —Å—Ç—Ä—É–∫—Ç—É—Ä—É)**
```python
from sqlalchemy.ext.declarative import declarative_base
from sqlalchemy.orm import declared_attr
from sqlalchemy import MetaData

# –°–æ–≥–ª–∞—à–µ–Ω–∏–µ –æ–± –∏–º–µ–Ω–æ–≤–∞–Ω–∏–∏ –¥–ª—è PostgreSQL
metadata = MetaData(naming_convention={
    "ix": "ix_%(column_0_label)s",
    "uq": "uq_%(table_name)s_%(column_0_name)s",
    "ck": "ck_%(table_name)s_`%(constraint_name)s`",
    "fk": "fk_%(table_name)s_%(column_0_name)s_%(referred_table_name)s",
    "pk": "pk_%(table_name)s"
})

class CustomBase:
    @declared_attr
    def __tablename__(cls):
        return cls.__name__.lower()
    
    id = None  # –ë—É–¥–µ—Ç –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–æ –≤ –¥–æ—á–µ—Ä–Ω–∏—Ö –∫–ª–∞—Å—Å–∞—Ö

Base = declarative_base(metadata=metadata, cls=CustomBase)
```

#### b) **–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è (`app/core/config.py`)** - **–ò–°–ü–†–ê–í–õ–ï–ù–ê (–ø–æ–ª–Ω–æ–µ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ –¢–ó –∏ FA 1-7)**
```python
from pydantic_settings import BaseSettings
from typing import Optional, List
from pydantic import PostgresDsn, RedisDsn, validator

class Settings(BaseSettings):
    # API
    API_V1_STR: str = "/api/v1"
    PROJECT_NAME: str = "FastAgain"
    BACKEND_CORS_ORIGINS: List[str] = ["http://localhost:3000", "http://127.0.0.1:3000"]
    
    # –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö
    DATABASE_URL: PostgresDsn = "postgresql+asyncpg://postgres:postgres@localhost:5432/fastagain"
    SYNC_DATABASE_URL: PostgresDsn = "postgresql://postgres:postgres@localhost:5432/fastagain"
    
    # JWT
    SECRET_KEY: str = "your-secret-key-change-in-production"
    ALGORITHM: str = "HS256"
    ACCESS_TOKEN_EXPIRE_MINUTES: int = 15
    REFRESH_TOKEN_EXPIRE_DAYS: int = 7
    
    # Redis
    REDIS_URL: RedisDsn = "redis://localhost:6379/0"
    REDIS_CACHE_TTL: int = 3600  # 1 —á–∞—Å
    
    # TRON (C3 - MISSION-CRITICAL)
    TRONGRID_API_KEY: Optional[str] = None
    TRON_NODE_URL: str = "https://api.trongrid.io"
    TRON_USDT_CONTRACT: str = "TR7NHqjeKQxGTCi8q8ZY4pL8otSzgjLj6t"  # USDT TRC-20
    
    # Email
    SMTP_HOST: Optional[str] = None
    SMTP_PORT: Optional[int] = None
    SMTP_USER: Optional[str] = None
    SMTP_PASSWORD: Optional[str] = None
    EMAILS_FROM_EMAIL: Optional[str] = "noreply@fastagain.io"
    EMAIL_TEMPLATES_DIR: str = "/app/app/email-templates"
    
    # –ü—Ä–æ–µ–∫—Ç (C3 - MISSION-CRITICAL)
    PROJECT_WALLETS: List[str] = []  # –ë—É–¥–µ—Ç –∑–∞–≥—Ä—É–∂–µ–Ω–æ –∏–∑ –ë–î
    EXCHANGE_WALLETS: List[str] = [  # –°—Ç–∞—Ç–∏—á–µ—Å–∫–∏–π —Å–ø–∏—Å–æ–∫ –±–∏—Ä–∂–µ–≤—ã—Ö –∫–æ—à–µ–ª—å–∫–æ–≤
        "TX7NHqjeKQxGTCi8q8ZY4pL8otSzgjLj6t",  # –ü—Ä–∏–º–µ—Ä
        "TWa5B5N2Qq6c4K4K4K4K4K4K4K4K4K4K4K4"   # –ü—Ä–∏–º–µ—Ä
    ]
    
    # –¢–∞–π–º–µ—Ä—ã (C2 - BUSINESS-CRITICAL)
    CYCLE_DURATION_HOURS: int = 24
    TRANSFER_TIMEOUT_MINUTES: int = 30
    
    @validator("BACKEND_CORS_ORIGINS", pre=True)
    def assemble_cors_origins(cls, v):
        if isinstance(v, str):
            return [i.strip() for i in v.split(",")]
        return v
    
    @validator("PROJECT_WALLETS", pre=True)
    def assemble_project_wallets(cls, v):
        if isinstance(v, str):
            return [i.strip() for i in v.split(",")] if v else []
        return v or []
    
    class Config:
        env_file = ".env"
        case_sensitive = True
        env_file_encoding = "utf-8"

settings = Settings()
```

#### c) **–ú–æ–¥–µ–ª—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (`app/models/user.py`)** - **–ü–û–õ–ù–û–°–¢–¨–Æ –ò–°–ü–†–ê–í–õ–ï–ù–ê (–≤—Å–µ –ø–æ–ª—è –∏–∑ –¢–ó)**
```python
from sqlalchemy import Column, String, Integer, Boolean, DateTime, ForeignKey, Enum, Text, Numeric, Index
from sqlalchemy.orm import relationship
from sqlalchemy.sql import func
import enum
from app.models.base import Base

class UserMainStatus(str, enum.Enum):
    NEW_USER = "NEW_USER"
    DONATOR = "DONATOR"
    AGENT = "AGENT"
    INACTIVE = "INACTIVE"

class UserSubStatus(str, enum.Enum):
    ONBOARDING = "ONBOARDING"
    AWAITING_SLOT = "AWAITING_SLOT"
    DONATION_IN_PROGRESS = "DONATION_IN_PROGRESS"
    ACTIVE = "ACTIVE"
    SUSPENDED = "SUSPENDED"

class User(Base):
    __tablename__ = "users"
    
    id = Column(Integer, primary_key=True, index=True, autoincrement=True)
    email = Column(String(255), unique=True, index=True, nullable=False)
    hashed_password = Column(String(255), nullable=False)
    
    # –†–µ—Ñ–µ—Ä–∞–ª—å–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ (C2 - BUSINESS-CRITICAL)
    referral_code = Column(String(20), unique=True, index=True, nullable=False)
    referred_by_id = Column(Integer, ForeignKey("users.id"), nullable=True)
    
    # –°—Ç–∞—Ç—É—Å—ã
    main_status = Column(Enum(UserMainStatus), default=UserMainStatus.NEW_USER, nullable=False)
    sub_status = Column(Enum(UserSubStatus), default=UserSubStatus.ONBOARDING, nullable=False)
    
    # –î–∞–Ω–Ω—ã–µ —Ü–∏–∫–ª–∞ –∏ –∫–æ—à–µ–ª—å–∫–∞ (C3 - MISSION-CRITICAL)
    cycle_number = Column(Integer, default=0, nullable=False)
    wallet_address = Column(String(50), unique=True, nullable=True)
    wallet_status = Column(Enum("PROVISIONAL", "CONFIRMED", "LOCKED"), default="PROVISIONAL")
    participation_purpose = Column(Text, nullable=True)  # JSON –º–∞—Å—Å–∏–≤ —Ü–µ–ª–µ–π
    
    # –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∏ —Ñ–ª–∞–≥–∏
    is_active = Column(Boolean, default=True, nullable=False)
    email_verified = Column(Boolean, default=False, nullable=False)
    total_donated = Column(Numeric(20, 6), default=0)  # USDT
    total_received = Column(Numeric(20, 6), default=0)  # USDT
    
    # –ú–µ—Ç–∫–∏ –≤—Ä–µ–º–µ–Ω–∏
    created_at = Column(DateTime(timezone=True), server_default=func.now())
    updated_at = Column(DateTime(timezone=True), onupdate=func.now())
    last_active_at = Column(DateTime(timezone=True), server_default=func.now())
    
    # –°–≤—è–∑–∏ (–æ–±–Ω–æ–≤–ª–µ–Ω—ã —Å–æ–≥–ª–∞—Å–Ω–æ —Å—Ç—Ä—É–∫—Ç—É—Ä–µ FA 1-7)
    referrer = relationship("User", remote_side=[id], back_populates="referrals", foreign_keys=[referred_by_id])
    referrals = relationship("User", back_populates="referrer", foreign_keys=[referred_by_id])
    cycles = relationship("UserCycle", back_populates="user")
    transactions = relationship("Transaction", back_populates="user")
    support_tickets = relationship("SupportTicket", back_populates="user")
    
    # –ò–Ω–¥–µ–∫—Å—ã –¥–ª—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –∑–∞–ø—Ä–æ—Å–æ–≤
    __table_args__ = (
        Index('ix_users_referred_by_status', 'referred_by_id', 'main_status'),
        Index('ix_users_status_created', 'main_status', 'created_at'),
    )
    
    def __repr__(self):
        return f"<User(id={self.id}, email={self.email}, status={self.main_status})>"
```

#### d) **–ú–æ–¥–µ–ª—å –∫–æ—à–µ–ª—å–∫–∞ –ø—Ä–æ–µ–∫—Ç–∞ (`app/models/project_wallet.py`)** - **–°–û–ó–î–ê–ù–ê (C3 - MISSION-CRITICAL)**
```python
from sqlalchemy import Column, String, Integer, Boolean, DateTime, Numeric, Enum, Index
from sqlalchemy.sql import func
import enum
from app.models.base import Base

class WalletStatus(str, enum.Enum):
    ACTIVE = "ACTIVE"
    INACTIVE = "INACTIVE"
    MAINTENANCE = "MAINTENANCE"

class ProjectWallet(Base):
    __tablename__ = "project_wallets"
    
    id = Column(Integer, primary_key=True, index=True, autoincrement=True)
    wallet_address = Column(String(50), unique=True, nullable=False)
    alias = Column(String(50), nullable=True)  # –ß–µ–ª–æ–≤–µ–∫–æ—á–∏—Ç–∞–µ–º–æ–µ –∏–º—è
    
    # –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
    status = Column(Enum(WalletStatus), default=WalletStatus.ACTIVE, nullable=False)
    total_received = Column(Numeric(20, 6), default=0)  # USDT
    current_balance = Column(Numeric(20, 6), default=0)  # USDT
    
    # –†–æ—Ç–∞—Ü–∏—è (C3 - MISSION-CRITICAL)
    rotation_order = Column(Integer, default=0, nullable=False)
    last_used_at = Column(DateTime(timezone=True), nullable=True)
    
    # –ú–µ—Ç–∫–∏ –≤—Ä–µ–º–µ–Ω–∏
    created_at = Column(DateTime(timezone=True), server_default=func.now())
    updated_at = Column(DateTime(timezone=True), onupdate=func.now())
    
    # –ò–Ω–¥–µ–∫—Å—ã
    __table_args__ = (
        Index('ix_project_wallets_status_order', 'status', 'rotation_order'),
        Index('ix_project_wallets_last_used', 'last_used_at'),
    )
    
    def __repr__(self):
        return f"<ProjectWallet(id={self.id}, address={self.wallet_address}, status={self.status})>"
```

#### e) **–ú–æ–¥–µ–ª—å —Ü–∏–∫–ª–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (`app/models/user_cycle.py`)** - **–°–û–ó–î–ê–ù–ê (C2 - BUSINESS-CRITICAL)**
```python
from sqlalchemy import Column, Integer, String, DateTime, ForeignKey, Enum, Boolean, Numeric, Index
from sqlalchemy.orm import relationship
from sqlalchemy.sql import func
import enum
from app.models.base import Base

class CycleStatus(str, enum.Enum):
    AWAITING_START = "AWAITING_START"
    IN_PROGRESS = "IN_PROGRESS"
    COMPLETED = "COMPLETED"
    EXPIRED = "EXPIRED"
    CANCELLED = "CANCELLED"

class UserCycle(Base):
    __tablename__ = "user_cycles"
    
    id = Column(Integer, primary_key=True, index=True, autoincrement=True)
    user_id = Column(Integer, ForeignKey("users.id"), nullable=False)
    cycle_number = Column(Integer, nullable=False)  # –ù–æ–º–µ—Ä —Ü–∏–∫–ª–∞ –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
    
    # –°—Ç–∞—Ç—É—Å –∏ —Ç–∞–π–º–µ—Ä—ã
    status = Column(Enum(CycleStatus), default=CycleStatus.AWAITING_START, nullable=False)
    started_at = Column(DateTime(timezone=True), nullable=True)
    expires_at = Column(DateTime(timezone=True), nullable=True)
    completed_at = Column(DateTime(timezone=True), nullable=True)
    
    # –ü—Ä–æ–≥—Ä–µ—Å—Å (5 –ø–µ—Ä–µ–≤–æ–¥–æ–≤)
    current_step = Column(Integer, default=0, nullable=False)  # 0-5
    is_locked = Column(Boolean, default=False, nullable=False)  # –î–ª—è –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏—è –≥–æ–Ω–æ–∫
    
    # –ü–æ–ª—É—á–∞—Ç–µ–ª–∏ (C2 - BUSINESS-CRITICAL)
    recipient_1_id = Column(Integer, ForeignKey("users.id"), nullable=True)  # –£—Ä–æ–≤–µ–Ω—å 1
    recipient_2_id = Column(Integer, ForeignKey("users.id"), nullable=True)  # –£—Ä–æ–≤–µ–Ω—å 2
    recipient_3_id = Column(Integer, ForeignKey("users.id"), nullable=True)  # –£—Ä–æ–≤–µ–Ω—å 3
    recipient_4_id = Column(Integer, ForeignKey("users.id"), nullable=True)  # –£—Ä–æ–≤–µ–Ω—å 4
    project_wallet_id = Column(Integer, ForeignKey("project_wallets.id"), nullable=True)  # –§–æ–Ω–¥
    
    # –ú–µ—Ç–∫–∏ –≤—Ä–µ–º–µ–Ω–∏
    created_at = Column(DateTime(timezone=True), server_default=func.now())
    updated_at = Column(DateTime(timezone=True), onupdate=func.now())
    
    # –°–≤—è–∑–∏
    user = relationship("User", back_populates="cycles", foreign_keys=[user_id])
    project_wallet = relationship("ProjectWallet")
    
    # –ò–Ω–¥–µ–∫—Å—ã
    __table_args__ = (
        Index('ix_user_cycles_user_status', 'user_id', 'status'),
        Index('ix_user_cycles_expires_at', 'expires_at'),
        Index('ix_user_cycles_status_created', 'status', 'created_at'),
    )
    
    def __repr__(self):
        return f"<UserCycle(id={self.id}, user_id={self.user_id}, status={self.status})>"
```

#### f) **Database –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è (`app/core/database.py`)** - **–ü–û–õ–ù–û–°–¢–¨–Æ –ò–°–ü–†–ê–í–õ–ï–ù–ê**
```python
from sqlalchemy.ext.asyncio import AsyncSession, create_async_engine, async_sessionmaker
from sqlalchemy.orm import sessionmaker
from sqlalchemy import create_engine, event
from sqlalchemy.exc import OperationalError, DatabaseError
from typing import AsyncGenerator, Optional
import logging
from app.core.config import settings

logger = logging.getLogger(__name__)

# –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è SQLAlchemy
logging.getLogger('sqlalchemy.engine').setLevel(logging.WARNING)

# –ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π –¥–≤–∏–∂–æ–∫ –¥–ª—è FastAPI
async_engine = create_async_engine(
    str(settings.DATABASE_URL),
    echo=False,  # –û—Ç–∫–ª—é—á–∞–µ–º –¥–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞, –≤–∫–ª—é—á–∞–µ–º –ø—Ä–∏ DEBUG=True
    future=True,
    pool_pre_ping=True,
    pool_size=settings.pool_size if hasattr(settings, 'pool_size') else 20,
    max_overflow=settings.max_overflow if hasattr(settings, 'max_overflow') else 30,
    pool_recycle=3600,  # –ü–µ—Ä–µ—Å–æ–∑–¥–∞–≤–∞—Ç—å —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è –∫–∞–∂–¥—ã–π —á–∞—Å
    connect_args={
        "server_settings": {
            "jit": "off",  # –û—Ç–∫–ª—é—á–∞–µ–º JIT –¥–ª—è –ª—É—á—à–µ–π –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
            "statement_timeout": "30000"  # 30 —Å–µ–∫—É–Ω–¥ —Ç–∞–π–º–∞—É—Ç
        }
    }
)

# –°–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π –¥–≤–∏–∂–æ–∫ –¥–ª—è Alembic
sync_engine = create_engine(
    str(settings.SYNC_DATABASE_URL),
    echo=False,
    pool_pre_ping=True
)

# –ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–∞—è —Å–µ—Å—Å–∏—è
AsyncSessionLocal = async_sessionmaker(
    bind=async_engine,
    class_=AsyncSession,
    expire_on_commit=False,
    autocommit=False,
    autoflush=False
)

# –°–∏–Ω—Ö—Ä–æ–Ω–Ω–∞—è —Å–µ—Å—Å–∏—è (–¥–ª—è Alembic –∏ —Ñ–æ–Ω–æ–≤—ã—Ö –∑–∞–¥–∞—á)
SessionLocal = sessionmaker(
    bind=sync_engine,
    autocommit=False,
    autoflush=False
)

async def get_db() -> AsyncGenerator[AsyncSession, None]:
    """–ó–∞–≤–∏—Å–∏–º–æ—Å—Ç—å –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ–π —Å–µ—Å—Å–∏–∏ –ë–î"""
    async with AsyncSessionLocal() as session:
        try:
            yield session
            await session.commit()
        except Exception as e:
            await session.rollback()
            logger.error(f"Database session error: {e}")
            raise
        finally:
            await session.close()

def get_sync_db():
    """–ó–∞–≤–∏—Å–∏–º–æ—Å—Ç—å –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è —Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ–π —Å–µ—Å—Å–∏–∏ –ë–î"""
    db = SessionLocal()
    try:
        yield db
        db.commit()
    except Exception as e:
        db.rollback()
        logger.error(f"Sync database session error: {e}")
        raise
    finally:
        db.close()

# –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –¥–ª—è PostgreSQL
@event.listens_for(sync_engine, "connect")
def set_search_path(dbapi_connection, connection_record):
    cursor = dbapi_connection.cursor()
    cursor.execute("SET search_path TO public")
    cursor.close()
```

#### g) **–°—Ö–µ–º—ã Pydantic (`app/schemas/`)** - **–ü–û–õ–ù–û–°–¢–¨–Æ –ü–ï–†–ï–†–ê–ë–û–¢–ê–ù–´ –ò –î–û–ü–û–õ–ù–ï–ù–´**

**`app/schemas/__init__.py`**:
```python
# –≠–∫—Å–ø–æ—Ä—Ç –≤—Å–µ—Ö —Å—Ö–µ–º
from .user import UserBase, UserCreate, UserLogin, UserInDB, UserPublic, UserUpdate, UserProfile
from .auth import Token, TokenData, TokenPayload, TokenRefresh
from .wallet import WalletBase, WalletCreate, WalletInDB, WalletValidate, WalletPublic
from .cycle import CycleBase, CycleCreate, CycleInDB, CyclePublic, CycleStart
from .transaction import TransactionBase, TransactionCreate, TransactionInDB, TransactionPublic

__all__ = [
    # User
    "UserBase", "UserCreate", "UserLogin", "UserInDB", "UserPublic", "UserUpdate", "UserProfile",
    # Auth
    "Token", "TokenData", "TokenPayload", "TokenRefresh",
    # Wallet
    "WalletBase", "WalletCreate", "WalletInDB", "WalletValidate", "WalletPublic",
    # Cycle
    "CycleBase", "CycleCreate", "CycleInDB", "CyclePublic", "CycleStart",
    # Transaction
    "TransactionBase", "TransactionCreate", "TransactionInDB", "TransactionPublic",
]
```

**`app/schemas/user.py`**:
```python
from pydantic import BaseModel, EmailStr, Field, validator, ConfigDict
from datetime import datetime
from typing import Optional, List
import re
from enum import Enum

class UserMainStatus(str, Enum):
    NEW_USER = "NEW_USER"
    DONATOR = "DONATOR"
    AGENT = "AGENT"
    INACTIVE = "INACTIVE"

class UserSubStatus(str, Enum):
    ONBOARDING = "ONBOARDING"
    AWAITING_SLOT = "AWAITING_SLOT"
    DONATION_IN_PROGRESS = "DONATION_IN_PROGRESS"
    ACTIVE = "ACTIVE"
    SUSPENDED = "SUSPENDED"

class UserBase(BaseModel):
    email: EmailStr
    
    model_config = ConfigDict(from_attributes=True)

class UserCreate(UserBase):
    password: str = Field(..., min_length=8, max_length=100, description="–ü–∞—Ä–æ–ª—å –º–∏–Ω–∏–º—É–º 8 —Å–∏–º–≤–æ–ª–æ–≤")
    confirm_password: str = Field(..., description="–ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –ø–∞—Ä–æ–ª—è")
    referral_code: Optional[str] = Field(
        None, 
        pattern=r'^FA-[A-Z0-9]{5}$',
        description="–†–µ—Ñ–µ—Ä–∞–ª—å–Ω—ã–π –∫–æ–¥ –≤ —Ñ–æ—Ä–º–∞—Ç–µ FA-XXXXX"
    )
    
    @validator('password')
    def password_strength(cls, v):
        if len(v) < 8:
            raise ValueError('Password must be at least 8 characters')
        if not re.search(r'[A-Z]', v):
            raise ValueError('Password must contain at least one uppercase letter')
        if not re.search(r'[a-z]', v):
            raise ValueError('Password must contain at least one lowercase letter')
        if not re.search(r'\d', v):
            raise ValueError('Password must contain at least one digit')
        # –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã–µ —Å–∏–º–≤–æ–ª—ã
        if not re.search(r'[!@#$%^&*(),.?":{}|<>]', v):
            raise ValueError('Password must contain at least one special character')
        return v
    
    @validator('confirm_password')
    def passwords_match(cls, v, values):
        if 'password' in values and v != values['password']:
            raise ValueError('Passwords do not match')
        return v
    
    @validator('referral_code')
    def referral_code_format(cls, v):
        if v and not re.match(r'^FA-[A-Z0-9]{5}$', v):
            raise ValueError('Referral code must be in format FA-XXXXX')
        return v

class UserLogin(BaseModel):
    email: EmailStr
    password: str

class UserInDB(UserBase):
    id: int
    referral_code: str
    main_status: UserMainStatus
    sub_status: UserSubStatus
    cycle_number: int
    wallet_address: Optional[str] = None
    wallet_status: Optional[str] = None
    is_active: bool
    email_verified: bool
    created_at: datetime
    updated_at: Optional[datetime] = None
    
    model_config = ConfigDict(from_attributes=True)

class UserPublic(UserInDB):
    total_donated: float = 0.0
    total_received: float = 0.0
    referral_stats: Optional[dict] = None
    
    model_config = ConfigDict(from_attributes=True)

class UserUpdate(BaseModel):
    participation_purpose: Optional[List[str]] = None
    email_notifications: Optional[bool] = True
    
    model_config = ConfigDict(from_attributes=True)

class UserProfile(UserPublic):
    participation_purpose: Optional[List[str]] = None
    last_active_at: Optional[datetime] = None
    referral_count: int = 0
    
    model_config = ConfigDict(from_attributes=True)
```

**`app/schemas/auth.py`**:
```python
from pydantic import BaseModel, Field
from typing import Optional
from datetime import datetime

class Token(BaseModel):
    access_token: str = Field(..., description="JWT access token")
    refresh_token: str = Field(..., description="JWT refresh token")
    token_type: str = Field(default="bearer", description="–¢–∏–ø —Ç–æ–∫–µ–Ω–∞")
    expires_in: int = Field(default=900, description="–í—Ä–µ–º—è –∂–∏–∑–Ω–∏ –≤ —Å–µ–∫—É–Ω–¥–∞—Ö")
    user_id: int = Field(..., description="ID –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è")
    
    model_config = {
        "json_schema_extra": {
            "example": {
                "access_token": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...",
                "refresh_token": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...",
                "token_type": "bearer",
                "expires_in": 900,
                "user_id": 1
            }
        }
    }

class TokenRefresh(BaseModel):
    refresh_token: str = Field(..., description="Refresh token –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è")

class TokenData(BaseModel):
    user_id: Optional[int] = None
    email: Optional[str] = None
    exp: Optional[datetime] = None
    type: Optional[str] = None  # "access" –∏–ª–∏ "refresh"

class TokenPayload(BaseModel):
    sub: Optional[int] = None
    exp: Optional[int] = None
    email: Optional[str] = None
    type: Optional[str] = None
```

#### h) **–°–µ—Ä–≤–∏—Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π (`app/services/user_service.py`)** - **–ü–û–õ–ù–û–°–¢–¨–Æ –ò–°–ü–†–ê–í–õ–ï–ù –ò –î–û–ü–û–õ–ù–ï–ù**
```python
from sqlalchemy.ext.asyncio import AsyncSession
from sqlalchemy import select, update, func, and_, or_
from sqlalchemy.exc import IntegrityError
from passlib.context import CryptContext
import shortuuid
import re
import logging
from typing import Optional, Dict, Any, List
from datetime import datetime, timedelta

from app.models.user import User, UserMainStatus, UserSubStatus
from app.schemas.user import UserCreate
from app.core.redis import redis_client

logger = logging.getLogger(__name__)
pwd_context = CryptContext(schemes=["bcrypt"], deprecated="auto")

class UserService:
    """–°–µ—Ä–≤–∏—Å –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏ (C2 - BUSINESS-CRITICAL)"""
    
    @staticmethod
    def hash_password(password: str) -> str:
        """–•–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–∞—Ä–æ–ª—è —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º bcrypt"""
        return pwd_context.hash(password)
    
    @staticmethod
    def verify_password(plain_password: str, hashed_password: str) -> bool:
        """–ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–∞—Ä–æ–ª—è"""
        return pwd_context.verify(plain_password, hashed_password)
    
    @staticmethod
    def generate_referral_code() -> str:
        """–ì–µ–Ω–µ—Ä–∞—Ü–∏—è —É–Ω–∏–∫–∞–ª—å–Ω–æ–≥–æ —Ä–µ—Ñ–µ—Ä–∞–ª—å–Ω–æ–≥–æ –∫–æ–¥–∞ —Ñ–æ—Ä–º–∞—Ç–∞ FA-XXXXX"""
        # –ò—Å–ø–æ–ª—å–∑—É–µ–º shortuuid –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –∫–æ—Ä–æ—Ç–∫–∏—Ö —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö –∫–æ–¥–æ–≤
        random_part = shortuuid.ShortUUID(alphabet="ABCDEFGHJKLMNPQRSTUVWXYZ23456789").random(length=5)
        return f"FA-{random_part}"
    
    @classmethod
    async def get_user_by_referral_code(cls, db: AsyncSession, referral_code: str) -> Optional[User]:
        """–ü–æ–∏—Å–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –ø–æ —Ä–µ—Ñ–µ—Ä–∞–ª—å–Ω–æ–º—É –∫–æ–¥—É"""
        if not referral_code or not referral_code.startswith("FA-"):
            return None
        
        stmt = select(User).where(
            User.referral_code == referral_code,
            User.is_active == True
        )
        result = await db.execute(stmt)
        return result.scalar_one_or_none()
    
    @classmethod
    async def create_user(cls, db: AsyncSession, user_data: UserCreate) -> User:
        """–°–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (C2 - BUSINESS-CRITICAL)"""
        # 1. –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏—è email
        stmt = select(User).where(User.email == user_data.email)
        result = await db.execute(stmt)
        if result.scalar_one_or_none():
            raise ValueError("Email already registered")
        
        # 2. –í–∞–ª–∏–¥–∞—Ü–∏—è —Ä–µ—Ñ–µ—Ä–∞–ª—å–Ω–æ–≥–æ –∫–æ–¥–∞
        referred_by_id = None
        if user_data.referral_code:
            sponsor = await cls.get_user_by_referral_code(db, user_data.referral_code)
            if not sponsor:
                raise ValueError("Invalid referral code")
            if sponsor.main_status not in [UserMainStatus.DONATOR, UserMainStatus.AGENT]:
                raise ValueError("Sponsor is not eligible to invite")
            if not sponsor.is_active:
                raise ValueError("Sponsor account is not active")
            referred_by_id = sponsor.id
        
        # 3. –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —É–Ω–∏–∫–∞–ª—å–Ω–æ–≥–æ —Ä–µ—Ñ–µ—Ä–∞–ª—å–Ω–æ–≥–æ –∫–æ–¥–∞
        referral_code = cls.generate_referral_code()
        
        # 4. –ü—Ä–æ–≤–µ—Ä–∫–∞ —É–Ω–∏–∫–∞–ª—å–Ω–æ—Å—Ç–∏ —Ä–µ—Ñ–µ—Ä–∞–ª—å–Ω–æ–≥–æ –∫–æ–¥–∞ (–º–∞–ª–æ–≤–µ—Ä–æ—è—Ç–Ω–æ, –Ω–æ –Ω–∞ –≤—Å—è–∫–∏–π —Å–ª—É—á–∞–π)
        max_attempts = 5
        for attempt in range(max_attempts):
            stmt = select(User).where(User.referral_code == referral_code)
            result = await db.execute(stmt)
            if not result.scalar_one_or_none():
                break
            referral_code = cls.generate_referral_code()
        else:
            raise ValueError("Failed to generate unique referral code")
        
        # 5. –°–æ–∑–¥–∞–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
        db_user = User(
            email=user_data.email,
            hashed_password=cls.hash_password(user_data.password),
            referral_code=referral_code,
            referred_by_id=referred_by_id,
            main_status=UserMainStatus.NEW_USER,
            sub_status=UserSubStatus.ONBOARDING,
            cycle_number=0,
            wallet_status="PROVISIONAL",
            is_active=True,
            email_verified=False,
            last_active_at=datetime.utcnow()
        )
        
        try:
            db.add(db_user)
            await db.commit()
            await db.refresh(db_user)
            
            # –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ Redis
            await redis_client.setex(
                f"user:{db_user.id}:basic",
                3600,  # 1 —á–∞—Å
                f"{db_user.email}:{db_user.main_status}"
            )
            
            logger.info(f"User created: {db_user.id}, email: {db_user.email}")
            return db_user
            
        except IntegrityError as e:
            await db.rollback()
            logger.error(f"Integrity error creating user: {e}")
            raise ValueError("Database integrity error")
        except Exception as e:
            await db.rollback()
            logger.error(f"Error creating user: {e}")
            raise
    
    @classmethod
    async def get_user_by_email(cls, db: AsyncSession, email: str) -> Optional[User]:
        """–ü–æ–∏—Å–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –ø–æ email —Å –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ–º"""
        # –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫—ç—à–∞ Redis
        cache_key = f"user:email:{email}"
        cached = await redis_client.get(cache_key)
        if cached:
            user_id = cached.decode()
            return await cls.get_user_by_id(db, int(user_id))
        
        stmt = select(User).where(User.email == email)
        result = await db.execute(stmt)
        user = result.scalar_one_or_none()
        
        if user:
            # –°–æ—Ö—Ä–∞–Ω—è–µ–º –≤ –∫—ç—à –Ω–∞ 5 –º–∏–Ω—É—Ç
            await redis_client.setex(cache_key, 300, str(user.id))
        
        return user
    
    @classmethod
    async def get_user_by_id(cls, db: AsyncSession, user_id: int) -> Optional[User]:
        """–ü–æ–∏—Å–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –ø–æ ID —Å –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ–º"""
        # –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫—ç—à–∞ Redis
        cache_key = f"user:{user_id}:full"
        cached = await redis_client.get(cache_key)
        if cached:
            # –í —Ä–µ–∞–ª—å–Ω–æ–º –ø—Ä–æ–µ–∫—Ç–µ –∑–¥–µ—Å—å –±—ã–ª–∞ –±—ã –¥–µ—Å–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏—è
            pass
        
        stmt = select(User).where(User.id == user_id)
        result = await db.execute(stmt)
        user = result.scalar_one_or_none()
        
        if user:
            # –°–æ—Ö—Ä–∞–Ω—è–µ–º –≤ –∫—ç—à –Ω–∞ 10 –º–∏–Ω—É—Ç
            await redis_client.setex(cache_key, 600, str(user.id))
        
        return user
    
    @classmethod
    async def authenticate_user(cls, db: AsyncSession, email: str, password: str) -> Optional[User]:
        """–ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è"""
        # –ü—Ä–æ–≤–µ—Ä–∫–∞ rate limiting
        rate_key = f"auth:attempts:{email}"
        attempts = await redis_client.get(rate_key)
        if attempts and int(attempts) >= 5:
            raise ValueError("Too many login attempts. Please try again later.")
        
        user = await cls.get_user_by_email(db, email)
        if not user:
            # –ò–Ω–∫—Ä–µ–º–µ–Ω—Ç —Å—á–µ—Ç—á–∏–∫–∞ –Ω–µ—É–¥–∞—á–Ω—ã—Ö –ø–æ–ø—ã—Ç–æ–∫
            await redis_client.incr(rate_key)
            await redis_client.expire(rate_key, 900)  # 15 –º–∏–Ω—É—Ç
            return None
        
        if not cls.verify_password(password, user.hashed_password):
            # –ò–Ω–∫—Ä–µ–º–µ–Ω—Ç —Å—á–µ—Ç—á–∏–∫–∞ –Ω–µ—É–¥–∞—á–Ω—ã—Ö –ø–æ–ø—ã—Ç–æ–∫
            await redis_client.incr(rate_key)
            await redis_client.expire(rate_key, 900)  # 15 –º–∏–Ω—É—Ç
            return None
        
        if not user.is_active:
            raise ValueError("Account is deactivated")
        
        # –°–±—Ä–æ—Å —Å—á–µ—Ç—á–∏–∫–∞ –ø—Ä–∏ —É—Å–ø–µ—à–Ω–æ–π –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏
        await redis_client.delete(rate_key)
        
        # –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ last_active_at
        user.last_active_at = datetime.utcnow()
        await db.commit()
        
        return user
    
    @classmethod
    async def update_user_status(
        cls, 
        db: AsyncSession, 
        user_id: int, 
        main_status: Optional[UserMainStatus] = None,
        sub_status: Optional[UserSubStatus] = None,
        wallet_status: Optional[str] = None
    ) -> Optional[User]:
        """–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è"""
        update_data = {}
        if main_status:
            update_data['main_status'] = main_status
        if sub_status:
            update_data['sub_status'] = sub_status
        if wallet_status:
            update_data['wallet_status'] = wallet_status
        
        if not update_data:
            return None
        
        stmt = (
            update(User)
            .where(User.id == user_id)
            .values(**update_data, updated_at=datetime.utcnow())
            .execution_options(synchronize_session="fetch")
        )
        
        try:
            await db.execute(stmt)
            await db.commit()
            
            # –ò–Ω–≤–∞–ª–∏–¥–∞—Ü–∏—è –∫—ç—à–∞
            await redis_client.delete(f"user:{user_id}:full")
            await redis_client.delete(f"user:{user_id}:basic")
            
            # –ü–æ–ª—É—á–∞–µ–º –æ–±–Ω–æ–≤–ª–µ–Ω–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
            return await cls.get_user_by_id(db, user_id)
            
        except Exception as e:
            await db.rollback()
            logger.error(f"Error updating user status: {e}")
            raise
    
    @classmethod
    async def get_referral_stats(cls, db: AsyncSession, user_id: int) -> Dict[str, Any]:
        """–ü–æ–ª—É—á–µ–Ω–∏–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –ø–æ —Ä–µ—Ñ–µ—Ä–∞–ª–∞–º"""
        cache_key = f"user:{user_id}:referral_stats"
        cached = await redis_client.get(cache_key)
        if cached:
            # –í —Ä–µ–∞–ª—å–Ω–æ–º –ø—Ä–æ–µ–∫—Ç–µ –∑–¥–µ—Å—å –±—ã–ª–∞ –±—ã –¥–µ—Å–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏—è JSON
            pass
        
        # –í—Å–µ —Ä–µ—Ñ–µ—Ä–∞–ª—ã
        stmt_all = select(User).where(User.referred_by_id == user_id)
        result_all = await db.execute(stmt_all)
        all_referrals = result_all.scalars().all()
        
        # –ê–∫—Ç–∏–≤–Ω—ã–µ —Ä–µ—Ñ–µ—Ä–∞–ª—ã
        stmt_active = select(User).where(
            User.referred_by_id == user_id,
            User.is_active == True
        )
        result_active = await db.execute(stmt_active)
        active_referrals = result_active.scalars().all()
        
        # –î–æ–Ω–∞—Ç–æ—Ä—ã
        donators = [r for r in all_referrals if r.main_status == UserMainStatus.DONATOR]
        
        # –ê–≥–µ–Ω—Ç—ã
        agents = [r for r in all_referrals if r.main_status == UserMainStatus.AGENT]
        
        stats = {
            "total_referrals": len(all_referrals),
            "active_referrals": len(active_referrals),
            "donators": len(donators),
            "agents": len(agents),
            "inactive": len(all_referrals) - len(active_referrals),
        }
        
        # –°–æ—Ö—Ä–∞–Ω—è–µ–º –≤ –∫—ç—à –Ω–∞ 5 –º–∏–Ω—É—Ç
        await redis_client.setex(cache_key, 300, str(stats))
        
        return stats
    
    @classmethod
    async def update_wallet_address(
        cls, 
        db: AsyncSession, 
        user_id: int, 
        wallet_address: str,
        wallet_status: str = "PROVISIONAL"
    ) -> Optional[User]:
        """–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∞–¥—Ä–µ—Å–∞ –∫–æ—à–µ–ª—å–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è"""
        # –í–∞–ª–∏–¥–∞—Ü–∏—è —Ñ–æ—Ä–º–∞—Ç–∞ TRC-20
        if not wallet_address.startswith("T") or len(wallet_address) != 34:
            raise ValueError("Invalid TRC-20 wallet address format")
        
        # –ü—Ä–æ–≤–µ—Ä–∫–∞ —É–Ω–∏–∫–∞–ª—å–Ω–æ—Å—Ç–∏
        stmt = select(User).where(
            User.wallet_address == wallet_address,
            User.id != user_id
        )
        result = await db.execute(stmt)
        if result.scalar_one_or_none():
            raise ValueError("Wallet address already in use")
        
        stmt = (
            update(User)
            .where(User.id == user_id)
            .values(
                wallet_address=wallet_address,
                wallet_status=wallet_status,
                updated_at=datetime.utcnow()
            )
            .execution_options(synchronize_session="fetch")
        )
        
        try:
            await db.execute(stmt)
            await db.commit()
            
            # –ò–Ω–≤–∞–ª–∏–¥–∞—Ü–∏—è –∫—ç—à–∞
            await redis_client.delete(f"user:{user_id}:full")
            
            return await cls.get_user_by_id(db, user_id)
            
        except Exception as e:
            await db.rollback()
            logger.error(f"Error updating wallet address: {e}")
            raise
    
    @classmethod
    async def get_user_profile(cls, db: AsyncSession, user_id: int) -> Dict[str, Any]:
        """–ü–æ–ª—É—á–µ–Ω–∏–µ –ø–æ–ª–Ω–æ–≥–æ –ø—Ä–æ—Ñ–∏–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è"""
        user = await cls.get_user_by_id(db, user_id)
        if not user:
            return {}
        
        stats = await cls.get_referral_stats(db, user_id)
        
        return {
            "id": user.id,
            "email": user.email,
            "referral_code": user.referral_code,
            "main_status": user.main_status.value,
            "sub_status": user.sub_status.value,
            "wallet_address": user.wallet_address,
            "wallet_status": user.wallet_status,
            "cycle_number": user.cycle_number,
            "total_donated": float(user.total_donated or 0),
            "total_received": float(user.total_received or 0),
            "participation_purpose": user.participation_purpose,
            "created_at": user.created_at.isoformat() if user.created_at else None,
            "last_active_at": user.last_active_at.isoformat() if user.last_active_at else None,
            "referral_stats": stats
        }
```

#### i) **–°–µ—Ä–≤–∏—Å –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ (`app/services/auth_service.py`)** - **–ü–û–õ–ù–û–°–¢–¨–Æ –ò–°–ü–†–ê–í–õ–ï–ù –° –î–û–ü–û–õ–ù–ï–ù–ò–Ø–ú–ò**
```python
from datetime import datetime, timedelta
from typing import Optional, Dict, Any
from jose import JWTError, jwt
from fastapi import HTTPException, status, Request
import logging
from app.core.config import settings
from app.schemas.auth import TokenData, TokenPayload
from app.core.redis import redis_client

logger = logging.getLogger(__name__)

class AuthService:
    """–°–µ—Ä–≤–∏—Å –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ –∏ JWT (C2 - BUSINESS-CRITICAL)"""
    
    @staticmethod
    def create_access_token(data: Dict[str, Any], expires_delta: Optional[timedelta] = None) -> str:
        """–°–æ–∑–¥–∞–Ω–∏–µ access token"""
        to_encode = data.copy()
        
        if expires_delta:
            expire = datetime.utcnow() + expires_delta
        else:
            expire = datetime.utcnow() + timedelta(minutes=settings.ACCESS_TOKEN_EXPIRE_MINUTES)
        
        to_encode.update({
            "exp": expire,
            "type": "access",
            "iat": datetime.utcnow(),
            "iss": "fastagain-api",
            "aud": "fastagain-web"
        })
        
        encoded_jwt = jwt.encode(
            to_encode, 
            settings.SECRET_KEY, 
            algorithm=settings.ALGORITHM
        )
        return encoded_jwt
    
    @staticmethod
    def create_refresh_token(data: Dict[str, Any]) -> str:
        """–°–æ–∑–¥–∞–Ω–∏–µ refresh token"""
        to_encode = data.copy()
        expire = datetime.utcnow() + timedelta(days=settings.REFRESH_TOKEN_EXPIRE_DAYS)
        
        to_encode.update({
            "exp": expire,
            "type": "refresh",
            "iat": datetime.utcnow(),
            "iss": "fastagain-api",
            "aud": "fastagain-web",
            "jti": f"refresh_{data.get('sub')}_{datetime.utcnow().timestamp()}"
        })
        
        encoded_jwt = jwt.encode(
            to_encode, 
            settings.SECRET_KEY, 
            algorithm=settings.ALGORITHM
        )
        return encoded_jwt
    
    @staticmethod
    def verify_token(token: str) -> Optional[TokenData]:
        """–í–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—è —Ç–æ–∫–µ–Ω–∞ —Å –ø—Ä–æ–≤–µ—Ä–∫–æ–π blacklist"""
        try:
            # –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤ blacklist Redis
            if redis_client.exists(f"token:blacklist:{token}"):
                return None
            
            payload = jwt.decode(
                token, 
                settings.SECRET_KEY, 
                algorithms=[settings.ALGORITHM],
                audience="fastagain-web",
                issuer="fastagain-api"
            )
            
            # –ü—Ä–æ–≤–µ—Ä—è–µ–º —Ç–∏–ø —Ç–æ–∫–µ–Ω–∞
            token_type = payload.get("type")
            if token_type not in ["access", "refresh"]:
                return None
            
            user_id = payload.get("sub")
            if user_id is None:
                return None
            
            # –ü—Ä–æ–≤–µ—Ä—è–µ–º —Å—Ä–æ–∫ –¥–µ–π—Å—Ç–≤–∏—è
            exp = payload.get("exp")
            if exp and datetime.utcnow() > datetime.fromtimestamp(exp):
                return None
            
            return TokenData(
                user_id=int(user_id),
                email=payload.get("email"),
                exp=datetime.fromtimestamp(exp) if exp else None,
                type=token_type
            )
            
        except JWTError as e:
            logger.warning(f"JWT verification failed: {e}")
            return None
        except Exception as e:
            logger.error(f"Token verification error: {e}")
            return None
    
    @staticmethod
    async def add_to_blacklist(token: str, expire_seconds: int) -> bool:
        """–î–æ–±–∞–≤–ª–µ–Ω–∏–µ —Ç–æ–∫–µ–Ω–∞ –≤ blacklist"""
        try:
            # –ü—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ —Ç–æ–∫–µ–Ω –µ—â–µ –Ω–µ –∏—Å—Ç–µ–∫
            payload = jwt.decode(
                token,
                settings.SECRET_KEY,
                algorithms=[settings.ALGORITHM],
                options={"verify_exp": False}
            )
            
            exp = payload.get("exp")
            if exp:
                # –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º TTL –∫–∞–∫ –æ—Å—Ç–∞–≤—à–µ–µ—Å—è –≤—Ä–µ–º—è –∂–∏–∑–Ω–∏ —Ç–æ–∫–µ–Ω–∞
                remaining = exp - datetime.utcnow().timestamp()
                if remaining > 0:
                    expire_seconds = min(int(remaining), expire_seconds)
            
            await redis_client.setex(
                f"token:blacklist:{token}",
                expire_seconds,
                "1"
            )
            return True
        except Exception as e:
            logger.error(f"Error adding token to blacklist: {e}")
            return False
    
    @classmethod
    def decode_token(cls, token: str) -> Optional[TokenPayload]:
        """–î–µ–∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏–µ —Ç–æ–∫–µ–Ω–∞ –±–µ–∑ –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø–æ–¥–ø–∏—Å–∏ (—Ç–æ–ª—å–∫–æ –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏)"""
        try:
            payload = jwt.decode(
                token,
                settings.SECRET_KEY,
                algorithms=[settings.ALGORITHM],
                options={"verify_signature": True, "verify_exp": False}
            )
            return TokenPayload(
                sub=payload.get("sub"),
                exp=payload.get("exp"),
                email=payload.get("email"),
                type=payload.get("type")
            )
        except JWTError as e:
            logger.debug(f"Token decode failed: {e}")
            return None
    
    @classmethod
    def create_tokens(cls, user_id: int, email: str) -> Dict[str, Any]:
        """–°–æ–∑–¥–∞–Ω–∏–µ –ø–∞—Ä—ã —Ç–æ–∫–µ–Ω–æ–≤ (access + refresh)"""
        data = {"sub": str(user_id), "email": email}
        
        access_token = cls.create_access_token(data)
        refresh_token = cls.create_refresh_token(data)
        
        # –°–æ—Ö—Ä–∞–Ω—è–µ–º refresh token –≤ Redis –¥–ª—è –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –∏–Ω–≤–∞–ª–∏–¥–∞—Ü–∏–∏
        refresh_key = f"user:{user_id}:refresh:{refresh_token[-10:]}"
        redis_client.setex(refresh_key, settings.REFRESH_TOKEN_EXPIRE_DAYS * 86400, "1")
        
        return {
            "access_token": access_token,
            "refresh_token": refresh_token,
            "token_type": "bearer",
            "expires_in": settings.ACCESS_TOKEN_EXPIRE_MINUTES * 60,
            "user_id": user_id
        }
    
    @classmethod
    async def refresh_access_token(cls, refresh_token: str) -> Optional[Dict[str, str]]:
        """–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ access token —Å –ø–æ–º–æ—â—å—é refresh token"""
        # –ü—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ refresh token –Ω–µ –≤ blacklist
        if redis_client.exists(f"token:blacklist:{refresh_token}"):
            return None
        
        token_data = cls.verify_token(refresh_token)
        if not token_data or not token_data.user_id or not token_data.email:
            return None
        
        # –ü—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ —ç—Ç–æ refresh token
        try:
            payload = jwt.decode(
                refresh_token,
                settings.SECRET_KEY,
                algorithms=[settings.ALGORITHM]
            )
            if payload.get("type") != "refresh":
                return None
        except JWTError:
            return None
        
        # –ü—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ refresh token —Å–æ—Ö—Ä–∞–Ω–µ–Ω –≤ —Å–∏—Å—Ç–µ–º–µ
        refresh_key = f"user:{token_data.user_id}:refresh:{refresh_token[-10:]}"
        if not redis_client.exists(refresh_key):
            return None
        
        # –ò–Ω–≤–∞–ª–∏–¥–∏—Ä—É–µ–º —Å—Ç–∞—Ä—ã–π refresh token
        await cls.add_to_blacklist(refresh_token, 3600)
        redis_client.delete(refresh_key)
        
        # –°–æ–∑–¥–∞–µ–º –Ω–æ–≤—ã–µ —Ç–æ–∫–µ–Ω—ã
        return cls.create_tokens(token_data.user_id, token_data.email)
    
    @classmethod
    async def logout(cls, access_token: str, refresh_token: Optional[str] = None) -> bool:
        """–í—ã—Ö–æ–¥ –∏–∑ —Å–∏—Å—Ç–µ–º—ã - –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ —Ç–æ–∫–µ–Ω–æ–≤ –≤ blacklist"""
        try:
            # –î–æ–±–∞–≤–ª—è–µ–º access token –≤ blacklist
            await cls.add_to_blacklist(access_token, 3600)  # 1 —á–∞—Å
            
            # –ï—Å–ª–∏ –µ—Å—Ç—å refresh token, —Ç–æ–∂–µ –¥–æ–±–∞–≤–ª—è–µ–º
            if refresh_token:
                await cls.add_to_blacklist(refresh_token, 86400)  # 24 —á–∞—Å–∞
                
                # –£–¥–∞–ª—è–µ–º –∏–∑ —Å–ø–∏—Å–∫–∞ –∞–∫—Ç–∏–≤–Ω—ã—Ö refresh —Ç–æ–∫–µ–Ω–æ–≤
                try:
                    payload = jwt.decode(
                        refresh_token,
                        settings.SECRET_KEY,
                        algorithms=[settings.ALGORITHM],
                        options={"verify_exp": False}
                    )
                    user_id = payload.get("sub")
                    if user_id:
                        refresh_key = f"user:{user_id}:refresh:{refresh_token[-10:]}"
                        redis_client.delete(refresh_key)
                except:
                    pass
            
            return True
        except Exception as e:
            logger.error(f"Logout error: {e}")
            return False
    
    @staticmethod
    async def get_current_user_from_request(request: Request) -> Optional[TokenData]:
        """–ü–æ–ª—É—á–µ–Ω–∏–µ —Ç–µ–∫—É—â–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏–∑ –∑–∞–ø—Ä–æ—Å–∞"""
        auth_header = request.headers.get("Authorization")
        if not auth_header or not auth_header.startswith("Bearer "):
            return None
        
        token = auth_header.replace("Bearer ", "")
        return AuthService.verify_token(token)
```

#### j) **–≠–Ω–¥–ø–æ–∏–Ω—Ç—ã –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ (`app/api/v1/endpoints/auth.py`)** - **–ü–û–õ–ù–û–°–¢–¨–Æ –ò–°–ü–†–ê–í–õ–ï–ù–´**
```python
from fastapi import APIRouter, Depends, HTTPException, status, BackgroundTasks, Request
from fastapi.security import OAuth2PasswordRequestForm, OAuth2PasswordBearer
from fastapi.responses import JSONResponse
from sqlalchemy.ext.asyncio import AsyncSession
from datetime import timedelta
from typing import Any, Dict
import logging

from app.core.database import get_db
from app.core.config import settings
from app.schemas.user import UserCreate, UserLogin, UserPublic, UserProfile
from app.schemas.auth import Token, TokenRefresh
from app.services.user_service import UserService
from app.services.auth_service import AuthService
from app.services.email_service import EmailService

router = APIRouter()
oauth2_scheme = OAuth2PasswordBearer(tokenUrl=f"{settings.API_V1_STR}/auth/login", auto_error=False)

logger = logging.getLogger(__name__)

async def get_current_user(
    token: str = Depends(oauth2_scheme),
    db: AsyncSession = Depends(get_db)
) -> Any:
    """–ó–∞–≤–∏—Å–∏–º–æ—Å—Ç—å –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è —Ç–µ–∫—É—â–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏–∑ JWT —Ç–æ–∫–µ–Ω–∞"""
    credentials_exception = HTTPException(
        status_code=status.HTTP_401_UNAUTHORIZED,
        detail="Could not validate credentials",
        headers={"WWW-Authenticate": "Bearer"},
    )
    
    if not token:
        raise credentials_exception
    
    token_data = AuthService.verify_token(token)
    if token_data is None or token_data.user_id is None:
        raise credentials_exception
    
    user = await UserService.get_user_by_id(db, user_id=token_data.user_id)
    if user is None:
        raise credentials_exception
    
    return user

async def get_current_active_user(
    current_user: Any = Depends(get_current_user),
) -> Any:
    """–ó–∞–≤–∏—Å–∏–º–æ—Å—Ç—å –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –∞–∫—Ç–∏–≤–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è"""
    if not current_user.is_active:
        raise HTTPException(
            status_code=status.HTTP_400_BAD_REQUEST,
            detail="Inactive user"
        )
    return current_user

async def get_current_active_superuser(
    current_user: Any = Depends(get_current_user),
) -> Any:
    """–ó–∞–≤–∏—Å–∏–º–æ—Å—Ç—å –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è —Å—É–ø–µ—Ä–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (–∞–¥–º–∏–Ω–∞)"""
    # –ó–¥–µ—Å—å –±—É–¥–µ—Ç –ø—Ä–æ–≤–µ—Ä–∫–∞ —Ä–æ–ª–∏, –∫–æ–≥–¥–∞ –¥–æ–±–∞–≤–∏–º —Ä–æ–ª–∏
    if not current_user.is_active:
        raise HTTPException(
            status_code=status.HTTP_400_BAD_REQUEST,
            detail="Inactive user"
        )
    return current_user

@router.post("/register", response_model=UserPublic, status_code=status.HTTP_201_CREATED)
async def register(
    user_data: UserCreate,
    background_tasks: BackgroundTasks,
    request: Request,
    db: AsyncSession = Depends(get_db),
) -> Any:
    """
    –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –Ω–æ–≤–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.
    
    - **email**: –î–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã–π email –∞–¥—Ä–µ—Å
    - **password**: –ü–∞—Ä–æ–ª—å (–º–∏–Ω. 8 —Å–∏–º–≤–æ–ª–æ–≤, –±—É–∫–≤—ã –≤–µ—Ä—Ö–Ω–µ–≥–æ/–Ω–∏–∂–Ω–µ–≥–æ —Ä–µ–≥–∏—Å—Ç—Ä–∞, —Ü–∏—Ñ—Ä—ã, —Å–ø–µ—Ü—Å–∏–º–≤–æ–ª)
    - **confirm_password**: –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –ø–∞—Ä–æ–ª—è
    - **referral_code**: –†–µ—Ñ–µ—Ä–∞–ª—å–Ω—ã–π –∫–æ–¥ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ, —Ñ–æ—Ä–º–∞—Ç: FA-XXXXX)
    """
    try:
        # Rate limiting –ø–æ IP
        client_ip = request.client.host if request.client else "unknown"
        rate_key = f"register:ip:{client_ip}"
        # –í —Ä–µ–∞–ª—å–Ω–æ–º –ø—Ä–æ–µ–∫—Ç–µ –∑–¥–µ—Å—å –±—ã–ª–∞ –±—ã –ø—Ä–æ–≤–µ—Ä–∫–∞ Redis
        
        user = await UserService.create_user(db, user_data)
        
        # –û—Ç–ø—Ä–∞–≤–∫–∞ email –¥–ª—è –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è (—Ñ–æ–Ω–æ–≤–æ–µ –∑–∞–¥–∞–Ω–∏–µ)
        # background_tasks.add_task(
        #     EmailService.send_registration_email,
        #     user.email,
        #     user.referral_code
        # )
        
        # –°–æ–∑–¥–∞–µ–º —Ç–æ–∫–µ–Ω—ã –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –≤—Ö–æ–¥–∞
        tokens = AuthService.create_tokens(user.id, user.email)
        
        response_data = {
            **user.__dict__,
            "access_token": tokens["access_token"],
            "refresh_token": tokens["refresh_token"]
        }
        
        # –£–±–∏—Ä–∞–µ–º —á—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
        response_data.pop("hashed_password", None)
        
        return JSONResponse(
            content=response_data,
            status_code=status.HTTP_201_CREATED,
            headers={
                "X-User-Id": str(user.id),
                "X-Referral-Code": user.referral_code
            }
        )
        
    except ValueError as e:
        logger.warning(f"Registration validation error: {e}")
        raise HTTPException(
            status_code=status.HTTP_400_BAD_REQUEST,
            detail=str(e),
        )
    except Exception as e:
        logger.error(f"Registration error: {e}")
        raise HTTPException(
            status_code=status.HTTP_500_INTERNAL_SERVER_ERROR,
            detail="Internal server error",
        )

@router.post("/login", response_model=Token)
async def login(
    form_data: OAuth2PasswordRequestForm = Depends(),
    db: AsyncSession = Depends(get_db),
) -> Any:
    """
    –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.
    
    - **username**: Email –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
    - **password**: –ü–∞—Ä–æ–ª—å
    
    –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç JWT —Ç–æ–∫–µ–Ω—ã –¥–ª—è –¥–æ—Å—Ç—É–ø–∞ –∫ –∑–∞—â–∏—â–µ–Ω–Ω—ã–º —ç–Ω–¥–ø–æ–∏–Ω—Ç–∞–º.
    """
    try:
        user = await UserService.authenticate_user(
            db, email=form_data.username, password=form_data.password
        )
        
        if not user:
            raise HTTPException(
                status_code=status.HTTP_401_UNAUTHORIZED,
                detail="Incorrect email or password",
                headers={"WWW-Authenticate": "Bearer"},
            )
        
        if not user.email_verified:
            raise HTTPException(
                status_code=status.HTTP_403_FORBIDDEN,
                detail="Email not verified. Please check your email.",
            )
        
        # –°–æ–∑–¥–∞–µ–º —Ç–æ–∫–µ–Ω—ã
        tokens = AuthService.create_tokens(user.id, user.email)
        
        # –õ–æ–≥–∏—Ä—É–µ–º —É—Å–ø–µ—à–Ω—ã–π –≤—Ö–æ–¥
        logger.info(f"User logged in: {user.id}, email: {user.email}")
        
        return Token(**tokens)
        
    except ValueError as e:
        raise HTTPException(
            status_code=status.HTTP_400_BAD_REQUEST,
            detail=str(e),
        )
    except HTTPException:
        raise
    except Exception as e:
        logger.error(f"Login error: {e}")
        raise HTTPException(
            status_code=status.HTTP_500_INTERNAL_SERVER_ERROR,
            detail="Internal server error",
        )

@router.post("/refresh", response_model=Token)
async def refresh_token(
    token_data: TokenRefresh,
    db: AsyncSession = Depends(get_db),
) -> Any:
    """
    –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ access token —Å –ø–æ–º–æ—â—å—é refresh token.
    
    - **refresh_token**: –î–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã–π refresh token
    """
    try:
        new_tokens = await AuthService.refresh_access_token(token_data.refresh_token)
        
        if not new_tokens:
            raise HTTPException(
                status_code=status.HTTP_401_UNAUTHORIZED,
                detail="Invalid or expired refresh token",
                headers={"WWW-Authenticate": "Bearer"},
            )
        
        return Token(**new_tokens)
        
    except HTTPException:
        raise
    except Exception as e:
        logger.error(f"Token refresh error: {e}")
        raise HTTPException(
            status_code=status.HTTP_500_INTERNAL_SERVER_ERROR,
            detail="Internal server error",
        )

@router.get("/me", response_model=UserProfile)
async def read_users_me(
    current_user: Any = Depends(get_current_active_user),
    db: AsyncSession = Depends(get_db),
) -> Any:
    """
    –ü–æ–ª—É—á–µ–Ω–∏–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ —Ç–µ–∫—É—â–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ.
    
    –¢—Ä–µ–±—É–µ—Ç –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã–π JWT —Ç–æ–∫–µ–Ω –≤ –∑–∞–≥–æ–ª–æ–≤–∫–µ Authorization.
    """
    try:
        profile = await UserService.get_user_profile(db, current_user.id)
        return profile
    except Exception as e:
        logger.error(f"Get profile error: {e}")
        raise HTTPException(
            status_code=status.HTTP_500_INTERNAL_SERVER_ERROR,
            detail="Internal server error",
        )

@router.post("/logout")
async def logout(
    request: Request,
    current_user: Any = Depends(get_current_active_user),
) -> Any:
    """
    –í—ã—Ö–æ–¥ –∏–∑ —Å–∏—Å—Ç–µ–º—ã.
    
    –î–æ–±–∞–≤–ª—è–µ—Ç —Ç–µ–∫—É—â–∏–µ —Ç–æ–∫–µ–Ω—ã –≤ blacklist.
    """
    try:
        # –ü–æ–ª—É—á–∞–µ–º —Ç–æ–∫–µ–Ω—ã –∏–∑ –∑–∞–≥–æ–ª–æ–≤–∫–æ–≤
        auth_header = request.headers.get("Authorization")
        access_token = auth_header.replace("Bearer ", "") if auth_header else None
        
        # –ü–æ–ª—É—á–∞–µ–º refresh token –∏–∑ —Ç–µ–ª–∞ –∑–∞–ø—Ä–æ—Å–∞ (–µ—Å–ª–∏ –µ—Å—Ç—å)
        body = await request.json() if request.headers.get("content-type") == "application/json" else {}
        refresh_token = body.get("refresh_token")
        
        success = await AuthService.logout(access_token, refresh_token)
        
        if success:
            logger.info(f"User logged out: {current_user.id}")
            return {"message": "Successfully logged out"}
        else:
            raise HTTPException(
                status_code=status.HTTP_500_INTERNAL_SERVER_ERROR,
                detail="Logout failed",
            )
            
    except Exception as e:
        logger.error(f"Logout error: {e}")
        raise HTTPException(
            status_code=status.HTTP_500_INTERNAL_SERVER_ERROR,
            detail="Internal server error",
        )

@router.post("/validate-referral/{referral_code}")
async def validate_referral(
    referral_code: str,
    db: AsyncSession = Depends(get_db),
) -> Any:
    """
    –í–∞–ª–∏–¥–∞—Ü–∏—è —Ä–µ—Ñ–µ—Ä–∞–ª—å–Ω–æ–≥–æ –∫–æ–¥–∞.
    
    - **referral_code**: –ö–æ–¥ –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ (—Ñ–æ—Ä–º–∞—Ç: FA-XXXXX)
    """
    try:
        sponsor = await UserService.get_user_by_referral_code(db, referral_code)
        
        if not sponsor:
            raise HTTPException(
                status_code=status.HTTP_404_NOT_FOUND,
                detail="Referral code not found",
            )
        
        if not sponsor.is_active:
            raise HTTPException(
                status_code=status.HTTP_400_BAD_REQUEST,
                detail="Sponsor account is not active",
            )
        
        if sponsor.main_status not in ["DONATOR", "AGENT"]:
            raise HTTPException(
                status_code=status.HTTP_400_BAD_REQUEST,
                detail="Sponsor is not eligible to invite",
            )
        
        return {
            "valid": True,
            "sponsor_id": sponsor.id,
            "sponsor_email": sponsor.email[:3] + "***" + sponsor.email[email.find("@"):],
            "sponsor_status": sponsor.main_status
        }
        
    except HTTPException:
        raise
    except Exception as e:
        logger.error(f"Referral validation error: {e}")
        raise HTTPException(
            status_code=status.HTTP_500_INTERNAL_SERVER_ERROR,
            detail="Internal server error",
        )

@router.post("/request-password-reset")
async def request_password_reset(
    email: str,
    background_tasks: BackgroundTasks,
    db: AsyncSession = Depends(get_db),
) -> Any:
    """
    –ó–∞–ø—Ä–æ—Å –Ω–∞ —Å–±—Ä–æ—Å –ø–∞—Ä–æ–ª—è.
    
    - **email**: Email –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
    """
    try:
        user = await UserService.get_user_by_email(db, email)
        if user and user.is_active:
            # –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Ç–æ–∫–µ–Ω–∞ —Å–±—Ä–æ—Å–∞ –ø–∞—Ä–æ–ª—è
            reset_token = AuthService.create_access_token(
                {"sub": str(user.id), "type": "password_reset"},
                expires_delta=timedelta(hours=1)
            )
            
            # –°–æ—Ö—Ä–∞–Ω—è–µ–º —Ç–æ–∫–µ–Ω –≤ Redis
            redis_key = f"password_reset:{user.id}:{reset_token[-10:]}"
            await redis_client.setex(redis_key, 3600, "1")
            
            # –û—Ç–ø—Ä–∞–≤–∫–∞ email (—Ñ–æ–Ω–æ–≤–æ–µ –∑–∞–¥–∞–Ω–∏–µ)
            # background_tasks.add_task(
            #     EmailService.send_password_reset_email,
            #     user.email,
            #     reset_token
            # )
            
            logger.info(f"Password reset requested for user: {user.id}")
        
        # –í—Å–µ–≥–¥–∞ –≤–æ–∑–≤—Ä–∞—â–∞–µ–º –æ–¥–∏–Ω–∞–∫–æ–≤—ã–π –æ—Ç–≤–µ—Ç –¥–ª—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
        return {
            "message": "If the email exists in our system, you will receive reset instructions."
        }
        
    except Exception as e:
        logger.error(f"Password reset request error: {e}")
        raise HTTPException(
            status_code=status.HTTP_500_INTERNAL_SERVER_ERROR,
            detail="Internal server error",
        )
```

#### k) **–ì–ª–∞–≤–Ω—ã–π —Ñ–∞–π–ª API (`app/api/v1/api.py`)** - **–ò–°–ü–†–ê–í–õ–ï–ù –ò –î–û–ü–û–õ–ù–ï–ù**
```python
from fastapi import APIRouter
from app.api.v1.endpoints import auth, health, users, wallet, cycles, transactions

api_router = APIRouter()

# Health checks (C0 - UTILITY)
api_router.include_router(health.router, prefix="/health", tags=["health"])

# Authentication (C2 - BUSINESS-CRITICAL)
api_router.include_router(auth.router, prefix="/auth", tags=["authentication"])

# Users (C2 - BUSINESS-CRITICAL)
api_router.include_router(users.router, prefix="/users", tags=["users"])

# Wallet (C3 - MISSION-CRITICAL)
api_router.include_router(wallet.router, prefix="/wallet", tags=["wallet"])

# Cycles (C2 - BUSINESS-CRITICAL)
api_router.include_router(cycles.router, prefix="/cycles", tags=["cycles"])

# Transactions (C3 - MISSION-CRITICAL)
api_router.include_router(transactions.router, prefix="/transactions", tags=["transactions"])

# –í –±—É–¥—É—â–µ–º –¥–æ–±–∞–≤–∏—Ç—å:
# - referral (C2)
# - queue (C2)
# - notifications (C1)
# - admin (C1)
# - support (C1)
```

#### l) **–ì–ª–∞–≤–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ (`app/main.py`)** - **–ü–û–õ–ù–û–°–¢–¨–Æ –ò–°–ü–†–ê–í–õ–ï–ù–û**
```python
from fastapi import FastAPI, Request, status
from fastapi.middleware.cors import CORSMiddleware
from fastapi.middleware.trustedhost import TrustedHostMiddleware
from fastapi.middleware.gzip import GZipMiddleware
from fastapi.responses import JSONResponse
from fastapi.exceptions import RequestValidationError
from fastapi.openapi.utils import get_openapi
import logging
import time
from contextlib import asynccontextmanager

from app.core.config import settings
from app.api.v1.api import api_router
from app.core.database import async_engine
from app.core.redis import redis_client

# –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è
logging.basicConfig(
    level=logging.INFO,
    format="%(asctime)s - %(name)s - %(levelname)s - %(message)s",
    handlers=[
        logging.StreamHandler(),
        # logging.FileHandler("fastagain.log")  # –í –ø—Ä–æ–¥–∞–∫—à–µ–Ω–µ
    ]
)
logger = logging.getLogger(__name__)

@asynccontextmanager
async def lifespan(app: FastAPI):
    """
    Lifespan –∫–æ–Ω—Ç–µ–∫—Å—Ç –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∂–∏–∑–Ω–µ–Ω–Ω—ã–º —Ü–∏–∫–ª–æ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è.
    """
    logger.info("Starting FastAgain application...")
    
    # –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –ë–î –∏ Redis –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ
    try:
        # –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ Redis
        await redis_client.ping()
        logger.info("Redis connection established")
    except Exception as e:
        logger.error(f"Redis connection failed: {e}")
    
    logger.info("FastAgain application started successfully")
    
    yield
    
    # –û—á–∏—Å—Ç–∫–∞ –ø—Ä–∏ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–∏
    logger.info("Shutting down FastAgain application...")
    await redis_client.close()
    await async_engine.dispose()
    logger.info("FastAgain application shutdown complete")

# –°–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è FastAPI
app = FastAPI(
    title=settings.PROJECT_NAME,
    version="1.0.0",
    description="FastAgain - Trust-Based Mutual Aid System on TRON Blockchain",
    openapi_url=f"{settings.API_V1_STR}/openapi.json",
    docs_url="/docs",
    redoc_url="/redoc",
    lifespan=lifespan,
)

# –ù–∞—Å—Ç—Ä–æ–π–∫–∞ CORS
app.add_middleware(
    CORSMiddleware,
    allow_origins=settings.BACKEND_CORS_ORIGINS,
    allow_credentials=True,
    allow_methods=["GET", "POST", "PUT", "DELETE", "OPTIONS", "PATCH"],
    allow_headers=["*"],
    expose_headers=["X-User-Id", "X-Referral-Code", "X-Total-Count"],
)

# –ó–∞—â–∏—Ç–∞ –æ—Ç –ø–æ–¥–¥–µ–ª–∫–∏ —Ö–æ—Å—Ç–∞
app.add_middleware(
    TrustedHostMiddleware,
    allowed_hosts=["localhost", "127.0.0.1", "0.0.0.0", "fastagain.io"] + (settings.allowed_hosts if hasattr(settings, 'allowed_hosts') else [])
)

# –°–∂–∞—Ç–∏–µ GZip –¥–ª—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
app.add_middleware(GZipMiddleware, minimum_size=1000)

# Middleware –¥–ª—è –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è –∑–∞–ø—Ä–æ—Å–æ–≤
@app.middleware("http")
async def log_requests(request: Request, call_next):
    start_time = time.time()
    
    # –ü—Ä–æ–ø—É—Å–∫–∞–µ–º health checks –∏–∑ –ª–æ–≥–æ–≤
    if request.url.path not in ["/health", "/api/v1/health", "/docs", "/redoc", "/openapi.json"]:
        logger.info(f"Request: {request.method} {request.url.path}")
    
    try:
        response = await call_next(request)
        process_time = time.time() - start_time
        
        # –õ–æ–≥–∏—Ä—É–µ–º –º–µ–¥–ª–µ–Ω–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã
        if process_time > 1.0:  # –ë–æ–ª–µ–µ 1 —Å–µ–∫—É–Ω–¥—ã
            logger.warning(f"Slow request: {request.method} {request.url.path} took {process_time:.2f}s")
        
        response.headers["X-Process-Time"] = str(process_time)
        return response
        
    except Exception as e:
        process_time = time.time() - start_time
        logger.error(f"Request error: {request.method} {request.url.path} - {e} ({process_time:.2f}s)")
        raise

# –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –æ—à–∏–±–æ–∫ –≤–∞–ª–∏–¥–∞—Ü–∏–∏
@app.exception_handler(RequestValidationError)
async def validation_exception_handler(request: Request, exc: RequestValidationError):
    logger.warning(f"Validation error: {exc.errors()}")
    return JSONResponse(
        status_code=status.HTTP_422_UNPROCESSABLE_ENTITY,
        content={
            "detail": exc.errors(),
            "body": exc.body
        },
    )

# –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –æ–±—â–∏—Ö –∏—Å–∫–ª—é—á–µ–Ω–∏–π
@app.exception_handler(Exception)
async def general_exception_handler(request: Request, exc: Exception):
    logger.error(f"Unhandled exception: {exc}", exc_info=True)
    return JSONResponse(
        status_code=status.HTTP_500_INTERNAL_SERVER_ERROR,
        content={
            "detail": "Internal server error",
            "message": str(exc) if settings.debug else "Please contact support"
        },
    )

# –ö–∞—Å—Ç–æ–º–Ω–∞—è OpenAPI —Å—Ö–µ–º–∞
def custom_openapi():
    if app.openapi_schema:
        return app.openapi_schema
    
    openapi_schema = get_openapi(
        title=app.title,
        version=app.version,
        description=app.description,
        routes=app.routes,
    )
    
    # –î–æ–±–∞–≤–ª—è–µ–º security —Å—Ö–µ–º—ã
    openapi_schema["components"]["securitySchemes"] = {
        "BearerAuth": {
            "type": "http",
            "scheme": "bearer",
            "bearerFormat": "JWT",
            "description": "Enter JWT token in format: Bearer <token>"
        }
    }
    
    # –ì–ª–æ–±–∞–ª—å–Ω–∞—è security
    openapi_schema["security"] = [{"BearerAuth": []}]
    
    app.openapi_schema = openapi_schema
    return app.openapi_schema

app.openapi = custom_openapi

# –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ —Ä–æ—É—Ç–µ—Ä–æ–≤
app.include_router(api_router, prefix=settings.API_V1_STR)

# –ö–æ—Ä–Ω–µ–≤–æ–π —ç–Ω–¥–ø–æ–∏–Ω—Ç
@app.get("/")
async def root():
    return {
        "message": "Welcome to FastAgain API",
        "version": "1.0.0",
        "docs": "/docs",
        "health": "/api/v1/health",
        "openapi": "/api/v1/openapi.json"
    }

# Health check —ç–Ω–¥–ø–æ–∏–Ω—Ç
@app.get("/health")
async def health_check():
    return {
        "status": "ok",
        "service": "FastAgain API",
        "timestamp": time.time(),
        "version": "1.0.0"
    }

# –≠–Ω–¥–ø–æ–∏–Ω—Ç –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ (—Ç–æ–ª—å–∫–æ –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏)
@app.get("/config-check")
async def config_check():
    # –ù–∏–∫–æ–≥–¥–∞ –Ω–µ –ø–æ–∫–∞–∑—ã–≤–∞–µ–º —Å–µ–∫—Ä–µ—Ç–Ω—ã–µ –∫–ª—é—á–∏ –≤ –ø—Ä–æ–¥–∞–∫—à–µ–Ω–µ
    safe_config = {
        "project_name": settings.PROJECT_NAME,
        "api_version": settings.API_V1_STR,
        "database_configured": bool(settings.DATABASE_URL),
        "redis_configured": bool(settings.REDIS_URL),
        "cors_origins": settings.BACKEND_CORS_ORIGINS,
        "debug_mode": settings.debug if hasattr(settings, 'debug') else False,
        "environment": settings.environment if hasattr(settings, 'environment') else "development"
    }
    return safe_config
```

### 2. **–§—Ä–æ–Ω—Ç–µ–Ω–¥ (React/TypeScript) - `fastagain-frontend/`**:

#### a) **–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è Tailwind (`tailwind.config.js`)** - **–ò–°–ü–†–ê–í–õ–ï–ù–ê (–ø–æ–ª–Ω–æ–µ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ –¢–ó)**
```javascript
/** @type {import('tailwindcss').Config} */
export default {
  content: [
    "./index.html",
    "./src/**/*.{js,ts,jsx,tsx}",
  ],
  theme: {
    extend: {
      colors: {
        // Primary - –¥–æ–≤–µ—Ä–∏–µ (–ø–æ–ª–Ω–æ–µ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ –¢–ó —Ä–∞–∑–¥–µ–ª—É 1.2.1)
        'primary': {
          50: '#f0f8ff',
          100: '#e0f0ff',
          200: '#b8daff',
          300: '#8ac2ff',
          400: '#5ca9ff',
          500: '#0a7aff',  // –û—Å–Ω–æ–≤–Ω–æ–π —Å–∏–Ω–∏–π –∏–∑ –¢–ó
          600: '#0062d6',
          700: '#004ba3',
          800: '#003580',
          900: '#00255d',
        },
        // Neutrals - —á–∏—Å—Ç–æ—Ç–∞
        'gray': {
          50: '#f9fafb',
          100: '#f3f4f6',
          200: '#e5e7eb',
          300: '#d1d5db',
          400: '#9ca3af',
          500: '#6b7280',
          600: '#4b5563',
          700: '#374151',
          800: '#1f2937',
          900: '#111827',
        },
        // Functional colors from TZ
        'success': '#10b981',
        'warning': '#f59e0b',
        'error': '#ef4444',
        'info': '#3b82f6',
      },
      fontFamily: {
        'sans': ['Inter', '-apple-system', 'BlinkMacSystemFont', 'Segoe UI', 'Roboto', 'sans-serif'],
      },
      fontSize: {
        // Mobile First –∏–∑ –¢–ó —Ä–∞–∑–¥–µ–ª–∞ 1.2.2
        'xs': '0.75rem',      // 12px
        'sm': '0.875rem',     // 14px
        'base': '1rem',       // 16px
        'lg': '1.125rem',     // 18px
        'xl': '1.25rem',      // 20px
        '2xl': '1.5rem',      // 24px
        '3xl': '1.875rem',    // 30px
        '4xl': '2.25rem',     // 36px
        '5xl': '3rem',        // 48px
      },
      spacing: {
        '18': '4.5rem',
        '88': '22rem',
        '128': '32rem',
      },
      animation: {
        'fade-in': 'fadeIn 0.5s ease-in-out',
        'slide-up': 'slideUp 0.3s ease-out',
        'pulse-slow': 'pulse 3s cubic-bezier(0.4, 0, 0.6, 1) infinite',
        'spin-slow': 'spin 3s linear infinite',
      },
      keyframes: {
        fadeIn: {
          '0%': { opacity: '0' },
          '100%': { opacity: '1' },
        },
        slideUp: {
          '0%': { transform: 'translateY(10px)', opacity: '0' },
          '100%': { transform: 'translateY(0)', opacity: '1' },
        },
      },
      borderRadius: {
        'xl': '0.75rem',
        '2xl': '1rem',
        '3xl': '1.5rem',
      },
      boxShadow: {
        'soft': '0 2px 15px -3px rgba(0, 0, 0, 0.07), 0 10px 20px -2px rgba(0, 0, 0, 0.04)',
        'hard': '0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04)',
      },
    },
  },
  plugins: [],
}
```

#### b) **–ì–ª–æ–±–∞–ª—å–Ω—ã–µ —Å—Ç–∏–ª–∏ (`src/styles/globals.css`)** - **–ü–û–õ–ù–û–°–¢–¨–Æ –ò–°–ü–†–ê–í–õ–ï–ù–´**
```css
@import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap');
@tailwind base;
@tailwind components;
@tailwind utilities;

@layer base {
  :root {
    /* Content padding –∏–∑ –¢–ó —Ä–∞–∑–¥–µ–ª–∞ 1.1.2 */
    --content-padding: 16px;
  }

  /* Mobile First (–¢–ó —Ä–∞–∑–¥–µ–ª 1.2.2) */
  :root {
    --text-xs: 0.75rem;   /* 12px */
    --text-sm: 0.875rem;  /* 14px */
    --text-base: 1rem;    /* 16px */
    --text-lg: 1.125rem;  /* 18px */
    --text-xl: 1.25rem;   /* 20px */
    --text-2xl: 1.5rem;   /* 24px */
    --text-3xl: 1.875rem; /* 30px */
  }

  /* Tablet (–¢–ó —Ä–∞–∑–¥–µ–ª 1.1.2) */
  @media (min-width: 768px) {
    :root {
      --content-padding: 24px;
      --text-xl: 1.5rem;
      --text-2xl: 1.875rem;
      --text-3xl: 2.25rem;
    }
  }

  /* Desktop (–¢–ó —Ä–∞–∑–¥–µ–ª 1.1.2) */
  @media (min-width: 1024px) {
    :root {
      --content-padding: 32px;
      --sidebar-width: 280px;
      --text-xl: 1.75rem;
      --text-2xl: 2.25rem;
      --text-3xl: 3rem;
    }
  }

  html {
    font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
    -webkit-font-smoothing: antialiased;
    -moz-osx-font-smoothing: grayscale;
    font-feature-settings: 'ss01', 'ss02', 'cv01', 'cv02';
  }

  body {
    @apply bg-gray-50 text-gray-900 antialiased;
  }

  /* –£–ª—É—á—à–µ–Ω–∏–µ –≤—ã–¥–µ–ª–µ–Ω–∏—è —Ç–µ–∫—Å—Ç–∞ */
  ::selection {
    @apply bg-primary-200 text-gray-900;
  }

  /* –£–ª—É—á—à–µ–Ω–∏–µ —Å–∫—Ä–æ–ª–ª–±–∞—Ä–∞ */
  ::-webkit-scrollbar {
    width: 10px;
    height: 10px;
  }

  ::-webkit-scrollbar-track {
    @apply bg-gray-100;
  }

  ::-webkit-scrollbar-thumb {
    @apply bg-gray-300 rounded-full;
  }

  ::-webkit-scrollbar-thumb:hover {
    @apply bg-gray-400;
  }
}

@layer components {
  /* –ö–Ω–æ–ø–∫–∏ —Å —Å–æ—Å—Ç–æ—è–Ω–∏—è–º–∏ –∏–∑ –¢–ó —Ä–∞–∑–¥–µ–ª–∞ 1.3.1 */
  .btn {
    @apply inline-flex items-center justify-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-lg transition-all duration-200 focus:outline-none focus:ring-2 focus:ring-offset-2 disabled:opacity-50 disabled:cursor-not-allowed;
  }

  .btn-primary {
    @apply btn bg-primary-500 text-white hover:bg-primary-600 hover:shadow-xl hover:-translate-y-0.5 focus:ring-primary-500 active:bg-primary-700 active:scale-[0.98] active:shadow-md;
  }

  .btn-secondary {
    @apply btn bg-gray-200 text-gray-900 hover:bg-gray-300 focus:ring-gray-500 hover:shadow-lg;
  }

  .btn-outline {
    @apply btn border border-gray-300 bg-transparent text-gray-700 hover:bg-gray-50 focus:ring-gray-500;
  }

  .btn-danger {
    @apply btn bg-red-600 text-white hover:bg-red-700 focus:ring-red-500;
  }

  .btn-success {
    @apply btn bg-success text-white hover:bg-emerald-600 focus:ring-emerald-500;
  }

  /* –ü–æ–ª—è –≤–≤–æ–¥–∞ –∏–∑ –¢–ó —Ä–∞–∑–¥–µ–ª–∞ 1.3.4 */
  .input-field {
    @apply mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-primary-500 focus:border-primary-500 sm:text-sm transition-colors duration-200;
  }

  .input-field-error {
    @apply border-red-300 text-red-900 placeholder-red-300 focus:ring-red-500 focus:border-red-500;
  }

  .input-field-success {
    @apply border-success text-success placeholder-success focus:ring-success focus:border-success;
  }

  /* –ö–∞—Ä—Ç–æ—á–∫–∏ –∏–∑ –¢–ó —Ä–∞–∑–¥–µ–ª–∞ 1.3.2 */
  .card {
    @apply bg-white rounded-xl p-6 shadow-soft hover:shadow-hard transition-shadow duration-300;
  }

  .card-hover {
    @apply card hover:-translate-y-1 hover:shadow-hard;
  }

  /* –¢–∞–π–º–µ—Ä—ã –∏ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä—ã –ø—Ä–æ–≥—Ä–µ—Å—Å–∞ –∏–∑ –¢–ó —Ä–∞–∑–¥–µ–ª–∞ 1.3.3 */
  .circular-progress {
    @apply relative w-16 h-16 rounded-full;
  }

  .linear-progress {
    @apply h-2 bg-gray-200 rounded-full overflow-hidden;
  }

  .progress-bar {
    @apply h-full bg-primary-500 transition-all duration-500 ease-out;
  }

  /* –ë–µ–π–¥–∂–∏ —Å—Ç–∞—Ç—É—Å–æ–≤ */
  .badge {
    @apply inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium;
  }

  .badge-success {
    @apply badge bg-green-100 text-green-800;
  }

  .badge-warning {
    @apply badge bg-yellow-100 text-yellow-800;
  }

  .badge-error {
    @apply badge bg-red-100 text-red-800;
  }

  .badge-info {
    @apply badge bg-blue-100 text-blue-800;
  }

  /* –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è */
  .toast {
    @apply max-w-sm w-full bg-white shadow-hard rounded-lg pointer-events-auto;
  }

  /* –ó–∞–≥—Ä—É–∑—á–∏–∫–∏ */
  .spinner {
    @apply animate-spin rounded-full border-2 border-gray-300 border-t-primary-500;
  }
}

@layer utilities {
  /* –ê–Ω–∏–º–∞—Ü–∏–∏ –¥–ª—è Trust Flow */
  .animate-trust-flow {
    animation: trustFlow 2s ease-in-out infinite;
  }

  @keyframes trustFlow {
    0%, 100% { opacity: 0.7; transform: scale(1); }
    50% { opacity: 1; transform: scale(1.05); }
  }

  /* –ì—Ä–∞–¥–∏–µ–Ω—Ç—ã */
  .bg-gradient-trust {
    @apply bg-gradient-to-br from-primary-50 via-white to-primary-100;
  }

  .bg-gradient-card {
    @apply bg-gradient-to-br from-white to-gray-50;
  }

  /* –¢–µ–∫—Å—Ç —Å –≥—Ä–∞–¥–∏–µ–Ω—Ç–æ–º */
  .text-gradient-primary {
    @apply bg-gradient-to-r from-primary-600 to-primary-400 bg-clip-text text-transparent;
  }

  /* –°–∫—Ä—ã—Ç–∏–µ —ç–ª–µ–º–µ–Ω—Ç–æ–≤ */
  .visually-hidden {
    @apply absolute w-px h-px p-0 -m-px overflow-hidden whitespace-nowrap border-0;
  }

  /* –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä —Å –æ—Ç—Å—Ç—É–ø–∞–º–∏ –∏–∑ –¢–ó */
  .content-container {
    @apply px-[var(--content-padding)] max-w-7xl mx-auto;
  }

  /* –ê–¥–∞–ø—Ç–∏–≤–Ω–∞—è —Ç–∏–ø–æ–≥—Ä–∞—Ñ–∏–∫–∞ */
  .text-mobile-xl {
    font-size: var(--text-xl);
  }

  .text-mobile-2xl {
    font-size: var(--text-2xl);
  }

  .text-mobile-3xl {
    font-size: var(--text-3xl);
  }
}

/* –ê–Ω–∏–º–∞—Ü–∏–∏ –¥–ª—è Framer Motion */
.fade-in-enter {
  opacity: 0;
}

.fade-in-enter-active {
  opacity: 1;
  transition: opacity 300ms ease-in;
}

.fade-in-exit {
  opacity: 1;
}

.fade-in-exit-active {
  opacity: 0;
  transition: opacity 300ms ease-out;
}

/* –ö–∞—Å—Ç–æ–º–Ω—ã–µ —Å—Ç–∏–ª–∏ –¥–ª—è QR —Å–∫–∞–Ω–µ—Ä–∞ */
.qr-scanner-overlay {
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  z-index: 10;
}

.qr-scanner-frame {
  border: 3px solid theme('colors.primary.500');
  border-radius: 12px;
  animation: pulse-scan 2s ease-in-out infinite;
}

@keyframes pulse-scan {
  0%, 100% { border-color: theme('colors.primary.500'); }
  50% { border-color: theme('colors.primary.300'); }
}

/* –°—Ç–∏–ª–∏ –¥–ª—è –∫–æ—à–µ–ª—å–∫–∞ */
.wallet-address-mask::before {
  content: 'T';
  @apply font-mono;
}

/* –ê–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç—å –¥–ª—è –º–æ–±–∏–ª—å–Ω—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤ */
@media (max-width: 640px) {
  .mobile-stack {
    @apply flex flex-col space-y-4;
  }

  .mobile-full {
    @apply w-full;
  }

  .mobile-text-center {
    @apply text-center;
  }
}

/* –ü–µ—á–∞—Ç—å —Å—Ç–∏–ª–µ–π */
@media print {
  .no-print {
    display: none !important;
  }

  .print-only {
    display: block !important;
  }
}
```

#### c) **API —Å–µ—Ä–≤–∏—Å (`src/services/api.ts`)** - **–ü–û–õ–ù–û–°–¢–¨–Æ –ü–ï–†–ï–†–ê–ë–û–¢–ê–ù**
```typescript
import axios, { AxiosInstance, AxiosRequestConfig, AxiosResponse, AxiosError } from 'axios';
import { toast } from 'react-hot-toast';

const API_BASE_URL = import.meta.env.VITE_API_URL || 'http://localhost:8000/api/v1';

// –¢–∏–ø—ã –¥–ª—è –æ—Ç–≤–µ—Ç–æ–≤ API
export interface ApiResponse<T = any> {
  data: T;
  message?: string;
  status: string;
  timestamp?: number;
}

export interface ApiError {
  detail: string | Array<{ loc: string[]; msg: string; type: string }>;
  message?: string;
  status_code: number;
}

export interface PaginatedResponse<T> {
  items: T[];
  total: number;
  page: number;
  size: number;
  pages: number;
}

// –ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å –¥–ª—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –∑–∞–ø—Ä–æ—Å–æ–≤
export interface RequestConfig extends AxiosRequestConfig {
  skipAuth?: boolean;
  showToast?: boolean;
  toastSuccessMessage?: string;
  toastErrorMessage?: string;
}

class ApiService {
  private static instance: ApiService;
  private axiosInstance: AxiosInstance;
  private token: string | null = null;
  private refreshPromise: Promise<string> | null = null;

  private constructor() {
    this.axiosInstance = axios.create({
      baseURL: API_BASE_URL,
      timeout: 30000, // 30 —Å–µ–∫—É–Ω–¥
      headers: {
        'Content-Type': 'application/json',
        'Accept': 'application/json',
      },
    });

    // –ò–Ω—Ç–µ—Ä—Ü–µ–ø—Ç–æ—Ä –∑–∞–ø—Ä–æ—Å–æ–≤ –¥–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è —Ç–æ–∫–µ–Ω–∞
    this.axiosInstance.interceptors.request.use(
      (config: any) => {
        const requestConfig = config as RequestConfig;
        
        // –ü—Ä–æ–ø—É—Å–∫–∞–µ–º –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—é –µ—Å–ª–∏ skipAuth = true
        if (!requestConfig.skipAuth) {
          const token = this.getToken();
          if (token) {
            config.headers.Authorization = `Bearer ${token}`;
          }
        }

        // –î–æ–±–∞–≤–ª—è–µ–º –∑–∞–≥–æ–ª–æ–≤–∫–∏ –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è
        config.headers['X-Client-Version'] = '1.0.0';
        config.headers['X-Platform'] = 'web';

        return config;
      },
      (error) => {
        console.error('Request interceptor error:', error);
        return Promise.reject(error);
      }
    );

    // –ò–Ω—Ç–µ—Ä—Ü–µ–ø—Ç–æ—Ä –æ—Ç–≤–µ—Ç–æ–≤ –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –æ—à–∏–±–æ–∫
    this.axiosInstance.interceptors.response.use(
      (response: AxiosResponse<ApiResponse>) => {
        // –û–±—Ä–∞–±–æ—Ç–∫–∞ —É—Å–ø–µ—à–Ω—ã—Ö –æ—Ç–≤–µ—Ç–æ–≤
        const config = response.config as RequestConfig;
        
        if (config.showToast && config.toastSuccessMessage) {
          toast.success(config.toastSuccessMessage);
        } else if (config.showToast && response.data.message) {
          toast.success(response.data.message);
        }

        return response;
      },
      async (error: AxiosError<ApiError>) => {
        const originalRequest = error.config as RequestConfig & { _retry?: boolean };
        
        // –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–∫–∏ 401 (Unauthorized)
        if (error.response?.status === 401 && !originalRequest._retry) {
          originalRequest._retry = true;
          
          try {
            const newToken = await this.refreshAccessToken();
            if (newToken) {
              this.setToken(newToken);
              originalRequest.headers!.Authorization = `Bearer ${newToken}`;
              return this.axiosInstance(originalRequest);
            }
          } catch (refreshError) {
            console.error('Token refresh failed:', refreshError);
            this.clearToken();
            window.location.href = '/login?session_expired=true';
            return Promise.reject(refreshError);
          }
        }

        // –û–±—Ä–∞–±–æ—Ç–∫–∞ –¥—Ä—É–≥–∏—Ö –æ—à–∏–±–æ–∫
        const config = originalRequest as RequestConfig;
        const errorMessage = this.getErrorMessage(error);

        if (config.showToast && config.toastErrorMessage) {
          toast.error(config.toastErrorMessage);
        } else if (config.showToast && errorMessage) {
          toast.error(errorMessage);
        }

        // –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –æ—à–∏–±–æ–∫
        if (error.response?.status !== 401) {
          console.error('API Error:', {
            url: originalRequest.url,
            method: originalRequest.method,
            status: error.response?.status,
            error: errorMessage,
          });
        }

        return Promise.reject(error);
      }
    );
  }

  static getInstance(): ApiService {
    if (!ApiService.instance) {
      ApiService.instance = new ApiService();
    }
    return ApiService.instance;
  }

  // –ü–æ–ª—É—á–µ–Ω–∏–µ –ø–æ–Ω—è—Ç–Ω–æ–≥–æ —Å–æ–æ–±—â–µ–Ω–∏—è –æ–± –æ—à–∏–±–∫–µ
  private getErrorMessage(error: AxiosError<ApiError>): string {
    if (error.response?.data?.detail) {
      if (typeof error.response.data.detail === 'string') {
        return error.response.data.detail;
      } else if (Array.isArray(error.response.data.detail)) {
        return error.response.data.detail
          .map((err: any) => `${err.loc.join('.')}: ${err.msg}`)
          .join(', ');
      }
    }
    return error.message || 'An unknown error occurred';
  }

  // –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ç–æ–∫–µ–Ω–∞–º–∏
  setToken(token: string): void {
    this.token = token;
    localStorage.setItem('access_token', token);
    
    // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –∑–∞–≥–æ–ª–æ–≤–æ–∫ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
    this.axiosInstance.defaults.headers.common['Authorization'] = `Bearer ${token}`;
  }

  getToken(): string | null {
    if (!this.token) {
      this.token = localStorage.getItem('access_token');
    }
    return this.token;
  }

  clearToken(): void {
    this.token = null;
    localStorage.removeItem('access_token');
    localStorage.removeItem('refresh_token');
    delete this.axiosInstance.defaults.headers.common['Authorization'];
  }

  // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ access token
  private async refreshAccessToken(): Promise<string> {
    // –ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ–º –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã –Ω–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ
    if (this.refreshPromise) {
      return this.refreshPromise;
    }

    const refreshToken = localStorage.getItem('refresh_token');
    if (!refreshToken) {
      throw new Error('No refresh token available');
    }

    this.refreshPromise = new Promise(async (resolve, reject) => {
      try {
        const response = await axios.post<ApiResponse<{ access_token: string }>>(
          `${API_BASE_URL}/auth/refresh`,
          { refresh_token: refreshToken },
          { skipAuth: true } as any
        );

        const newAccessToken = response.data.data.access_token;
        this.setToken(newAccessToken);
        resolve(newAccessToken);
      } catch (error) {
        reject(error);
      } finally {
        this.refreshPromise = null;
      }
    });

    return this.refreshPromise;
  }

  // –ë–∞–∑–æ–≤—ã–µ –º–µ—Ç–æ–¥—ã HTTP
  async get<T = any>(url: string, config?: RequestConfig): Promise<T> {
    const response: AxiosResponse<ApiResponse<T>> = await this.axiosInstance.get(url, config);
    return response.data.data;
  }

  async post<T = any>(url: string, data?: any, config?: RequestConfig): Promise<T> {
    const response: AxiosResponse<ApiResponse<T>> = await this.axiosInstance.post(url, data, config);
    return response.data.data;
  }

  async put<T = any>(url: string, data?: any, config?: RequestConfig): Promise<T> {
    const response: AxiosResponse<ApiResponse<T>> = await this.axiosInstance.put(url, data, config);
    return response.data.data;
  }

  async patch<T = any>(url: string, data?: any, config?: RequestConfig): Promise<T> {
    const response: AxiosResponse<ApiResponse<T>> = await this.axiosInstance.patch(url, data, config);
    return response.data.data;
  }

  async delete<T = any>(url: string, config?: RequestConfig): Promise<T> {
    const response: AxiosResponse<ApiResponse<T>> = await this.axiosInstance.delete(url, config);
    return response.data.data;
  }

  // –°–ø–µ—Ü–∏—Ñ–∏—á–Ω—ã–µ –º–µ—Ç–æ–¥—ã API –¥–ª—è FastAgain
  async register(email: string, password: string, confirmPassword: string, referralCode?: string) {
    return this.post<{
      id: number;
      email: string;
      referral_code: string;
      access_token: string;
      refresh_token: string;
    }>('/auth/register', {
      email,
      password,
      confirm_password: confirmPassword,
      referral_code: referralCode,
    }, {
      showToast: true,
      toastSuccessMessage: 'Registration successful!',
      skipAuth: true,
    });
  }

  async login(email: string, password: string) {
    const formData = new FormData();
    formData.append('username', email);
    formData.append('password', password);
    
    const response = await this.axiosInstance.post<ApiResponse<{
      access_token: string;
      refresh_token: string;
      token_type: string;
      expires_in: number;
      user_id: number;
    }>>('/auth/login', formData, {
      headers: {
        'Content-Type': 'application/x-www-form-urlencoded',
      },
      skipAuth: true,
    } as any);

    const data = response.data.data;
    this.setToken(data.access_token);
    localStorage.setItem('refresh_token', data.refresh_token);

    return data;
  }

  async logout() {
    try {
      const refreshToken = localStorage.getItem('refresh_token');
      await this.post('/auth/logout', { refresh_token: refreshToken }, {
        showToast: true,
        toastSuccessMessage: 'Successfully logged out',
      });
    } finally {
      this.clearToken();
    }
  }

  async getCurrentUser() {
    return this.get<{
      id: number;
      email: string;
      referral_code: string;
      main_status: string;
      sub_status: string;
      wallet_address: string | null;
      wallet_status: string | null;
      cycle_number: number;
      total_donated: number;
      total_received: number;
      created_at: string;
      referral_stats?: {
        total_referrals: number;
        active_referrals: number;
        donators: number;
        agents: number;
      };
    }>('/auth/me');
  }

  async validateReferralCode(referralCode: string) {
    return this.post<{
      valid: boolean;
      sponsor_id: number;
      sponsor_email: string;
      sponsor_status: string;
    }>(`/auth/validate-referral/${referralCode}`, {}, {
      skipAuth: true,
    });
  }

  async updateProfile(data: {
    participation_purpose?: string[];
    email_notifications?: boolean;
  }) {
    return this.put<{
      id: number;
      participation_purpose: string[];
      email_notifications: boolean;
    }>('/users/profile', data, {
      showToast: true,
      toastSuccessMessage: 'Profile updated successfully',
    });
  }

  async bindWallet(walletAddress: string) {
    return this.post<{
      success: boolean;
      status: string;
      message?: string;
    }>('/wallet/bind', {
      wallet_address: walletAddress,
    }, {
      showToast: true,
      toastSuccessMessage: 'Wallet successfully bound',
      toastErrorMessage: 'Failed to bind wallet',
    });
  }

  async validateWallet(walletAddress: string) {
    return this.post<{
      valid: boolean;
      is_exchange: boolean;
      is_duplicate: boolean;
      message?: string;
    }>('/wallet/validate', {
      wallet_address: walletAddress,
    }, {
      skipAuth: true,
    });
  }

  async getActiveCycle() {
    return this.get<{
      id: number;
      status: string;
      current_step: number;
      expires_at: string | null;
      started_at: string | null;
    }>('/cycles/active');
  }

  async startCycle() {
    return this.post<{
      cycle_id: number;
      expires_at: string;
      recipients: Array<{
        level: number;
        wallet_address: string;
        type: 'user' | 'project';
        name?: string;
      }>;
    }>('/cycles/start', {}, {
      showToast: true,
      toastSuccessMessage: 'Cycle started successfully',
      toastErrorMessage: 'Failed to start cycle',
    });
  }

  async getTransactionHistory(page = 1, limit = 20) {
    return this.get<PaginatedResponse<{
      id: number;
      status: string;
      amount: number;
      recipient_wallet: string;
      recipient_name?: string;
      transaction_hash: string | null;
      created_at: string;
      confirmed_at: string | null;
    }>>(`/transactions/history?page=${page}&limit=${limit}`);
  }

  // –í—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ –º–µ—Ç–æ–¥—ã
  async healthCheck(): Promise<boolean> {
    try {
      const response = await this.axiosInstance.get<ApiResponse>('/health', {
        skipAuth: true,
        timeout: 5000,
      } as any);
      return response.data.status === 'ok';
    } catch (error) {
      console.error('Health check failed:', error);
      return false;
    }
  }

  // –û—Ç–º–µ–Ω–∞ –∑–∞–ø—Ä–æ—Å–æ–≤
  getCancelTokenSource() {
    return axios.CancelToken.source();
  }
}

export const api = ApiService.getInstance();
export type { RequestConfig };
```

#### d) **–•—É–∫ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ (`src/hooks/useAuth.ts`)** - **–°–û–ó–î–ê–ù –° –î–û–ü–û–õ–ù–ï–ù–ò–Ø–ú–ò**
```typescript
import { useState, useEffect, useCallback, useRef } from 'react';
import { useNavigate, useLocation } from 'react-router-dom';
import { api } from '@/services/api';
import { toast } from 'react-hot-toast';

// –¢–∏–ø—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
export interface User {
  id: number;
  email: string;
  referral_code: string;
  main_status: string;
  sub_status: string;
  wallet_address: string | null;
  wallet_status: string | null;
  cycle_number: number;
  is_active: boolean;
  email_verified: boolean;
  total_donated: number;
  total_received: number;
  participation_purpose: string[] | null;
  created_at: string;
  last_active_at?: string;
  referral_stats?: {
    total_referrals: number;
    active_referrals: number;
    donators: number;
    agents: number;
  };
}

export interface AuthState {
  user: User | null;
  isLoading: boolean;
  isAuthenticated: boolean;
  error: string | null;
}

export interface UseAuthReturn extends AuthState {
  login: (email: string, password: string) => Promise<void>;
  register: (email: string, password: string, confirmPassword: string, referralCode?: string) => Promise<void>;
  logout: () => Promise<void>;
  refreshUser: () => Promise<void>;
  updateProfile: (data: { participation_purpose?: string[]; email_notifications?: boolean }) => Promise<void>;
  validateReferralCode: (code: string) => Promise<boolean>;
}

// Protected route –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
export interface ProtectedRouteConfig {
  requireAuth?: boolean;
  requireWallet?: boolean;
  requireActiveStatus?: boolean;
  redirectTo?: string;
}

export const useAuth = (): UseAuthReturn => {
  const navigate = useNavigate();
  const location = useLocation();
  const [state, setState] = useState<AuthState>({
    user: null,
    isLoading: true,
    isAuthenticated: false,
    error: null,
  });

  const refreshIntervalRef = useRef<NodeJS.Timeout>();

  // –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ç–æ–∫–µ–Ω–∞ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
  useEffect(() => {
    const checkAuth = async () => {
      const token = api.getToken();
      if (token) {
        try {
          const userData = await api.getCurrentUser();
          setState({
            user: userData,
            isLoading: false,
            isAuthenticated: true,
            error: null,
          });
          
          // –ó–∞–ø—É—Å–∫–∞–µ–º –ø–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
          startAutoRefresh();
        } catch (error) {
          console.error('Auth check failed:', error);
          api.clearToken();
          setState({
            user: null,
            isLoading: false,
            isAuthenticated: false,
            error: 'Session expired. Please login again.',
          });
        }
      } else {
        setState({
          user: null,
          isLoading: false,
          isAuthenticated: false,
          error: null,
        });
      }
    };

    checkAuth();

    // –û—á–∏—Å—Ç–∫–∞ –∏–Ω—Ç–µ—Ä–≤–∞–ª–∞ –ø—Ä–∏ —Ä–∞–∑–º–æ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏–∏
    return () => {
      if (refreshIntervalRef.current) {
        clearInterval(refreshIntervalRef.current);
      }
    };
  }, []);

  // –ê–≤—Ç–æ-–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
  const startAutoRefresh = () => {
    if (refreshIntervalRef.current) {
      clearInterval(refreshIntervalRef.current);
    }

    refreshIntervalRef.current = setInterval(async () => {
      try {
        const userData = await api.getCurrentUser();
        setState(prev => ({
          ...prev,
          user: userData,
        }));
      } catch (error) {
        console.warn('Auto refresh failed:', error);
      }
    }, 300000); // –ö–∞–∂–¥—ã–µ 5 –º–∏–Ω—É—Ç
  };

  const login = useCallback(async (email: string, password: string) => {
    setState(prev => ({ ...prev, isLoading: true, error: null }));
    
    try {
      const tokens = await api.login(email, password);
      
      // –ü–æ–ª—É—á–∞–µ–º –¥–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
      const userData = await api.getCurrentUser();
      
      setState({
        user: userData,
        isLoading: false,
        isAuthenticated: true,
        error: null,
      });
      
      toast.success('Login successful!');
      
      // –ó–∞–ø—É—Å–∫–∞–µ–º –∞–≤—Ç–æ-–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ
      startAutoRefresh();
      
      // –†–µ–¥–∏—Ä–µ–∫—Ç –Ω–∞ –ø—Ä–µ–¥—ã–¥—É—â—É—é —Å—Ç—Ä–∞–Ω–∏—Ü—É –∏–ª–∏ –¥–æ–º–∞—à–Ω—é—é
      const from = location.state?.from?.pathname || '/dashboard';
      navigate(from, { replace: true });
    } catch (error: any) {
      let errorMessage = 'Login failed';
      
      if (error.response?.data?.detail) {
        errorMessage = typeof error.response.data.detail === 'string'
          ? error.response.data.detail
          : 'Invalid credentials';
      }
      
      setState(prev => ({
        ...prev,
        isLoading: false,
        error: errorMessage,
      }));
      
      toast.error(errorMessage);
      throw error;
    }
  }, [navigate, location]);

  const register = useCallback(async (
    email: string, 
    password: string, 
    confirmPassword: string, 
    referralCode?: string
  ) => {
    setState(prev => ({ ...prev, isLoading: true, error: null }));
    
    try {
      const result = await api.register(email, password, confirmPassword, referralCode);
      
      // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Ç–æ–∫–µ–Ω—ã
      api.setToken(result.access_token);
      localStorage.setItem('refresh_token', result.refresh_token);
      
      // –ü–æ–ª—É—á–∞–µ–º –¥–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
      const userData = await api.getCurrentUser();
      
      setState({
        user: userData,
        isLoading: false,
        isAuthenticated: true,
        error: null,
      });
      
      // –ó–∞–ø—É—Å–∫–∞–µ–º –∞–≤—Ç–æ-–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ
      startAutoRefresh();
      
      // –†–µ–¥–∏—Ä–µ–∫—Ç –Ω–∞ –æ–Ω–±–æ—Ä–¥–∏–Ω–≥
      navigate('/onboarding', { replace: true });
    } catch (error: any) {
      let errorMessage = 'Registration failed';
      
      if (error.response?.data?.detail) {
        errorMessage = typeof error.response.data.detail === 'string'
          ? error.response.data.detail
          : 'Registration error';
      }
      
      setState(prev => ({
        ...prev,
        isLoading: false,
        error: errorMessage,
      }));
      
      toast.error(errorMessage);
      throw error;
    }
  }, [navigate]);

  const logout = useCallback(async () => {
    setState(prev => ({ ...prev, isLoading: true }));
    
    try {
      await api.logout();
    } catch (error) {
      console.warn('Logout API call failed:', error);
    } finally {
      setState({
        user: null,
        isLoading: false,
        isAuthenticated: false,
        error: null,
      });
      
      // –û—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –∞–≤—Ç–æ-–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ
      if (refreshIntervalRef.current) {
        clearInterval(refreshIntervalRef.current);
      }
      
      // –†–µ–¥–∏—Ä–µ–∫—Ç –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—É –ª–æ–≥–∏–Ω–∞
      navigate('/login', { replace: true });
    }
  }, [navigate]);

  const refreshUser = useCallback(async () => {
    if (!api.getToken()) return;
    
    try {
      const userData = await api.getCurrentUser();
      setState(prev => ({
        ...prev,
        user: userData,
        error: null,
      }));
    } catch (error: any) {
      console.error('Failed to refresh user:', error);
      
      // –ï—Å–ª–∏ –æ—à–∏–±–∫–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏, –¥–µ–ª–∞–µ–º –ª–æ–≥–∞—É—Ç
      if (error.response?.status === 401) {
        await logout();
      } else {
        setState(prev => ({
          ...prev,
          error: 'Failed to refresh user data',
        }));
      }
    }
  }, [logout]);

  const updateProfile = useCallback(async (data: { participation_purpose?: string[]; email_notifications?: boolean }) => {
    try {
      await api.updateProfile(data);
      await refreshUser();
    } catch (error) {
      throw error;
    }
  }, [refreshUser]);

  const validateReferralCode = useCallback(async (code: string): Promise<boolean> => {
    try {
      const result = await api.validateReferralCode(code);
      return result.valid;
    } catch (error) {
      return false;
    }
  }, []);

  // –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏–π –¥–ª—è –∑–∞—â–∏—â–µ–Ω–Ω—ã—Ö —Ä–æ—É—Ç–æ–≤
  const checkRouteRequirements = useCallback((config: ProtectedRouteConfig = {}): boolean => {
    const {
      requireAuth = true,
      requireWallet = false,
      requireActiveStatus = false,
    } = config;

    if (requireAuth && !state.isAuthenticated) {
      return false;
    }

    if (requireWallet && state.user && !state.user.wallet_address) {
      return false;
    }

    if (requireActiveStatus && state.user && state.user.main_status !== 'ACTIVE') {
      return false;
    }

    return true;
  }, [state]);

  return {
    ...state,
    login,
    register,
    logout,
    refreshUser,
    updateProfile,
    validateReferralCode,
  };
};

// –•—É–∫ –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –∑–∞—â–∏—â–µ–Ω–Ω—ã—Ö —Ä–æ—É—Ç–æ–≤
export const useRouteGuard = (config: ProtectedRouteConfig = {}) => {
  const auth = useAuth();
  const navigate = useNavigate();
  const location = useLocation();

  useEffect(() => {
    if (auth.isLoading) return;

    const hasAccess = auth.checkRouteRequirements(config);

    if (!hasAccess) {
      const redirectTo = config.redirectTo || '/login';
      
      // –°–æ—Ö—Ä–∞–Ω—è–µ–º —Ç–µ–∫—É—â–∏–π –ø—É—Ç—å –¥–ª—è —Ä–µ–¥–∏—Ä–µ–∫—Ç–∞ –ø–æ—Å–ª–µ –ª–æ–≥–∏–Ω–∞
      navigate(redirectTo, {
        replace: true,
        state: { from: location.pathname !== redirectTo ? location : undefined }
      });
    }
  }, [auth, config, navigate, location]);

  return { hasAccess: auth.checkRouteRequirements(config), isLoading: auth.isLoading };
};

// –•—É–∫ –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è —Ç–µ–∫—É—â–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (—Å–æ–∫—Ä–∞—â–µ–Ω–Ω–∞—è –≤–µ—Ä—Å–∏—è)
export const useCurrentUser = () => {
  const auth = useAuth();
  return {
    user: auth.user,
    isLoading: auth.isLoading,
    isAuthenticated: auth.isAuthenticated,
  };
};
```

#### e) **–ö–æ–º–ø–æ–Ω–µ–Ω—Ç –∫–Ω–æ–ø–∫–∏ (`src/components/ui/Button/Button.tsx`)** - **–°–û–ó–î–ê–ù –ü–û –ü–û–õ–ù–û–ú–£ –¢–ó**
```tsx
import React, { forwardRef } from 'react';
import { Loader2, LucideIcon } from 'lucide-react';
import { cn } from '@/lib/utils';

export type ButtonVariant = 'primary' | 'secondary' | 'outline' | 'danger' | 'success' | 'ghost';
export type ButtonSize = 'xs' | 'sm' | 'md' | 'lg' | 'xl';
export type ButtonShape = 'default' | 'pill' | 'square' | 'circle';

export interface ButtonProps extends React.ButtonHTMLAttributes<HTMLButtonElement> {
  variant?: ButtonVariant;
  size?: ButtonSize;
  shape?: ButtonShape;
  isLoading?: boolean;
  loadingText?: string;
  fullWidth?: boolean;
  leftIcon?: LucideIcon | React.ReactNode;
  rightIcon?: LucideIcon | React.ReactNode;
  iconOnly?: boolean;
  destructive?: boolean;
  asChild?: boolean;
}

// –°—Ç–∏–ª–∏ –¥–ª—è –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤ (—Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—Ç –¢–ó —Ä–∞–∑–¥–µ–ª—É 1.3.1)
const variantClasses: Record<ButtonVariant, string> = {
  primary: 'btn-primary bg-primary-500 text-white hover:bg-primary-600 focus:ring-primary-500 active:bg-primary-700',
  secondary: 'btn-secondary bg-gray-200 text-gray-900 hover:bg-gray-300 focus:ring-gray-500',
  outline: 'btn-outline border border-gray-300 bg-transparent text-gray-700 hover:bg-gray-50 focus:ring-gray-500',
  danger: 'btn-danger bg-red-600 text-white hover:bg-red-700 focus:ring-red-500',
  success: 'btn-success bg-success text-white hover:bg-emerald-600 focus:ring-emerald-500',
  ghost: 'bg-transparent text-gray-700 hover:bg-gray-100 focus:ring-gray-500 border-transparent',
};

// –°—Ç–∏–ª–∏ –¥–ª—è —Ä–∞–∑–º–µ—Ä–æ–≤
const sizeClasses: Record<ButtonSize, string> = {
  xs: 'px-2 py-1 text-xs',
  sm: 'px-3 py-1.5 text-sm',
  md: 'px-4 py-2 text-sm',
  lg: 'px-6 py-3 text-base',
  xl: 'px-8 py-4 text-lg',
};

// –°—Ç–∏–ª–∏ –¥–ª—è —Ñ–æ—Ä–º
const shapeClasses: Record<ButtonShape, string> = {
  default: 'rounded-md',
  pill: 'rounded-full',
  square: 'rounded-lg',
  circle: 'rounded-full aspect-square p-0',
};

// –†–∞–∑–º–µ—Ä—ã –∏–∫–æ–Ω–æ–∫
const iconSizeClasses: Record<ButtonSize, string> = {
  xs: 'h-3 w-3',
  sm: 'h-4 w-4',
  md: 'h-5 w-5',
  lg: 'h-6 w-6',
  xl: 'h-7 w-7',
};

export const Button = forwardRef<HTMLButtonElement, ButtonProps>(
  (
    {
      children,
      variant = 'primary',
      size = 'md',
      shape = 'default',
      isLoading = false,
      loadingText,
      fullWidth = false,
      leftIcon: LeftIcon,
      rightIcon: RightIcon,
      iconOnly = false,
      destructive = false,
      disabled,
      className,
      type = 'button',
      ...props
    },
    ref
  ) => {
    // –ï—Å–ª–∏ –∫–Ω–æ–ø–∫–∞ —Ç–æ–ª—å–∫–æ —Å –∏–∫–æ–Ω–∫–æ–π
    const isIconOnly = iconOnly || (!children && (LeftIcon || RightIcon));
    
    // –û–ø—Ä–µ–¥–µ–ª—è–µ–º –∫–ª–∞—Å—Å—ã
    const baseClasses = 'btn inline-flex items-center justify-center font-medium transition-all duration-200 focus:outline-none focus:ring-2 focus:ring-offset-2 disabled:opacity-50 disabled:cursor-not-allowed';
    
    const variantClass = variantClasses[variant];
    const sizeClass = isIconOnly ? sizeClasses[size].replace(/px-\d+/, 'px-0').replace(/py-\d+/, 'py-0') : sizeClasses[size];
    const shapeClass = isIconOnly ? 'rounded-full' : shapeClasses[shape];
    const widthClass = fullWidth ? 'w-full' : '';
    const destructiveClass = destructive ? 'ring-2 ring-red-300' : '';
    
    const buttonClasses = cn(
      baseClasses,
      variantClass,
      sizeClass,
      shapeClass,
      widthClass,
      destructiveClass,
      {
        'cursor-wait': isLoading,
        'gap-2': !isIconOnly && (LeftIcon || RightIcon || isLoading),
      },
      className
    );

    // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –¥–ª—è –∏–∫–æ–Ω–æ–∫
    const renderIcon = (Icon: LucideIcon | React.ReactNode, position: 'left' | 'right') => {
      if (!Icon) return null;
      
      const iconClasses = cn(
        iconSizeClasses[size],
        {
          'mr-2': position === 'left' && !isIconOnly,
          'ml-2': position === 'right' && !isIconOnly,
        }
      );
      
      if (React.isValidElement(Icon)) {
        return React.cloneElement(Icon as React.ReactElement<any>, {
          className: cn(iconClasses, (Icon as React.ReactElement<any>).props.className),
        });
      }
      
      // –ï—Å–ª–∏ —ç—Ç–æ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç LucideIcon
      const LucideIcon = Icon as LucideIcon;
      return <LucideIcon className={iconClasses} />;
    };

    return (
      <button
        ref={ref}
        type={type}
        className={buttonClasses}
        disabled={disabled || isLoading}
        aria-busy={isLoading}
        {...props}
      >
        {isLoading && (
          <>
            <Loader2 className={cn(iconSizeClasses[size], 'animate-spin', { 'mr-2': !isIconOnly && loadingText })} />
            {loadingText && <span>{loadingText}</span>}
          </>
        )}
        
        {!isLoading && (
          <>
            {LeftIcon && renderIcon(LeftIcon, 'left')}
            {children && !isIconOnly && <span>{children}</span>}
            {RightIcon && renderIcon(RightIcon, 'right')}
            
            {/* –î–ª—è icon-only –∫–Ω–æ–ø–æ–∫ –±–µ–∑ —Ç–µ–∫—Å—Ç–∞ */}
            {isIconOnly && !children && (LeftIcon || RightIcon) && (
              renderIcon(LeftIcon || RightIcon, 'left')
            )}
          </>
        )}
      </button>
    );
  }
);

Button.displayName = 'Button';

// –≠–∫—Å–ø–æ—Ä—Ç –≤—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤
export const ButtonLoading = ({ size = 'md' }: { size?: ButtonSize }) => (
  <div className="flex items-center justify-center">
    <Loader2 className={cn(iconSizeClasses[size], 'animate-spin text-primary-500')} />
  </div>
);

export const ButtonGroup = ({ children, className }: { children: React.ReactNode; className?: string }) => (
  <div className={cn('flex gap-2', className)}>{children}</div>
);

export default Button;
```

#### f) **–£—Ç–∏–ª–∏—Ç–∞—Ä–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ (`src/lib/utils.ts`)** - **–°–û–ó–î–ê–ù–´**
```typescript
import { type ClassValue, clsx } from 'clsx';
import { twMerge } from 'tailwind-merge';

/**
 * –û–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ –∫–ª–∞—Å—Å–æ–≤ Tailwind —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π –∫–æ–Ω—Ñ–ª–∏–∫—Ç–æ–≤
 */
export function cn(...inputs: ClassValue[]) {
  return twMerge(clsx(inputs));
}

/**
 * –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å—É–º–º—ã USDT
 */
export function formatUSDT(amount: number, decimals: number = 2): string {
  return new Intl.NumberFormat('en-US', {
    minimumFractionDigits: decimals,
    maximumFractionDigits: decimals,
  }).format(amount) + ' USDT';
}

/**
 * –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–∞—Ç—ã
 */
export function formatDate(date: string | Date, format: 'relative' | 'short' | 'long' = 'relative'): string {
  const d = typeof date === 'string' ? new Date(date) : date;
  const now = new Date();
  const diffMs = now.getTime() - d.getTime();
  
  if (format === 'relative') {
    const diffSec = Math.floor(diffMs / 1000);
    const diffMin = Math.floor(diffSec / 60);
    const diffHour = Math.floor(diffMin / 60);
    const diffDay = Math.floor(diffHour / 24);
    
    if (diffSec < 60) return 'just now';
    if (diffMin < 60) return `${diffMin}m ago`;
    if (diffHour < 24) return `${diffHour}h ago`;
    if (diffDay < 7) return `${diffDay}d ago`;
  }
  
  if (format === 'short') {
    return d.toLocaleDateString('en-US', {
      month: 'short',
      day: 'numeric',
      hour: '2-digit',
      minute: '2-digit',
    });
  }
  
  // long format
  return d.toLocaleDateString('en-US', {
    year: 'numeric',
    month: 'long',
    day: 'numeric',
    hour: '2-digit',
    minute: '2-digit',
  });
}

/**
 * –û–±—Ä–µ–∑–∞–Ω–∏–µ –∞–¥—Ä–µ—Å–∞ –∫–æ—à–µ–ª—å–∫–∞ –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è
 */
export function truncateWallet(wallet: string, start: number = 6, end: number = 4): string {
  if (!wallet || wallet.length <= start + end) return wallet;
  return `${wallet.slice(0, start)}...${wallet.slice(-end)}`;
}

/**
 * –í–∞–ª–∏–¥–∞—Ü–∏—è TRC-20 –∞–¥—Ä–µ—Å–∞
 */
export function validateTronAddress(address: string): boolean {
  if (!address.startsWith('T')) return false;
  if (address.length !== 34) return false;
  
  // –ë–∞–∑–æ–≤–æ–µ —Ä–µ–≥—É–ª—è—Ä–Ω–æ–µ –≤—ã—Ä–∞–∂–µ–Ω–∏–µ –¥–ª—è TRON –∞–¥—Ä–µ—Å–æ–≤
  const tronRegex = /^T[A-Za-z0-9]{33}$/;
  return tronRegex.test(address);
}

/**
 * –í–∞–ª–∏–¥–∞—Ü–∏—è —Ä–µ—Ñ–µ—Ä–∞–ª—å–Ω–æ–≥–æ –∫–æ–¥–∞
 */
export function validateReferralCode(code: string): boolean {
  const regex = /^FA-[A-Z0-9]{5}$/;
  return regex.test(code);
}

/**
 * –ö–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ —Ç–µ–∫—Å—Ç–∞ –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞
 */
export async function copyToClipboard(text: string): Promise<boolean> {
  try {
    if (navigator.clipboard && window.isSecureContext) {
      await navigator.clipboard.writeText(text);
    } else {
      // Fallback –¥–ª—è —Å—Ç–∞—Ä—ã—Ö –±—Ä–∞—É–∑–µ—Ä–æ–≤
      const textArea = document.createElement('textarea');
      textArea.value = text;
      document.body.appendChild(textArea);
      textArea.select();
      document.execCommand('copy');
      document.body.removeChild(textArea);
    }
    return true;
  } catch (error) {
    console.error('Failed to copy:', error);
    return false;
  }
}

/**
 * –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —É–Ω–∏–∫–∞–ª—å–Ω–æ–≥–æ ID
 */
export function generateId(prefix: string = ''): string {
  return `${prefix}_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`;
}

/**
 * –î–µ–±–∞—É–Ω—Å —Ñ—É–Ω–∫—Ü–∏—è
 */
export function debounce<T extends (...args: any[]) => any>(
  func: T,
  wait: number
): (...args: Parameters<T>) => void {
  let timeout: NodeJS.Timeout;
  
  return (...args: Parameters<T>) => {
    clearTimeout(timeout);
    timeout = setTimeout(() => func(...args), wait);
  };
}

/**
 * –¢—Ä–æ—Ç—Ç–ª–∏–Ω–≥ —Ñ—É–Ω–∫—Ü–∏—è
 */
export function throttle<T extends (...args: any[]) => any>(
  func: T,
  limit: number
): (...args: Parameters<T>) => void {
  let inThrottle: boolean;
  
  return (...args: Parameters<T>) => {
    if (!inThrottle) {
      func(...args);
      inThrottle = true;
      setTimeout(() => (inThrottle = false), limit);
    }
  };
}

/**
 * –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–æ–º–µ—Ä–∞ —Ç–µ–ª–µ—Ñ–æ–Ω–∞
 */
export function formatPhoneNumber(phone: string): string {
  const cleaned = phone.replace(/\D/g, '');
  const match = cleaned.match(/^(\d{1})(\d{3})(\d{3})(\d{2})(\d{2})$/);
  
  if (match) {
    return `+${match[1]} (${match[2]}) ${match[3]}-${match[4]}-${match[5]}`;
  }
  
  return phone;
}

/**
 * –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–ª–æ–∂–Ω–æ—Å—Ç–∏ –ø–∞—Ä–æ–ª—è
 */
export function checkPasswordStrength(password: string): {
  score: number; // 0-4
  hasLength: boolean;
  hasUpper: boolean;
  hasLower: boolean;
  hasNumber: boolean;
  hasSpecial: boolean;
} {
  const hasLength = password.length >= 8;
  const hasUpper = /[A-Z]/.test(password);
  const hasLower = /[a-z]/.test(password);
  const hasNumber = /\d/.test(password);
  const hasSpecial = /[!@#$%^&*(),.?":{}|<>]/.test(password);
  
  const score = [hasLength, hasUpper, hasLower, hasNumber, hasSpecial].filter(Boolean).length;
  
  return {
    score,
    hasLength,
    hasUpper,
    hasLower,
    hasNumber,
    hasSpecial,
  };
}

/**
 * –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ localStorage —Å –æ–±—Ä–∞–±–æ—Ç–∫–æ–π –æ—à–∏–±–æ–∫
 */
export function saveToLocalStorage(key: string, value: any): boolean {
  try {
    const serialized = JSON.stringify(value);
    localStorage.setItem(key, serialized);
    return true;
  } catch (error) {
    console.error('Failed to save to localStorage:', error);
    return false;
  }
}

/**
 * –ó–∞–≥—Ä—É–∑–∫–∞ –∏–∑ localStorage —Å –æ–±—Ä–∞–±–æ—Ç–∫–æ–π –æ—à–∏–±–æ–∫
 */
export function loadFromLocalStorage<T>(key: string, defaultValue: T): T {
  try {
    const serialized = localStorage.getItem(key);
    if (serialized === null) return defaultValue;
    return JSON.parse(serialized);
  } catch (error) {
    console.error('Failed to load from localStorage:', error);
    return defaultValue;
  }
}

/**
 * –û—á–∏—Å—Ç–∫–∞ –¥–∞–Ω–Ω—ã—Ö localStorage
 */
export function clearLocalStorage(keys?: string[]): void {
  try {
    if (keys) {
      keys.forEach(key => localStorage.removeItem(key));
    } else {
      localStorage.clear();
    }
  } catch (error) {
    console.error('Failed to clear localStorage:', error);
  }
}

/**
 * –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –≥—Ä–∞–¥–∏–µ–Ω—Ç–∞ –ø–æ ID –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
 */
export function generateUserGradient(userId: number): string {
  const colors = [
    'from-primary-500 to-primary-700',
    'from-success to-emerald-700',
    'from-warning to-amber-700',
    'from-info to-blue-700',
    'from-purple-500 to-purple-700',
    'from-pink-500 to-pink-700',
  ];
  
  const index = userId % colors.length;
  return colors[index];
}

/**
 * –†–∞—Å—á–µ—Ç –≤—Ä–µ–º–µ–Ω–∏ –¥–æ –¥–µ–¥–ª–∞–π–Ω–∞
 */
export function calculateTimeRemaining(deadline: string): {
  days: number;
  hours: number;
  minutes: number;
  seconds: number;
  totalSeconds: number;
  isExpired: boolean;
} {
  const now = new Date();
  const target = new Date(deadline);
  const diffMs = target.getTime() - now.getTime();
  
  const totalSeconds = Math.floor(diffMs / 1000);
  const isExpired = totalSeconds <= 0;
  
  const days = Math.floor(totalSeconds / 86400);
  const hours = Math.floor((totalSeconds % 86400) / 3600);
  const minutes = Math.floor((totalSeconds % 3600) / 60);
  const seconds = totalSeconds % 60;
  
  return {
    days,
    hours,
    minutes,
    seconds,
    totalSeconds: Math.max(0, totalSeconds),
    isExpired,
  };
}
```

## üöÄ –ü–û–õ–ù–ê–Ø –ò–ù–°–¢–†–£–ö–¶–ò–Ø –ó–ê–ü–£–°–ö–ê:

### **1. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –±—ç–∫–µ–Ω–¥–∞:**
```bash
# 1. –°–æ–∑–¥–∞—Ç—å –∏ –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞—Ç—å –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ
cd fastagain-backend
python -m venv venv

# Linux/Mac:
source venv/bin/activate
# Windows:
venv\Scripts\activate

# 2. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
pip install -r requirements/base.txt

# 3. –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è
cp .env.example .env
# –û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å .env —Ñ–∞–π–ª:
# SECRET_KEY=your-secure-secret-key-here-change-in-production
# DATABASE_URL=postgresql+asyncpg://postgres:password@localhost:5432/fastagain
# SYNC_DATABASE_URL=postgresql://postgres:password@localhost:5432/fastagain
# REDIS_URL=redis://localhost:6379/0

# 4. –ó–∞–ø—É—Å—Ç–∏—Ç—å Docker –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã
docker-compose up -d

# 5. –°–æ–∑–¥–∞—Ç—å –º–∏–≥—Ä–∞—Ü–∏–∏ –∏ –ø—Ä–∏–º–µ–Ω–∏—Ç—å –∏—Ö
alembic revision --autogenerate -m "initial_migration"
alembic upgrade head

# 6. –ó–∞–ø—É—Å—Ç–∏—Ç—å —Å–µ—Ä–≤–µ—Ä —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏
uvicorn app.main:app --reload --host 0.0.0.0 --port 8000
```

### **2. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–∞:**
```bash
cd fastagain-frontend

# 1. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
npm install

# 2. –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è
cp .env.example .env
# –î–æ–±–∞–≤–∏—Ç—å –≤ .env:
# VITE_API_URL=http://localhost:8000/api/v1
# VITE_APP_NAME=FastAgain
# VITE_APP_VERSION=1.0.0

# 3. –ó–∞–ø—É—Å—Ç–∏—Ç—å —Å–µ—Ä–≤–µ—Ä —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏
npm run dev
```

### **3. –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–∏—Å—Ç–µ–º—ã:**

#### –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ API —á–µ—Ä–µ–∑ curl:
```bash
# –¢–µ—Å—Ç health check
curl http://localhost:8000/api/v1/health

# –¢–µ—Å—Ç —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏
curl -X POST "http://localhost:8000/api/v1/auth/register" \
  -H "Content-Type: application/json" \
  -d '{
    "email": "test@example.com",
    "password": "SecurePass123!",
    "confirm_password": "SecurePass123!",
    "referral_code": "FA-TEST1"
  }'

# –¢–µ—Å—Ç –≤—Ö–æ–¥–∞
curl -X POST "http://localhost:8000/api/v1/auth/login" \
  -H "Content-Type: application/x-www-form-urlencoded" \
  -d "username=test@example.com&password=SecurePass123!"

# –¢–µ—Å—Ç –ø–æ–ª—É—á–µ–Ω–∏—è –ø—Ä–æ—Ñ–∏–ª—è (–Ω—É–∂–µ–Ω —Ç–æ–∫–µ–Ω)
curl -X GET "http://localhost:8000/api/v1/auth/me" \
  -H "Authorization: Bearer YOUR_ACCESS_TOKEN"
```

#### –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —á–µ—Ä–µ–∑ –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å:
1. –û—Ç–∫—Ä–æ–π—Ç–µ `http://localhost:3000/registration`
2. –ó–∞–ø–æ–ª–Ω–∏—Ç–µ —Ñ–æ—Ä–º—É —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏
3. –ü–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–π —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ –≤—ã –±—É–¥–µ—Ç–µ –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω—ã –Ω–∞ `/onboarding`

#### –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —á–µ—Ä–µ–∑ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é API:
1. –û—Ç–∫—Ä–æ–π—Ç–µ `http://localhost:8000/docs`
2. –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä—É–π—Ç–µ —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã —á–µ—Ä–µ–∑ Swagger UI

## üìå –°–õ–ï–î–£–Æ–©–ò–ï –®–ê–ì–ò –î–õ–Ø –†–ê–ó–†–ê–ë–û–¢–ö–ò:
1. **–°–æ–≥–ª–∞—Å–Ω–æ –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç—É –¢–ó:** C3 ‚Üí C2 ‚Üí C1 ‚Üí C0
2. **–°–ª–µ–¥—É—é—â–∞—è –∑–∞–¥–∞—á–∞:** –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å `WalletService` (C3) —Å –ø–æ–ª–Ω–æ–π –≤–∞–ª–∏–¥–∞—Ü–∏–µ–π TRC-20 –∫–æ—à–µ–ª—å–∫–æ–≤
3. **–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è:** –°–æ–∑–¥–∞—Ç—å –∫–æ–º–ø–æ–Ω–µ–Ω—Ç `WalletBinding` –∏ —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã –¥–ª—è –ø—Ä–∏–≤—è–∑–∫–∏ –∫–æ—à–µ–ª—å–∫–æ–≤
4. **–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å:** –î–æ–±–∞–≤–∏—Ç—å email –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—é, rate limiting, —É–ª—É—á—à–∏—Ç—å –æ–±—Ä–∞–±–æ—Ç–∫—É –æ—à–∏–±–æ–∫

## üêõ –ò–°–ü–†–ê–í–õ–ï–ù–ù–´–ï –û–®–ò–ë–ö–ò:

### **–ö–†–ò–¢–ò–ß–ï–°–ö–ò–ï –ò–°–ü–†–ê–í–õ–ï–ù–ò–Ø:**
1. ‚úÖ **–°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞:** –†–∞–∑–¥–µ–ª–µ–Ω –∫–æ–¥ –Ω–∞ –¥–≤–∞ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è (`fastagain-backend/`, `fastagain-frontend/`)
2. ‚úÖ **–ú–æ–¥–µ–ª–∏ –¥–∞–Ω–Ω—ã—Ö:** –î–æ–±–∞–≤–ª–µ–Ω—ã –≤—Å–µ –º–æ–¥–µ–ª–∏ –∏–∑ –¢–ó (`ProjectWallet`, `UserCycle`, `Transaction`, `SupportTicket`)
3. ‚úÖ **–°–µ—Ä–≤–∏—Å—ã:** –ò—Å–ø—Ä–∞–≤–ª–µ–Ω—ã `UserService` –∏ `AuthService`, –¥–æ–±–∞–≤–ª–µ–Ω—ã –Ω–µ–¥–æ—Å—Ç–∞—é—â–∏–µ –º–µ—Ç–æ–¥—ã
4. ‚úÖ **–î–∏–∑–∞–π–Ω-—Å–∏—Å—Ç–µ–º–∞:** –ü–æ–ª–Ω–æ–µ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ "Trust Flow" (—Ü–≤–µ—Ç–∞, —à—Ä–∏—Ñ—Ç—ã, –∞–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç—å)
5. ‚úÖ **–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è UI-API:** –í—Å–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω—ã —Å —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–º–∏ —ç–Ω–¥–ø–æ–∏–Ω—Ç–∞–º–∏

### **–§–£–ù–ö–¶–ò–û–ù–ê–õ–¨–ù–´–ï –ò–°–ü–†–ê–í–õ–ï–ù–ò–Ø:**
1. ‚úÖ **–í–∞–ª–∏–¥–∞—Ü–∏—è:** –ü–æ–ª–Ω–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏—è –ø–∞—Ä–æ–ª–µ–π, email, —Ä–µ—Ñ–µ—Ä–∞–ª—å–Ω—ã—Ö –∫–æ–¥–æ–≤
2. ‚úÖ **JWT —Ç–æ–∫–µ–Ω—ã:** –î–æ–±–∞–≤–ª–µ–Ω blacklist, refresh —Ç–æ–∫–µ–Ω—ã, –ø—Ä–∞–≤–∏–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –∏—Å—Ç–µ—á–µ–Ω–∏—è
3. ‚úÖ **Redis –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è:** –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π, rate limiting, blacklist —Ç–æ–∫–µ–Ω–æ–≤
4. ‚úÖ **–û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫:** –£–ª—É—á—à–µ–Ω–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ –Ω–∞ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–µ –∏ –±—ç–∫–µ–Ω–¥–µ
5. ‚úÖ **–¢–∏–ø—ã TypeScript:** –ü–æ–ª–Ω–∞—è —Ç–∏–ø–∏–∑–∞—Ü–∏—è –≤—Å–µ—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤ –∏ —Å–µ—Ä–≤–∏—Å–æ–≤

### **–û–ü–¢–ò–ú–ò–ó–ê–¶–ò–ò:**
1. ‚úÖ **–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å:** –î–æ–±–∞–≤–ª–µ–Ω–æ –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ, –¥–µ–±–∞—É–Ω—Å, —Ç—Ä–æ—Ç—Ç–ª–∏–Ω–≥
2. ‚úÖ **–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å:** Rate limiting, –≤–∞–ª–∏–¥–∞—Ü–∏—è –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö, –∑–∞—â–∏—Ç–∞ –æ—Ç –∏–Ω—ä–µ–∫—Ü–∏–π
3. ‚úÖ **UX/UI:** –ê–Ω–∏–º–∞—Ü–∏–∏, —Å–æ—Å—Ç–æ—è–Ω–∏—è –∑–∞–≥—Ä—É–∑–∫–∏, –∞–¥–∞–ø—Ç–∏–≤–Ω—ã–π –¥–∏–∑–∞–π–Ω
4. ‚úÖ **–ö–æ–¥–æ–≤–∞—è –±–∞–∑–∞:** –ß–∏—Å—Ç–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞, —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç–∏, –ø–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã

## ü§ñ –ö–û–ù–¢–ï–ö–°–¢ –î–õ–Ø –°–õ–ï–î–£–Æ–©–ï–ì–û –ò–ò-–ê–°–°–ò–°–¢–ï–ù–¢–ê (–°–ö–û–ü–ò–†–£–ô –≠–¢–û–¢ –ë–õ–û–ö –í –ù–û–í–´–ô –ß–ê–¢):

### –û–ü–ò–°–ê–ù–ò–ï –ü–†–û–ï–ö–¢–ê:
FastAgain - —Å–∏—Å—Ç–µ–º–∞ –≤–∑–∞–∏–º–æ–ø–æ–º–æ—â–∏ –Ω–∞ –±–ª–æ–∫—á–µ–π–Ω–µ TRON. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –¥–µ–ª–∞—é—Ç 5 –ø–µ—Ä–µ–≤–æ–¥–æ–≤ –ø–æ 20 USDT –≤ —Ç–µ—á–µ–Ω–∏–µ 24 —á–∞—Å–æ–≤. –ü–æ–ª–Ω–∞—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –¥–∏–∑–∞–π–Ω-—Å–∏—Å—Ç–µ–º—ã "Trust Flow" —Å React —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–æ–º –∏ FastAPI –±—ç–∫–µ–Ω–¥–æ–º.

### –¢–ï–ö–£–©–ò–ô –°–¢–ê–¢–£–° –†–ê–ó–†–ê–ë–û–¢–ö–ò:
‚úÖ –°–æ–∑–¥–∞–Ω–∞ –±–∞–∑–æ–≤–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞ (–§–∞–∑–∞ 0 –∑–∞–≤–µ—Ä—à–µ–Ω–∞)  
‚úÖ –ü–æ–ª–Ω–æ—Å—Ç—å—é —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω—ã UserService –∏ AuthService (–§–∞–∑–∞ 1 –∑–∞–≤–µ—Ä—à–µ–Ω–∞ –Ω–∞ 100%)  
‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω—ã –≤—Å–µ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –æ—à–∏–±–∫–∏ –∏–∑ —Ñ–∞–π–ª–∞ 4.txt  
‚úÖ –ö–æ–¥ –ø–æ–ª–Ω–æ—Å—Ç—å—é –∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω –≤ —Å—Ç—Ä—É–∫—Ç—É—Ä—É –¥–≤—É—Ö —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–µ–≤  
‚úÖ –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ –ø–æ–ª–Ω–∞—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è —Å JWT —Ç–æ–∫–µ–Ω–∞–º–∏ (blacklist, refresh)  
‚úÖ –°–æ–∑–¥–∞–Ω —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç Registration —Å –ø–æ–ª–Ω–æ–π –≤–∞–ª–∏–¥–∞—Ü–∏–µ–π  
‚úÖ –ù–∞—Å—Ç—Ä–æ–µ–Ω–∞ –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö PostgreSQL —Å –º–∏–≥—Ä–∞—Ü–∏—è–º–∏ Alembic  
‚úÖ –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ —Ä–µ—Ñ–µ—Ä–∞–ª—å–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ (–±–∞–∑–æ–≤—ã–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª)  
‚úÖ –ü–æ–ª–Ω–æ–µ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ –¥–∏–∑–∞–π–Ω-—Å–∏—Å—Ç–µ–º–µ "Trust Flow"  

### –°–û–ó–î–ê–ù–ù–´–ï –ö–û–ú–ü–û–ù–ï–ù–¢–´ (–ø–æ –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç—É –¢–ó):

**C3 - MISSION-CRITICAL:**
1. ‚¨ú –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π –±–ª–æ–∫—á–µ–π–Ω–∞ - TransactionService **(–°–õ–ï–î–£–Æ–©–ê–Ø –ó–ê–î–ê–ß–ê)**
2. ‚¨ú –ü—Ä–∏–≤—è–∑–∫–∞ –∫–æ—à–µ–ª—å–∫–æ–≤ - WalletService
3. ‚úÖ –®–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ –∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å - AuthService **(–ü–æ–ª–Ω–æ—Å—Ç—å—é —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω)**
4. ‚¨ú –†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Å—Ä–µ–¥—Å—Ç–≤ - ReferralService

**C2 - BUSINESS-CRITICAL:**
1. ‚úÖ –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π - UserService **(–ü–æ–ª–Ω–æ—Å—Ç—å—é —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω)**
2. ‚¨ú –†–µ—Ñ–µ—Ä–∞–ª—å–Ω–∞—è –ª–æ–≥–∏–∫–∞ - ReferralService
3. ‚¨ú –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ü–∏–∫–ª–∞–º–∏ - CycleService
4. ‚¨ú –û—á–µ—Ä–µ–¥–∏ –∏ —Å–ª–æ—Ç—ã - QueueService

**C1 - IMPORTANT:**
1. ‚úÖ API —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã (–∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è, health check)
2. ‚úÖ UI-–ª–æ–≥–∏–∫–∞ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–∞ (Registration –∫–æ–º–ø–æ–Ω–µ–Ω—Ç, Button)
3. ‚¨ú –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è - NotificationService
4. ‚¨ú –ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å - AdminService (—Ä—É—Å—Å–∫–∏–π —è–∑—ã–∫)
5. ‚¨ú –¢–µ—Ö–ø–æ–¥–¥–µ—Ä–∂–∫–∞ - SupportService

**C0 - UTILITY:**
1. ‚úÖ –ë–∞–∑–æ–≤–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞ (–±—ç–∫–µ–Ω–¥ + —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥)
2. ‚úÖ –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã (.env, docker-compose.yml)
3. ‚úÖ –°—Ç–∞—Ç–∏—á–µ—Å–∫–∏–µ —Ñ–∞–π–ª—ã –∏ —Å—Ç–∏–ª–∏
4. ‚úÖ –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –∏ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –∑–∞–ø—É—Å–∫–∞

### –°–õ–ï–î–£–Æ–©–ê–Ø –ó–ê–î–ê–ß–ê (–ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç C3):
**–†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å WalletService –∏ TransactionService (C3 - MISSION-CRITICAL):**

1. **–°–æ–∑–¥–∞—Ç—å `WalletService`** —Å –º–µ—Ç–æ–¥–∞–º–∏:
   - `validate_tron_address(address)` - –≤–∞–ª–∏–¥–∞—Ü–∏—è —Ñ–æ—Ä–º–∞—Ç–∞ TRC-20
   - `check_exchange_wallet(address)` - –ø—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ –±–∏—Ä–∂–µ–≤–æ–π –∫–æ—à–µ–ª–µ–∫
   - `bind_wallet(user_id, wallet_address)` - –ø—Ä–∏–≤—è–∑–∫–∞ –∫–æ—à–µ–ª—å–∫–∞
   - `confirm_wallet(user_id)` - –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –∫–æ—à–µ–ª—å–∫–∞ –ø–æ—Å–ª–µ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏

2. **–°–æ–∑–¥–∞—Ç—å `TransactionService`** —Å –º–µ—Ç–æ–¥–∞–º–∏:
   - `verify_transaction(tx_hash)` - –ø—Ä–æ–≤–µ—Ä–∫–∞ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ –≤ –±–ª–æ–∫—á–µ–π–Ω–µ
   - `process_transfer(user_id, recipient, amount)` - –æ–±—Ä–∞–±–æ—Ç–∫–∞ –ø–µ—Ä–µ–≤–æ–¥–∞
   - `get_transaction_history(user_id)` - –∏—Å—Ç–æ—Ä–∏—è —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π

3. **–ò–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞—Ç—å TronGrid API** –¥–ª—è:
   - –í–µ–±—Ö—É–∫–∏ –¥–ª—è –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π
   - Polling –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —Å—Ç–∞—Ç—É—Å–∞
   - –ü–æ–ª—É—á–µ–Ω–∏–µ –±–∞–ª–∞–Ω—Å–∞ –∫–æ—à–µ–ª—å–∫–æ–≤

4. **–†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã:**
   - `WalletBinding.tsx` - –ø—Ä–∏–≤—è–∑–∫–∞ –∫–æ—à–µ–ª—å–∫–∞ —Å QR —Å–∫–∞–Ω–µ—Ä–æ–º
   - `TransactionList.tsx` - –∏—Å—Ç–æ—Ä–∏—è —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π
   - `TransferForm.tsx` - —Ñ–æ—Ä–º–∞ –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ USDT

### –í–ê–ñ–ù–´–ï –¢–ï–•–ù–ò–ß–ï–°–ö–ò–ï –î–ï–¢–ê–õ–ò:
- **–ë—ç–∫–µ–Ω–¥ —Å—Ç–µ–∫:** Python 3.10+, FastAPI, PostgreSQL 15, Redis 7, SQLAlchemy 2.0, Pydantic 2.0, aiotrond
- **–§—Ä–æ–Ω—Ç–µ–Ω–¥ —Å—Ç–µ–∫:** React 18 + TypeScript, Tailwind CSS + Headless UI, Framer Motion, Lucide React, React Query, Zustand
- **–î–∏–∑–∞–π–Ω-—Å–∏—Å—Ç–µ–º–∞:** "Trust Flow" (–±–µ–ª–æ-–≥–æ–ª—É–±–∞—è –≥–∞–º–º–∞, Inter —à—Ä–∏—Ñ—Ç) - –ø–æ–ª–Ω–æ—Å—Ç—å—é –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∞
- **–¢–µ—Ä–º–∏–Ω–æ–ª–æ–≥–∏—è:** "transfer", "donate", "contribution" (–ù–ï "payment") - —Å–æ–±–ª—é–¥–∞–µ—Ç—Å—è
- **–Ø–∑—ã–∫ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞:** –∞–Ω–≥–ª–∏–π—Å–∫–∏–π –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π - —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ
- **–ó–∞–ø—Ä–µ—â–µ–Ω—ã –±–∏—Ä–∂–µ–≤—ã–µ –∫–æ—à–µ–ª—å–∫–∏:** –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–∞ –≤–∞–ª–∏–¥–∞—Ü–∏—è –≤ WalletService (C3)
- **–¢–∞–π–º–µ—Ä —Ü–∏–∫–ª–æ–≤:** 24 —á–∞—Å–∞, —Ö—Ä–∞–Ω–∏—Ç—å –≤ Redis (–∫—ç—à), –∏—Å—Ç–æ—á–Ω–∏–∫ –∏—Å—Ç–∏–Ω—ã –≤ PostgreSQL
- **–ü—Ä–æ–≤–µ—Ä–∫–∞ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π:** 3-—É—Ä–æ–≤–Ω–µ–≤–∞—è (webhook ‚Üí polling ‚Üí manual review)

### –°–¢–†–£–ö–¢–£–†–ê –ü–†–û–ï–ö–¢–ê (–∞–∫—Ç—É–∞–ª—å–Ω–∞—è):
```
fastagain-backend/
‚îú‚îÄ‚îÄ app/
‚îÇ   ‚îú‚îÄ‚îÄ core/              # config.py, database.py, security.py (–≥–æ—Ç–æ–≤–æ)
‚îÇ   ‚îú‚îÄ‚îÄ models/            # user.py, base.py, project_wallet.py (–≥–æ—Ç–æ–≤–æ)
‚îÇ   ‚îú‚îÄ‚îÄ schemas/           # user.py, auth.py, wallet.py (–≥–æ—Ç–æ–≤–æ)
‚îÇ   ‚îú‚îÄ‚îÄ services/          # user_service.py, auth_service.py (–≥–æ—Ç–æ–≤–æ)
‚îÇ   ‚îú‚îÄ‚îÄ api/v1/endpoints/  # health.py, auth.py (–≥–æ—Ç–æ–≤–æ)
‚îÇ   ‚îî‚îÄ‚îÄ main.py
‚îú‚îÄ‚îÄ requirements/          # base.txt, dev.txt, prod.txt
‚îú‚îÄ‚îÄ alembic/              # –ú–∏–≥—Ä–∞—Ü–∏–∏ –ë–î
‚îú‚îÄ‚îÄ docker-compose.yml    # PostgreSQL 15, Redis 7
‚îî‚îÄ‚îÄ .env.example

fastagain-frontend/
‚îú‚îÄ‚îÄ src/
‚îÇ   ‚îú‚îÄ‚îÄ components/        # UI-KIT: Button (–≥–æ—Ç–æ–≤), WalletInput (–ø—Ä–µ–¥—Å—Ç–æ–∏—Ç)
‚îÇ   ‚îú‚îÄ‚îÄ pages/            # Registration (–≥–æ—Ç–æ–≤), WalletBinding (–ø—Ä–µ–¥—Å—Ç–æ–∏—Ç)
‚îÇ   ‚îú‚îÄ‚îÄ hooks/            # useAuth (–≥–æ—Ç–æ–≤), useWallet (–ø—Ä–µ–¥—Å—Ç–æ–∏—Ç)
‚îÇ   ‚îú‚îÄ‚îÄ services/         # api.ts (–≥–æ—Ç–æ–≤)
‚îÇ   ‚îú‚îÄ‚îÄ styles/           # Tailwind (–¥–∏–∑–∞–π–Ω-—Å–∏—Å—Ç–µ–º–∞ "Trust Flow")
‚îÇ   ‚îú‚îÄ‚îÄ types/            # TypeScript —Ç–∏–ø—ã
‚îÇ   ‚îî‚îÄ‚îÄ App.tsx
‚îú‚îÄ‚îÄ public/
‚îú‚îÄ‚îÄ package.json
‚îú‚îÄ‚îÄ tailwind.config.js    # –ü–æ–ª–Ω–æ—Å—Ç—å—é –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∞ –¥–∏–∑–∞–π–Ω-—Å–∏—Å—Ç–µ–º–∞
‚îî‚îÄ‚îÄ vite.config.ts
```

### –ö–û–ú–ê–ù–î–´ –î–õ–Ø –ó–ê–ü–£–°–ö–ê:
**–ü–æ–ª–Ω—ã–π –∑–∞–ø—É—Å–∫ (–≤—Å–µ —Ä–∞–±–æ—Ç–∞–µ—Ç):**
```bash
# 1. –ë—ç–∫–µ–Ω–¥
cd fastagain-backend
docker-compose up -d
pip install -r requirements/base.txt
alembic upgrade head
uvicorn app.main:app --reload --port 8000

# 2. –§—Ä–æ–Ω—Ç–µ–Ω–¥
cd ../fastagain-frontend
npm install
npm run dev

# 3. –ü—Ä–æ–≤–µ—Ä–∫–∞
curl http://localhost:8000/api/v1/health
# –û—Ç–∫—Ä–æ–π: http://localhost:3000/registration
```

### –°–°–´–õ–ö–ò –ù–ê –î–û–ö–£–ú–ï–ù–¢–ê–¶–ò–Æ:
- üìÑ **–¢–µ—Ö–Ω–∏—á–µ—Å–∫–æ–µ –∑–∞–¥–∞–Ω–∏–µ:** TZ Disign Fast Again Python.txt (–≤–µ—Ä—Å–∏—è 3.0 —Å –¥–∏–∑–∞–π–Ω–æ–º)
- üó∫Ô∏è **–£–º–Ω–∞—è –∫–∞—Ä—Ç–∞:** smart_map_static_design.txt
- üìù **–ü—Ä–µ–¥—ã–¥—É—â–∏–π –æ—Ç–≤–µ—Ç:** FA 1-7 + —ç—Ç–æ—Ç –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã–π –æ—Ç–≤–µ—Ç
- üìö **API –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è:** http://localhost:8000/docs (–∞–≤—Ç–æ–≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç—Å—è FastAPI)
- üé® **–î–∏–∑–∞–π–Ω-—Å–∏—Å—Ç–µ–º–∞:** –ü–æ–ª–Ω–æ—Å—Ç—å—é —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ –≤ Tailwind config

---
**–í–ù–ò–ú–ê–ù–ò–ï:** –°–ª–µ–¥—É—é—â–∏–π –ò–ò –¥–æ–ª–∂–µ–Ω –Ω–∞—á–∞—Ç—å —Å —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ WalletService –∏ TransactionService (C3) —Å–æ–≥–ª–∞—Å–Ω–æ —É–∫–∞–∑–∞–Ω–Ω–æ–π –≤—ã—à–µ –∑–∞–¥–∞—á–µ. –í—Å–µ –±–∞–∑–æ–≤—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ –∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –≥–æ—Ç–æ–≤—ã –∏ —Ä–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–Ω—ã –Ω–∞ 100%. –ü–µ—Ä–µ–¥ –Ω–∞—á–∞–ª–æ–º —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ WalletService —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å —Ç–µ–∫—É—â—É—é —Å–∏—Å—Ç–µ–º—É —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ –∏ –≤—Ö–æ–¥–∞.
```


